/*!CK:2837282864!*//*1383330807,173199715*/

if (self.CavalryLogger) { CavalryLogger.start_js(["hYPx+"]); }

__d("UIThumbPager",["CSS","DOM","Event","Style","URI","$","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('Style'),k=b('URI'),l=b('$'),m=b('copyProperties'),n=b('emptyFunction');function o(p,q,r,s,t,u,v){if(!p)return false;this.startTime=this.startTime||Date.now();m(this,{root:l(p),ancestor:s||p.parentNode,thumbs:h.scry(p,'div.UIThumbPager_Thumbs img'),thumbRoot:p.parentNode,loaded:[],index:0,loadCount:0,lastLoadCount:0,orderedLoaded:[],orderedCursor:0,onloadCallback:n,onhideCallback:n,timeout:null,finished:false,minWidth:t,minHeight:u,allowReordering:v,metricsInput:r});this.loader=h.find(this.root,'div.UIThumbPager_Loader');if(q){this.input=h.create('input',{name:q,type:'hidden'});this.ancestor.appendChild(this.input);}this.bestImageW=h.create('input',{name:this.getMetricsInput('best_image_w'),type:'hidden'});this.bestImageH=h.create('input',{name:this.getMetricsInput('best_image_h'),type:'hidden'});this.selectedImage=h.create('input',{name:this.getMetricsInput('image_selected'),type:'hidden'});this.imagesProvided=h.create('input',{name:this.getMetricsInput('images_provided'),type:'hidden',value:this.thumbs.length});this.imagesLoaded=h.create('input',{name:this.getMetricsInput('images_loaded'),type:'hidden',value:0});this.imagesShown=h.create('input',{name:this.getMetricsInput('images_shown'),type:'hidden',value:0});this.loadDuration=h.create('input',{name:this.getMetricsInput('load_duration'),type:'hidden'});this.timedOut=h.create('input',{name:this.getMetricsInput('timed_out'),type:'hidden',value:0});this.sortOrder=h.create('input',{name:this.getMetricsInput('sort_order'),type:'hidden'});this.selectorType=h.create('input',{name:this.getMetricsInput('selector_type'),type:'hidden',value:'UIThumbPager_6'});if(r){this.ancestor.appendChild(this.bestImageW);this.ancestor.appendChild(this.bestImageH);this.ancestor.appendChild(this.selectedImage);this.ancestor.appendChild(this.imagesProvided);this.ancestor.appendChild(this.imagesLoaded);this.ancestor.appendChild(this.imagesShown);this.ancestor.appendChild(this.loadDuration);this.ancestor.appendChild(this.timedOut);this.ancestor.appendChild(this.sortOrder);this.ancestor.appendChild(this.selectorType);}this.root.getUIThumbPager=n.thatReturns(this);}o.prototype.setOnloadCallback=function(p){this.onloadCallback=p;this.init();return this;};o.prototype.setOnhideCallback=function(p){this.onhideCallback=p;return this;};o.prototype.init=function(){this.timeout=setInterval(this.timeoutTriggered.bind(this),o.loadtimeout);this.thumbs.forEach(function(p,q){if(p.complete||p.readyState=="complete"){this.onload(p,q);}else{var r=false,s=function(){if(!r){this.onload(p,q);r=true;}}.bind(this),t=function(){if(!r&&p.readyState=="complete"){this.onload(p,q);r=true;}}.bind(this);i.listen(p,'readystatechange',t);i.listen(p,'load',s);}}.bind(this));};o.prototype.timeoutTriggered=function(){if(this.lastLoadCount==this.loadCount&&!this.finished){this.updateDisplayFromBlock(true);this.timedOut.value=1;this.onfinish();}this.lastLoadCount=this.loadCount;};o.prototype.onload=function(p,q){if(this.finished)return;var r=this.getDimensions(p),s=null;if(this.checkLimits(r))s={thumb:p,w:r[0],h:r[1],index:q};if(this.allowReordering){if(s){this.loaded.push(s);this.onloadCallback(this.loaded.length);}}else{this.orderedLoaded[q]=s;if(this.orderedCursor==q)this.updateDisplayFromBlock(false);}this.imagesLoaded.value=++this.loadCount;if(this.loadCount==this.thumbs.length)this.onfinish();};o.prototype.onfinish=function(){this.markFinished();this.imagesShown.value=this.loaded.length;if(this.allowReordering||this.loaded.length===0)this.loadDuration.value=Date.now()-this.startTime;if(this.loaded.length===0){g.hide(this.root);this.onhideCallback();return;}if(this.allowReordering){this.loaded.sort(this.sort);this.bestImageW.value=this.loaded[0].w;this.bestImageH.value=this.loaded[0].h;this.loaded.forEach(function(p,q){if(q>0)this.sortOrder.value+=',';this.sortOrder.value+=p.index;}.bind(this));this.first();}};o.prototype.markFinished=function(){clearInterval(this.timeout);this.finished=true;};o.prototype.updateDisplayFromBlock=function(p){for(var q=this.orderedCursor;q<this.thumbs.length;q++){if(!p&&this.orderedLoaded[q]===undefined)break;this.orderedCursor++;if(!this.orderedLoaded[q])continue;this.loaded.push(this.orderedLoaded[q]);this.onloadCallback(this.loaded.length);if(this.loaded.length==1){this.first();this.loadDuration.value=Date.now()-this.startTime;this.bestImageW.value=this.loaded[0].w;this.bestImageH.value=this.loaded[0].h;}}this.imagesShown.value=this.loaded.length;};o.prototype.page=function(p,q){if(this.index==p)return true;if(!this.finished&&this.allowReordering){this.markFinished();this.imagesLoaded.value=this.loadCount;this.imagesShown.value=this.loaded.length;}if(this.loader){j.set(this.loader,'display','none');this.loader=null;}var r=this.index;this.index+=q;this.selectedImage.value=this.index;o.swap(this.loaded[r].thumb,this.loaded[this.index].thumb,this.input);if(this.index==p)return true;return false;};o.prototype.first=function(){return this.page(null,-this.index);};o.prototype.prev=function(){return this.page(0,-1);};o.prototype.next=function(){return this.page(this.loaded.length-1,1);};o.prototype.getPageNumber=function(){return this.index+1;};o.swap=function(p,q,r){if(p!==q)g.addClass(p,o.hiddenClass);g.removeClass(q,o.hiddenClass);var s=k(q.src);if(!r)return;if((s.isFacebookURI()||s.getDomain().toLowerCase().match('\\.fbcdn\\.net$'))&&s.getPath().match('/safe_image.php')){r.value=s.getQueryData().url;}else r.value=q.src;};o.prototype.showThumbs=function(p){g.conditionClass(this.thumbRoot,'hidden_elem',!p);};o.prototype.sort=function(p,q){var r=p.w*p.h,s=q.w*q.h;if(s>r||s==r&&q.index<p.index)return 1;return -1;};o.prototype.getDimensions=function(p){return [p.naturalWidth,p.naturalHeight];};o.prototype.checkLimits=function(p){var q=p[0],r=p[1];if(!q)return true;return r>=(this.minHeight||o.minHeight)&&q>=(this.minWidth||o.minWidth)&&r/q<=o.maxRatio&&q/r<=o.maxRatio;};o.prototype.getMetricsInput=function(p){return this.metricsInput+'['+p+']';};m(o,{hiddenClass:'UIThumbPager_Hidden',loadtimeout:5000,minWidth:50,minHeight:50,maxRatio:3});e.exports=o;});
__d("legacy:UIThumbPager",["UIThumbPager"],function(a,b,c,d){a.UIThumbPager=b('UIThumbPager');},3);
__d("UIThumbPagerControl",["CSS","DOM","Event","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('copyProperties'),k=b('emptyFunction');function l(m,n){if(!m)return false;j(this,{root:m,pager:n,buttons:h.find(m,'.UIThumbPagerControl_Buttons'),buttonText:h.find(m,'div.UIThumbPagerControl_Text'),buttonLeft:h.find(m,'.UIThumbPagerControl_Button_Left'),buttonRight:h.find(m,'.UIThumbPagerControl_Button_Right'),loadedCount:0,pageCurrent:h.find(m,'span.UIThumbPagerControl_PageNumber_Current'),pageTotal:h.find(m,'span.UIThumbPagerControl_PageNumber_Total'),noThumb:h.find(m,'input.UIThumbPagerControl_NoPicture'),end:true});this.pager.setOnhideCallback(this.onhide.bind(this));this.root.getUIThumbPagerControl=k.thatReturns(this);this.attachHandlers();}l.prototype.attachHandlers=function(){this.pager.setOnloadCallback(this.onload.bind(this));i.listen(this.buttonLeft,'click',function(){this.click(this.pager.prev);}.bind(this));i.listen(this.buttonRight,'click',function(){this.click(this.pager.next);}.bind(this));i.listen(this.noThumb,'click',function(){this.pager.showThumbs(!this.noThumb.checked);g.conditionClass(this.buttons,'hidden_elem',this.noThumb.checked);g.conditionClass(this.buttonText,'hidden_elem',this.noThumb.checked);}.bind(this));};l.prototype.onload=function(m){this.loadedCount=m;if(m==1)h.setContent(this.pageCurrent,m);if(m>this.pager.getPageNumber())g.removeClass(this.root,'UIThumbPagerControl_Last');h.setContent(this.pageTotal,m);};l.prototype.onhide=function(){g.hide(this.root);this.noThumb.checked=true;};l.prototype.click=function(m){if(this.loadedCount<=1)return;var n=['UIThumbPagerControl_Last','UIThumbPagerControl_First'];if(m==this.pager.prev)n.push(n.shift());if(this.end)g.removeClass(this.root,n[1]);if(this.end=m.bind(this.pager)())g.addClass(this.root,n[0]);h.setContent(this.pageCurrent,this.pager.getPageNumber());};e.exports=l;});
__d("legacy:UIThumbPagerControl",["UIThumbPagerControl"],function(a,b,c,d){a.UIThumbPagerControl=b('UIThumbPagerControl');},3);
__d("InlineEditor",["DOM","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('UserAgent'),i=b('copyProperties');function j(k,l,m,n,o,p){this._name=l;this._obj=k;this._root=m;this._target=n;this._more_than_meets_the_eye=true;this._original_value=k.firstChild.nodeValue;this._is_textarea=o;this._max_edit_length=p;this._edit=g.create(o?'textarea':'input',{value:this._original_value,className:'inputtext inline_edit'});if(this._max_edit_length)this._edit.setAttribute('maxLength',p);var q=this._edit;k.parentNode.insertBefore(q,k);k.parentNode.removeChild(k);q.onblur=this._onblur.bind(this);q.onchange=this._onchange.bind(this);q.onkeypress=function(event){return this._onkeypress(event?event:window.event);}.bind(this);q.focus();q.select();}i(j.prototype,{_onkeypress:function(event){switch(event?event.keyCode:0){case 27:if(h.firefox()<3&&this._valueIsWhitespace(this._original_value))this._edit.value=j.FIREFOX_2_BLANK_SUMMARY;this._edit.value=this._original_value;case 13:this._onblur();return false;}},_onblur:function(){if(!this._more_than_meets_the_eye)return false;this._more_than_meets_the_eye=false;this._onchange();var k=this._is_textarea;if(!this._edit.value||this._valueIsWhitespace(this._edit.value))if(h.firefox()<3){this._edit.value=j.FIREFOX_2_BLANK_SUMMARY;}else this._edit.value=j.DEFAULT_BLANK_SUMMARY;var l=this._root,m=this._target,n=this._max_edit_length,o=g.create('a',{href:'#',className:'inline_edit',onmousedown:function(){return false;},onclick:function(){new j(this,name,l,m,k,n);return false;}},this._edit.value);this._edit.parentNode.insertBefore(o,this._edit);this._edit.parentNode.removeChild(this._edit);},_valueIsWhitespace:function(k){return !!!(k.trim().length);},_onchange:function(){if(!this._target){this._target=g.create('input',{name:this._name,type:'hidden'});this._root.appendChild(this._target);}this._target.value=this._edit.value;}});i(j,{FIREFOX_2_BLANK_SUMMARY:'...',DEFAULT_BLANK_SUMMARY:'\u00A0\u00A0\u00A0'});e.exports=j;});
__d("legacy:inline-editor",["InlineEditor"],function(a,b,c,d){a.InlineEditor=b('InlineEditor');},3);
__d("ShareModeConst",[],function(a,b,c,d,e,f){var g={SELF_PAGE:'selfpage',PAGE:'page',SELF_POST:'self',FRIEND:'friend',GROUP:'group',ALBUM:'album',MESSAGE:'message'};e.exports=g;});
__d("SharerFrame",["ArbiterMixin","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('copyProperties');function i(j){this._sharerSelector=j;this._sharerSelector.subscribe('change',function(k,l){this.inform('selector-change',l);}.bind(this));}i.focusInput=function(j){j.focus();};h(i.prototype,g,{getSelectedMode:function(){return this._sharerSelector.getSelectedMode();}});e.exports=i;});
__d("SharerSelector",["ArbiterMixin","CSS","Input","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('Input'),j=b('copyProperties');function k(l,m,n,o,p){this._selectedMode=n;var q=function(r,s){var t=s.value;m&&i.setValue(m,t);o[this._selectedMode].hideContent();p&&h.hide(p[this._selectedMode]);o[t].showContent();p&&h.show(p[t]);this._selectedMode=t;this.inform('change',this._selectedMode);}.bind(this);l&&l.subscribe('change',q);}j(k.prototype,g,{getSelectedMode:function(){return this._selectedMode;}});e.exports=k;});
__d("ShareMode",["CSS","Parent","copyProperties","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('Parent'),i=b('copyProperties'),j=b('cx'),k=b('emptyFunction');function l(m){this._content=m;}i(l.prototype,{showContent:function(){this._content&&g.show(this._content);this.show();},hideContent:function(){this._content&&g.hide(this._content);this.hide();},_getSharerRoot:function(){return h.byClass(this._content,"_b-z");},hideMentionsInput:function(){g.addClass(this._getSharerRoot(),"_c7f");},showMentionsInput:function(){g.removeClass(this._getSharerRoot(),"_c7f");},show:k,hide:k});e.exports=l;});
__d("ShareModeFriendTimeline",["Focus","ShareMode"],function(a,b,c,d,e,f){var g=b('Focus'),h=b('ShareMode');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";h.call(this,l);this._typeaheadInput=m;}k.prototype.show=function(){"use strict";g.set(this._typeaheadInput);};e.exports=k;});
__d("ShareModeGroup",["Focus","ShareMode"],function(a,b,c,d,e,f){var g=b('Focus'),h=b('ShareMode');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";h.call(this,l);this._typeaheadInput=m;}k.prototype.show=function(){"use strict";g.set(this._typeaheadInput);};e.exports=k;});
__d("ShareModeMessage",["Focus","ShareMode"],function(a,b,c,d,e,f){var g=b('Focus'),h=b('ShareMode');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";h.call(this,l);this._typeaheadInput=m;}k.prototype.show=function(){"use strict";g.set(this._typeaheadInput);};e.exports=k;});
__d("ShareModeOwnTimeline",["CSS","ShareMode"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('ShareMode');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";h.call(this);this._privacyWidget=l;this._boostWidget=m;}k.prototype.show=function(){"use strict";g.show(this._privacyWidget);this._boostWidget&&g.show(this._boostWidget);};k.prototype.hide=function(){"use strict";g.hide(this._privacyWidget);this._boostWidget&&g.hide(this._boostWidget);};e.exports=k;});
__d("ShareModePage",["CSS","Input","ShareMode"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('Input'),i=b('ShareMode');for(var j in i)if(i.hasOwnProperty(j))l[j]=i[j];var k=i===null?null:i.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=i;function l(m,n,o,p,q,r,s){"use strict";i.call(this,m);this._pageSelector=n;this._postAsPageInput=p;this._targetingWidget=s;this._shouldPostAsPage=h.getValue(this._postAsPageInput);if(this._pageSelector)this._pageSelector.subscribe('change',function(t,u){this._shouldPostAsPage=o[u.value];h.setValue(this._postAsPageInput,""+this._shouldPostAsPage);g.conditionShow(q,this._shouldPostAsPage);g.conditionShow(r,!this._shouldPostAsPage);g.conditionShow(this._targetingWidget,this._shouldPostAsPage);}.bind(this));}l.prototype.show=function(){"use strict";g.conditionShow(this._targetingWidget,this._shouldPostAsPage);};l.prototype.hide=function(){"use strict";g.hide(this._targetingWidget);};e.exports=l;});
__d("Sharer",["Event","CSS","ShareModeConst","URI"],function(a,b,c,d,e,f){var g=b('Event'),h=b('CSS'),i=b('ShareModeConst'),j=b('URI'),k={initPrivacyWarning:function(l,m){l.subscribe('selector-change',function(n,o){h.conditionShow(m,o===i.GROUP||o===i.MESSAGE||o===i.FRIEND||o===i.SELF_POST);});},close:function(l){if(typeof(l)=='string'&&l){window.location.href=l;}else{window.close();window.location.href=j().setPath('/').setQueryData().toString();}return false;},listenForCancel:function(l){g.listen(l,'click',this.close);}};e.exports=k;});