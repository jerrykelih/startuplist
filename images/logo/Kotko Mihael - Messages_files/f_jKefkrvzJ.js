/*!CK:1296446120!*//*1384744666,178171163*/

if (self.CavalryLogger) { CavalryLogger.start_js(["j+oDt"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){e.exports={ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",ACTION_EDUCATE:"educate",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};});
__d("AsyncLoader",["copyProperties","AsyncRequest","BaseAsyncLoader"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('AsyncRequest'),i=b('BaseAsyncLoader');function j(k,l){this._endpoint=k;this._type=l;}g(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};e.exports=j;});
__d("SystemEvents",["Arbiter","Env","ErrorUtils","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Env'),i=b('ErrorUtils'),j=b('UserAgent'),k=b('copyProperties'),l=new g(),m=[],n=1000;setInterval(function(){for(var w=0;w<m.length;w++)m[w]();},n,false);function o(){return (/c_user=(\d+)/.test(document.cookie)&&RegExp.$1)||0;}var p=h.user,q=navigator.onLine;function r(){if(!q){q=true;l.inform(l.ONLINE,q);}}function s(){if(q){q=false;l.inform(l.ONLINE,q);}}if(j.ie()){if(j.ie()>=11){window.addEventListener('online',r,false);window.addEventListener('offline',s,false);}else if(j.ie()>=8){window.attachEvent('onload',function(){document.body.ononline=r;document.body.onoffline=s;});}else m.push(function(){(navigator.onLine?r:s)();});}else if(window.addEventListener)if(!j.chrome()){window.addEventListener('online',r,false);window.addEventListener('offline',s,false);}var t=p;m.push(function(){var w=o();if(t!=w){l.inform(l.USER,w);t=w;}});var u=Date.now();function v(){var w=Date.now(),x=w-u,y=x<0||x>10000;u=w;if(y)l.inform(l.TIME_TRAVEL,x);return y;}m.push(v);m.push(function(){if(window.onerror!=i.onerror)window.onerror=i.onerror;});k(l,{USER:'SystemEvents/USER',ONLINE:'SystemEvents/ONLINE',TIME_TRAVEL:'SystemEvents/TIME_TRAVEL',isPageOwner:function(w){return (w||o())==p;},isOnline:function(){return j.chrome()||q;},checkTimeTravel:v});e.exports=l;});
__d("ChannelSubdomain",["Cookie","JSLogger"],function(a,b,c,d,e,f){var g=b('Cookie'),h=b('JSLogger'),i=h.create('channel'),j=7,k=null;function l(o,p){var q=null,r=m(),s;o--;var t=Math.min(32,j*o);t=Math.max(t,1);var u=false;for(var v=0;v<32;v++){s=(v+p)%t;if(!(r&(1<<s))){u=true;break;}}if(u){k=s;q=k%j;g.set('sub',r|(1<<k));}else{k=-1;q=null;i.error('subdomain_overflow',{slot:k,max:o});}return q;}function m(){var o=g.get('sub')||0;o=parseInt(o,10);return isNaN(o)?0:o;}function n(){if(k!==null&&k>=0){var o=m()&~(1<<k);if(o){g.set('sub',o);}else g.clear('sub');}}e.exports={allocate:l,clear:n};});
__d("ChannelTransport",["copyProperties","bind","AjaxRequest","URI","JSLogger","DocRPC","ChannelConstants","UserAgent","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('bind'),i=b('AjaxRequest'),j=b('URI'),k=b('JSLogger'),l=b('DocRPC'),m=b('ChannelConstants'),n=b('UserAgent'),o=b('setTimeoutAcrossTransitions'),p=k.create('channel');function q(){return (1048576*Math.random()|0).toString(36);}function r(z,aa){var ba=z.subdomain;ba=ba===null?'':(ba+'-');var ca=new j(aa).setDomain(ba+z.host+'.facebook.com').setPort(z.port).setSecure(j().isSecure());return ca;}function s(z){var aa={partition:z.partition,cb:q()},ba=r(z,'/p').setQueryData(aa);p.log('start_p',{uri:ba.toString()});var ca=new i('GET',ba);if(i.supportsCORS())ca.xhr.withCredentials=true;var da=function(ea){p.log('finish_p',{xhr:ea.toJSON?ea.toJSON():ea});};ca.timeout=z.P_TIMEOUT;ca.onError=ca.onSuccess=da;ca.send();}function t(z,aa,ba){var ca=new Image(),da=0,ea=function(ha){ca.abort();return ha?aa():ba();};ca.onload=function(){p.log('ping_ok',{duration:Date.now()-da});ea(true);};ca.onerror=function(){s(z);ea(false);};var fa=o(ca.onerror,10000);ca.abort=function(){if(fa){clearTimeout(fa);fa=null;}ca.onload=ca.onerror=null;};var ga={partition:z.partition,cb:q()};da=Date.now();ca.src=r(z,'/ping').setQueryData(ga);return ca;}function u(z,aa,ba,ca){var da=new Date(),ea=-1;if(z.userActive>0){ea=(da-z.userActive)/1000|0;if(ea<0)p.warn('idle_regression',{idleTime:ea,now:da.getTime(),userActive:z.userActive});}var fa={channel:z.user_channel,seq:z.seq,partition:z.partition,clientid:z.sessionID,cb:q(),idle:ea,cap:0};if(z.userActive>0&&ea<60)fa.state='active';if(z.streamingCapable){fa.mode='stream';fa.format='json';}if(z.profile)fa.profile=z.profile;if(z.webrtcSupport&&(n.chrome()>=24||n.firefox()>=22))fa.cap=m.CAPABILITY_VOIP;var ga=r(z,'/pull').setQueryData(fa),ha=new i('GET',ga);if(i.supportsCORS())ha.xhr.withCredentials=true;ha.timeout=z.streamingCapable?z.STREAMING_TIMEOUT:z.LONGPOLL_TIMEOUT;ha.onJSON=aa;ha.onSuccess=ba;ha.onError=function(){var ia=(this.status==12002&&this._time>=z.MIN_12002_TIMEOUT)||(this.status==504&&this._time>=z.MIN_504_TIMEOUT),ja=ia?ba:ca;return ja&&ja.apply(this,arguments);};ha.send();z.inStreaming=z.streamingCapable;return ha;}function v(z){this.manager=z;(this.init&&this.init());}function w(z){v.apply(this,arguments);}g(w.prototype,{logName:'CORS',enterState:function(z,aa){if(this._request){this._request.abort();this._request=null;}if(z=='init')o(h(this.manager,'exitState',{status:m.OK,stateId:aa.stateId}),3000);if(!/pull|ping/.test(z))return;var ba=this.manager;if(z=='ping'){this._request=t(aa,h(ba,'exitState',{status:m.OK,stateId:aa.stateId}),h(ba,'exitState',{status:m.ERROR,stateId:aa.stateId}));}else if(z=='pull')this._request=u(aa,h(ba,'_processTransportData',aa.stateId),h(ba,'exitState',{status:m.OK,stateId:aa.stateId}),h(ba,'exitState',{status:m.ERROR,stateId:aa.stateId}));}});function x(z){p.log('iframe_init_constructor');v.apply(this,arguments);this._iframe=document.createElement('iframe');this._iframe.style.display='none';document.body.appendChild(this._iframe);l.publish(this,'outerTransport');}g(x.prototype,{logName:'iframe',_initIframe:function(z){p.log('iframe_init_start');window.onchanneliframeready=function(){p.log('iframe_resources');return z.resources;};window.onchanneliframeloaded=function(){p.log('iframe_loaded');};if(z){this._iframeURI=r(z,z.path);if(z.bustIframe){var aa={partition:z.partition,cb:q()};this._iframeURI.setQueryData(aa);}}else this._iframeURI='about:blank';this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);p.log('iframe_uri_set');}catch(ba){p.error('iframe_uri_set_error',ba);this.exitState({status:m.ERROR,stateId:z.stateId},ba+'');}},enterState:function(z,aa){if(z=='init'){this._initIframe(aa);}else if(/idle|ping|pull/.test(z)){if(this._iframeProxy){this._iframeProxy.enterState.apply(this._iframeProxy,arguments);}else if(z!='idle')this.exitState({status:m.ERROR,stateId:aa.stateId},'iframe not yet loaded');}else if(z=='shutdown')this._initIframe();},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments);},exitState:function(z){if(this.manager.state=='init'&&z.status==m.OK)this._iframeProxy=l.proxy(this._iframe.contentWindow,'innerTransport',['enterState'],(this._iframeURI+'').replace(/iframe.*/,''));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments);}});function y(){this.init=this.init.bind(this);v.apply(this,arguments);}g(y.prototype,{logName:'iframe(inner)',init:function(){l.publish(this,'innerTransport');try{var aa=l.proxy(window.parent,'outerTransport',['_processTransportData','exitState'],top.DocRPC.origin);g(this,aa);this.exitState({status:m.OK,stateId:1e+06});}catch(z){p.error('iframe_inner_init_error',z);}},enterState:function(z,aa){if(this._request){this._request.abort();this._request=null;}if(z=='ping'){this._request=t(aa,h(this,'exitState',{status:m.OK,stateId:aa.stateId}),h(this,'exitState',{status:m.ERROR,stateId:aa.stateId}));}else if(z=='pull')this._request=u(aa,h(this,'_processTransportData',aa.stateId),h(this,'exitState',{status:m.OK,stateId:aa.stateId}),h(this,'exitState',{status:m.ERROR,stateId:aa.stateId}));}});e.exports={getURI:r,Transport:v,CORSTransport:w,IframeTransport:x,IframeInnerTransport:y};});
__d("PresencePrivacy",["Arbiter","AsyncRequest","ChannelConstants","copyProperties","Env","JSLogger","PresenceUtil","PresencePrivacyInitialData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('ChannelConstants'),j=b('copyProperties'),k=b('Env'),l=b('JSLogger'),m=b('PresenceUtil'),n=b('PresencePrivacyInitialData'),o='/ajax/chat/privacy/settings.php',p='/ajax/chat/privacy/online_policy.php',q='/ajax/chat/privacy/visibility.php',r='friend_visibility',s='visibility',t='online_policy',u=j({},n.privacyData),v=n.visibility,w=j({},n.privacyData),x=v,y=n.onlinePolicy,z=y,aa=[],ba=false;function ca(){return l.create('blackbird');}var da=j(new g(),{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1});function ea(qa){var ra;for(ra in qa){var sa=qa[ra];if(ra==k.user){ca().error('set_viewer_visibility');throw new Error("Invalid to set current user's visibility");}switch(sa){case da.WHITELISTED:case da.BLACKLISTED:case da.UNLISTED:break;default:ca().error('set_invalid_friend_visibility',{id:ra,value:sa});throw new Error("Invalid state: "+sa);}}for(ra in qa)u[ra]=qa[ra];da.inform('privacy-changed');}function fa(qa,ra){var sa={};sa[qa]=ra;ea(sa);}function ga(qa){switch(qa){case da.ONLINE:case da.OFFLINE:break;default:ca().error('set_invalid_visibility',{value:qa});throw new Error("Invalid visibility: "+qa);}v=qa;da.inform('privacy-changed');da.inform('privacy-user-presence-changed');g.inform('chat/visibility-changed',{sender:this});}function ha(qa){switch(qa){case da.ONLINE_TO_WHITELIST:case da.ONLINE_TO_BLACKLIST:break;default:throw new Error("Invalid default online policy: "+qa);}y=qa;da.inform('privacy-user-presence-changed');da.inform('privacy-changed');}function ia(qa,ra){ba=true;qa.send();}function ja(qa,ra){aa.push({request:qa,data:ra});if(!ba){var sa=aa.shift();ia(sa.request,sa.data);}}function ka(qa,ra){var sa=qa.type;if(sa===r){var ta=ra.payload.user_availabilities;if(!Array.isArray(ta)){da.inform('privacy-availability-changed',{user_availabilities:ta});for(var ua in qa.settings)w[ua]=qa.settings[ua];}}else{if(sa===s){x=qa.visibility;}else if(sa===t)z=qa.online_policy;da.inform('privacy-user-presence-response');}ca().log('set_update_response',{data:qa,response:ra});}function la(qa,ra){if(v!==x)ga(x);if(y!==z)ha(z);j(u,w);da.inform('privacy-changed');aa=[];ca().log('set_error_response',{data:qa,response:ra});}function ma(qa){ba=false;if(aa.length>0){var ra=aa.shift();ia(ra.request,ra.data);}}function na(qa,ra){if(m!=null){var sa=qa.getData();sa.window_id=m.getSessionID();qa.setData(sa);}qa.setHandler(ka.bind(this,ra)).setErrorHandler(la.bind(this,ra)).setTransportErrorHandler(la.bind(this,ra)).setFinallyHandler(ma.bind(this)).setAllowCrossPageTransition(true);return qa;}function oa(qa,ra,sa){return na(new h(qa).setData(ra),sa);}function pa(qa,ra){var sa=ra.obj;if(sa.viewer_id!=k.user){ca().error('invalid_viewer_for_channel_message',{type:qa,data:ra});throw new Error("Viewer got from the channel is not the real viewer");}if(sa.window_id===m.getSessionID())return;var ta=sa.data;if(sa.event=='access_control_entry'){ta.target_ids.forEach(function(va){fa(va,ta.setting);w[va]=ta.setting;});}else{if(sa.event=='visibility_update'){var ua=!!ta.visibility?da.ONLINE:da.OFFLINE;ga(ua);x=ua;}else if(sa.event=='online_policy_update'){ha(ta.online_policy);z=ta.online_policy;}da.inform('privacy-user-presence-response');}ca().log('channel_message_received',{data:ra.obj});}j(da,{WHITELISTED:1,BLACKLISTED:-1,UNLISTED:0,ONLINE:1,OFFLINE:0,ONLINE_TO_WHITELIST:0,ONLINE_TO_BLACKLIST:1,init:function(qa,ra,sa){},setVisibility:function(qa){x=v;ga(qa);var ra={visibility:qa},sa={type:s,visibility:qa},ta=oa(q,ra,sa);ja(ta,sa);ca().log('set_visibility',{data:ra});return qa;},getVisibility:function(){return v;},setOnlinePolicy:function(qa){z=y;ha(qa);var ra={online_policy:qa},sa={type:t,online_policy:qa},ta=oa(p,ra,sa);ja(ta,sa);ca().log('set_online_policy',{data:ra});return qa;},getOnlinePolicy:function(){return y;},getFriendVisibility:function(qa){return u[qa]||da.UNLISTED;},allows:function(qa){if(this.getVisibility()===da.OFFLINE)return false;var ra=this.getOnlinePolicy();return ra===da.ONLINE_TO_WHITELIST?u[qa]==da.WHITELISTED:u[qa]!=da.BLACKLISTED;},setFriendsVisibility:function(qa,ra){if(qa.length>0){var sa={};for(var ta=0;ta<qa.length;ta++){var ua=qa[ta];w[ua]=u[ua];sa[ua]=ra;}ea(sa);var va=ra;if(va==da.UNLISTED)va=w[qa[0]];var wa={users:qa,setting:ra,setting_type:va},xa={type:r,settings:sa},ya=oa(o,wa,xa);ja(ya,xa);ca().log('set_friend_visibility',{data:wa});}return ra;},setFriendVisibilityMap:function(qa,ra){for(var sa in qa)w[sa]=u[sa];ea(qa);var ta={type:r,settings:qa};ja(na(ra,ta),ta);ca().log('set_friend_visibility_from_map',{data:qa});},allow:function(qa){if(this.allows(qa)){ca().error('allow_already_allowed');throw new Error("allow() should only be called for users that "+"are not already allowed");}if(this.getVisibility()===da.OFFLINE){ca().error('allow_called_while_offline');throw new Error("allow() should only be called when the user is already online");}var ra=this.getOnlinePolicy()===da.ONLINE_TO_WHITELIST?da.WHITELISTED:da.UNLISTED;return this.setFriendsVisibility([qa],ra);},disallow:function(qa){if(!this.allows(qa)){ca().error('disallow_already_disallowed');throw new Error("disallow() should only be called for users that "+"are not already disallowed");}if(this.getVisibility()===da.OFFLINE){ca().error('disallow_called_while_offline');throw new Error("disallow() should only be called when the user is already online");}var ra=this.getOnlinePolicy()===da.ONLINE_TO_BLACKLIST?da.BLACKLISTED:da.UNLISTED;return this.setFriendsVisibility([qa],ra);},getBlacklist:function(){var qa=[];for(var ra in u)if(u[ra]===da.BLACKLISTED)qa.push(ra);return qa;},getWhitelist:function(){var qa=[];for(var ra in u)if(u[ra]===da.WHITELISTED)qa.push(ra);return qa;},getMapForTest:function(){return u;},setMapForTest:function(qa){u=qa;}});da.inform('privacy-changed');da.inform('privacy-user-presence-changed');ca().log('initialized',{visibility:v,policy:y});g.subscribe(i.getArbiterType('privacy_changed'),pa.bind(this));g.subscribe(i.ON_CONFIG,function(qa,ra){var sa=ra.getConfig('visibility',null);if(sa!==null&&typeof(sa)!=='undefined'){var ta=sa?da.ONLINE:da.OFFLINE;ga(ta);ca().log('config_visibility',{vis:ta});}}.bind(this));a.PresencePrivacy=e.exports=da;},3);
__d("ChatVisibility",["Arbiter","JSLogger","PresencePrivacy"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('JSLogger'),i=b('PresencePrivacy'),j={isOnline:function(){return i.getVisibility()===i.ONLINE;},hasBlackbirdEnabled:function(){return this.isVisibleToMostFriends()||this.isVisibleToSomeFriends();},isVisibleToMostFriends:function(){return i.getOnlinePolicy()===i.ONLINE_TO_BLACKLIST&&i.getBlacklist().length>0;},isVisibleToSomeFriends:function(){return i.getOnlinePolicy()===i.ONLINE_TO_WHITELIST&&i.getWhitelist().length>0;},goOnline:function(k){if(i.getVisibility()===i.OFFLINE){h.create('blackbird').log('chat_go_online');i.setVisibility(i.ONLINE);g.inform('chat-visibility/go-online');}k&&k();},goOffline:function(k){if(i.getVisibility()===i.ONLINE){h.create('blackbird').log('chat_go_offline');i.setVisibility(i.OFFLINE);g.inform('chat-visibility/go-offline');}k&&k();},toggleVisibility:function(){if(j.isOnline()){j.goOffline();}else j.goOnline();}};a.ChatVisibility=e.exports=j;},3);
__d("MovingStat",[],function(a,b,c,d,e,f){function g(h){h=h||60000;var i={t:new Date(),count:0,v:0},j=i,k=0,l=0;function m(){var n=new Date()-h;while(j&&j.next&&j.t<n){k-=j.v;l-=j.count;j=j.next;}}this.add=function(n){k+=n;l++;var o=new Date();if(o-i.t<1000){i.v+=n;i.count++;}else{i.next={t:o,v:n,count:1};i=i.next;m();}};this.tally=function(n){n=n||1000;m();return {sum:k,count:l,timeAverage:k*n/h};};}e.exports=g;});
__d("ChannelManager",["function-extensions","AjaxRequest","Arbiter","AsyncRequest","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChatVisibility","DTSG","Env","Event","FBAjaxRequest","JSLogger","MovingStat","PresenceCookieManager","PresenceState","PresenceUtil","Run","SystemEvents","URI","UserActivity","copyProperties","createArrayFrom","setIntervalAcrossTransitions","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){b('function-extensions');var g=b('AjaxRequest'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('ChannelConstants'),k=b('ChannelInitialData'),l=b('ChannelSubdomain'),m=b('ChannelTransport'),n=b('ChatVisibility'),o=b('DTSG'),p=b('Env'),q=b('Event'),r=b('FBAjaxRequest'),s=b('JSLogger'),t=b('MovingStat'),u=b('PresenceCookieManager'),v=b('PresenceState'),w=b('PresenceUtil'),x=b('Run'),y=b('SystemEvents'),z=b('URI'),aa=b('UserActivity'),ba=b('copyProperties'),ca=b('createArrayFrom'),da=b('setIntervalAcrossTransitions'),ea=b('setTimeoutAcrossTransitions'),fa,ga=s.create('channel'),ha=null;function ia(ta){ha=ta;}var ja={idle:{ok:'init!'},init:{ok:'pull!',error:'reconnect',sys_online:'init',sys_timetravel:'init'},pull:{ok:'pull!',error:'ping',error_missing:'pull',error_msg_type:'pull',refresh_0:'reconnect',refresh_110:'reconnect',refresh_111:'reconnect',refresh_112:'pull',refresh_113:'pull',refresh_117:'reconnect'},ping:{ok:'pull!',error:'ping',error_stale:'reconnect!'},reconnect:{ok:'init!',error:'reconnect',sys_online:'reconnect',sys_timetravel:'reconnect'},shutdown:{},_all:{error_max:'shutdown!',error_shutdown:'shutdown!',sys_owner:'reconnect',sys_nonowner:'idle!',sys_online:'ping',sys_offline:'idle!',sys_timetravel:'ping'}},ka={userActive:n.isOnline()?Date.now():0,sessionID:(Math.random()*2147483648|0).toString(16),streamingCapable:false,inStreaming:false,LONGPOLL_TIMEOUT:60000,STREAMING_TIMEOUT:60000,P_TIMEOUT:30000,IFRAME_LOAD_TIMEOUT:30000,MIN_RETRY_INTERVAL:5000,MAX_RETRY_INTERVAL:30000,MIN_12002_TIMEOUT:9000,MIN_504_TIMEOUT:20000,STALL_THRESHOLD:180000,JUMPSTART_THRESHOLD:90000,MIN_INIT_PROBE_DELAY:3000,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12000,PROBE_DELAY:60000,PROBE_HEARTBEATS_INTERVAL_LOW:1000,PROBE_HEARTBEATS_INTERVAL_HIGH:3000,STREAMING_EXIT_STATE_ON_CONTINUE:false},la=1,ma={},na=0;function oa(){return i.lastSuccessTime?Math.round((Date.now()-i.lastSuccessTime)/1000):-1;}function pa(){var ta={};if(fa.getConfig('host'))ta[fa.getConfig('user_channel')]=fa.getConfig('seq',0);return ta;}function qa(){var ta=Date.now(),ua=Date.now(),va={total:0},wa='idle',xa=false;y.subscribe([y.USER,y.ONLINE,y.TIME_TRAVEL],function(ab,bb){sa(true);ua=null;fa.lastPullTime=Date.now();var cb;switch(ab){case y.USER:cb=y.isPageOwner()?j.SYS_OWNER:j.SYS_NONOWNER;break;case y.ONLINE:cb=bb?j.SYS_ONLINE:j.SYS_OFFLINE;break;case y.TIME_TRAVEL:cb=j.SYS_TIMETRAVEL;break;}fa.exitState({status:cb,stateId:la});});var ya=function(ab,bb){var cb=Date.now(),db;if(bb){ta=cb;db=bb.nextState||bb.state;}else db=wa;y.checkTimeTravel();if(ua){var eb=Math.round((cb-ua)/1000);if(eb>0){va[wa]=(va[wa]||0)+eb;va.total+=eb;}}wa=db;ua=cb;if(!ab){va.lastSuccessTime=oa();va.online=y.isOnline();ga.log('rollup',va);}};h.subscribe(j.ON_ENTER_STATE,ya);da(ya,60000);h.subscribe(s.DUMP_EVENT,function(ab,bb){bb.channelRollup=va;});var za=function(){if(fa.isShutdown()||fa.shouldIdle())return;y.checkTimeTravel();var ab=Date.now()-(fa.lastPullTime||p.start);if(!xa&&ab>ka.STALL_THRESHOLD){var bb=oa();ga.error('stall',{lastSuccessTime:bb,rollupState:wa});xa=true;}var cb=Date.now()-ta;if(fa.state=='pull'&&cb>ka.JUMPSTART_THRESHOLD){ta=null;ga.warn('jumpstart',{state:fa.state,dormant:cb});fa.enterState('init');}};da(za,10000);}function ra(){var ta=Date.now(),ua=1;function va(){ea(va,ua*1000);var ab=fa.state;if(ab=='idle'&&fa.shouldIdle())return;ga.bump('conn_t',ua);if(ab=='pull')ga.bump('conn_t_pull',ua);}va();var wa=[15,30,60,120,240],xa=false,ya=false;function za(ab){ea(function(){ga.rate('pullenter_'+ab,xa);ga.rate('pullexit_'+ab,ya);},ab*1000);}while(wa.length)za(wa.shift());h.subscribe(j.ON_ENTER_STATE,function(ab,bb){if(bb.state=='pull')xa=true;ta=Date.now();});h.subscribe(j.ON_EXIT_STATE,function(ab,bb){if(bb.state!='pull'||!ta)return;var cb='other';if(bb.status==j.OK){ya=true;cb='ok';}else if(bb.xhr&&bb.xhr.errorType){cb=/ar:(\w+)/.test(bb.xhr.errorType)&&RegExp.$1;}else if(/^sys_/.test(bb.status))return;var db=(Date.now()-ta)/1000;if(db<0){return;}else if(db>3600)db=3600;ga.bump('conn_num');ga.bump('conn_exit',db);ga.bump('conn_num_'+cb);ga.bump('conn_exit_'+cb,db);});}function sa(ta){if(ta){na=0;ma={};}else na++;}fa={state:'idle',nextState:null,lastPullTime:Date.now(),heartbeats:[],setTestCallback:ia,init:function(ta){this.init=function(){};if(typeof(aa)!='undefined'){aa.subscribe(function(){if(n.isOnline())ka.userActive=Date.now();}.bind(this));}else ga.error('user_activity_undefined');u.register('ch',pa);var ua=this.getConfig('max_conn',2),va=Math.floor(Math.random()*32);ka.subdomain=l.allocate(ua,va);if(typeof window.onpageshow!='undefined'){q.listen(window,'pagehide',l.clear);}else x.onUnload(l.clear);this._transportRate=new t(30000);var wa=(g.supportsCORS()&&!ka.forceIframe)?'CORSTransport':'IframeTransport';this.transport=new m[wa](this);if(ta)this.enterState.apply(this,arguments);h.subscribe(s.DUMP_EVENT,function(event,ya){ya.transportRate=this._transportRate.tally();ya.transportType=wa;ya.transportVersion=2;}.bind(this));qa();ra();if(fa.getConfig('tryStreaming')&&fa.getConfig('host')&&g.supportsCORS()&&!ka.forceIframe){var xa=ka.MIN_INIT_PROBE_DELAY+Math.random()*ka.INIT_PROBE_DELAY_RANDOMIZE_RANGE;ea(this._probeTest,xa);}},configure:function(){var ta=ca(arguments);ga.log('configure',ta);ta.forEach(ba.bind(null,ka));h.inform(j.ON_CONFIG,this);},getConfig:function(ta,ua){return ta in ka?ka[ta]:ua;},isShutdown:function(){return this.state=='shutdown';},shouldIdle:function(){return !(y.isPageOwner()&&y.isOnline());},_sendIframeError:function(ta){var ua=new i().setURI('/ajax/presence/reconnect.php').setData({reason:ta,fb_dtsg:o.getToken()}).setOption('suppressErrorHandlerWarning',true).setOption('retries',1).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true);ua.specifiesWriteRequiredParams()&&ua.send();},_getDelay:function(){var ta=Math.min(ka.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,na-1)),ka.MAX_RETRY_INTERVAL);return ta*(.75+Math.random()/2)|0;},enterState:function(){if(this._inEnterState)ga.warn('enterstate_recursion');this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false;}catch(ta){this._inEnterState=false;throw ta;}},_enterState:function(ta){var ua=0,va=ca(arguments);if(this.isShutdown())return;if(ta!='idle!'&&this.shouldIdle())return;la++;ka.stateId=la;clearTimeout(this._deferredTransition);this._deferredTransition=null;this.transport.enterState('idle');this.state='idle';this.nextState=null;if(/!$/.test(ta)){var wa=this._transportRate.tally().timeAverage,xa=fa.getConfig('MAX_CHANNEL_STATES_PER_SEC',1);if(wa>=xa){if(!this._throttled){this._throttled=true;ga.warn('throttled');}ga.bump('throttle');ua=1000/xa;}}else if(!(/#$/.test(ta)))ua=this._getDelay();ta=ta.replace(/\W*$/,'');if(!ja[ta])throw new Error('invalid state:'+ta);var ya;if(ua<=0){ya={state:ta};this._transportRate.add(1);this.state=ta;var za=this['_enter_'+this.state];if(za){va.shift();za.apply(this,va);}if(/init|idle|pull|ping/.test(this.state)){if(ka.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];this.transport.enterState(this.state,ka);if(this.state=='ping'){ya.url=m.getURI(ka).toString();ya.port=ka.port||'undefined';}}}else{this.state='idle';this.nextState=ta;ya={state:this.state,delay:ua,nextState:ta};va[0]=ta+'#';this._deferredTransition=(function(){this._deferredTransition=null;this.enterState.apply(this,va);}).bind(this).defer(ua,false);}if(/pull/.test(ta)){ya.client_id=ka.sessionID;ya.streaming=ka.inStreaming;}ga.log('enter_'+this.state,ya);h.inform(j.ON_ENTER_STATE,ya);},exitState:function(ta,ua){var va=ta.stateId,wa=ta.status;if(this.isShutdown()||va<la)return;var xa=ca(arguments),ya=this.state;xa[0]=ta.status;var za={state:ya,status:wa};if(/pull/.test(ya)){za.client_id=ka.sessionID;za.streaming=ka.inStreaming;}if(/ping/.test(ya)&&wa!=j.OK)za.url=m.getURI(ka).toString();if(this.nextState)za.nextState=this.nextState;if(ua&&ua.errorType){za.xhr=ua.toJSON?ua.toJSON():ua;delete za.xhr.json;}if(ua&&ua.json){if(ua.json.t)za.t=ua.json.t;if(ua.json.reason)za.reason=ua.json.reason;if(ua.json.seq)za.seq=ua.json.seq;}ga.log('exit_'+ya,za);h.inform(j.ON_EXIT_STATE,za);var ab=this['_exit_'+ya];if(ab)wa=ab.apply(this,xa)||wa;if(wa!=j.OK){sa();ma[ya]=(ma[ya]||0)+1;}var bb=ja[this.nextState||ya][wa]||ja._all[wa],cb=bb&&bb.replace(/!*$/,'');if(!cb){ga.error('terminal_transition',za);this._shutdownHint=j.HINT_INVALID_STATE;bb='shutdown!';}this._lastState=ya;this._lastStatus=wa;this.enterState(bb);},_processTransportData:function(ta,ua){var va=ua.json,wa=va.t;if('s' in va){va.seq=va.s;delete va.s;}var xa=ka.seq;if('seq' in va){ka.seq=va.seq;v.doSync();}switch(wa){case 'continue':if(ka.inStreaming&&this.heartbeats.length<1){ka.streamingCapable=false;ga.log('switch_to_longpoll');ea(this._probeTest,ka.PROBE_DELAY);}sa(true);if(!ka.inStreaming||ka.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:j.OK,stateId:ta});break;case 'refresh':case 'refreshDelay':this.exitState({status:'refresh_'+(va.reason||0),stateId:ta},ua);break;case 'fullReload':u.clear();ga.log('invalid_history');h.inform(j.ON_INVALID_HISTORY);this.exitState({status:j.ERROR_MISSING,stateId:ta},ua);break;case 'msg':var ya,za,ab,bb;sa(true);za=va.ms;ab=ka.seq-za.length;for(ya=0;ya<za.length;ya++,ab++)if(ab>=xa){bb=za[ya];if(bb.type){if(bb.type==='messaging'&&bb.message){var cb=bb.unread_counts&&bb.unread_counts.inbox;ga.debug('message',{type:'messaging',inbox_unread:cb,tid:bb.message.tid,mid:bb.message.mid});}else if(bb.type==='m_messaging'){ga.debug('message',{type:'m_messaging',tid:bb.tid,mid:bb.uuid});}else ga.debug('message',{type:bb.type});h.inform(j.getArbiterType(bb.type),{obj:bb});}}else ga.warn('seq_regression',{seq:ab,last_seq:xa,messages:za.length});break;case 'heartbeat':if(ka.inStreaming){var db=Date.now();if(this.heartbeats.length>0){var eb=db-this.heartbeats[this.heartbeats.length-1];ga.log('heartbeat_interval',{client_id:ka.sessionID,interval:eb});}this.heartbeats.push(db);}break;default:ga.error('unknown_msg_type',{type:wa});break;}},_enter_init:function(){if(ma.init>=fa.getConfig('MAX_INIT_FAILS',2))return this.exitState.bind(this,{status:j.ERROR_MAX,stateId:la}).defer();this._initTimer=this.exitState.bind(this,{status:j.ERROR,stateId:la},'timeout').defer(ka.IFRAME_LOAD_TIMEOUT,false);},_enter_reconnect:function(ta){var ua=la;if(!w.hasUserCookie()){ga.warn('no_user_cookie');(function(){fa._shutdownHint=j.HINT_AUTH;fa.exitState({status:j.ERROR_SHUTDOWN,stateId:ua});}).defer();return;}var va={reason:ta,fb_dtsg:o.getToken()};if(p.fb_isb)va.fb_isb=p.fb_isb;if(ha)ha(va);var wa=new r('GET','/ajax/presence/reconnect.php',va);wa.onSuccess=(function(){fa.configure(wa.json);u.store();this.exitState({status:j.OK,stateId:ua});}).bind(this);wa.onError=(function(){var xa=wa.json&&wa.json.error;if(wa.errorType==g.TRANSPORT_ERROR||wa.errorType==g.PROXY_ERROR)this._shutdownHint=j.HINT_CONN;if(xa&&xa==1356007){this._shutdownHint=j.HINT_MAINT;}else if(xa==1357001||xa==1357004||xa==1348009){this._shutdownHint=j.HINT_AUTH;}else this._shutdownHint=null;this.exitState({status:this._shutdownHint?j.ERROR_SHUTDOWN:j.ERROR,stateId:ua},wa);}).bind(this);wa.send();},_enter_shutdown:function(){h.inform(j.ON_SHUTDOWN,{reason:this._shutdownHint});},_exit_init:function(ta){if(this._initTimer)this._initTimer=clearTimeout(this._initTimer);if(ta==j.ERROR_MAX)this._sendIframeError(j.reason_IFrameLoadGiveUp);},_exit_pull:function(ta){if(ta==j.OK)this.lastPullTime=Date.now();},_exit_ping:function(ta){if(ta==j.OK){var ua=Date.now()-(this.lastPullTime||p.start);if(ua>ka.STALL_THRESHOLD)return j.ERROR_STALE;}},_probeTest:function(){ka.streamingCapable=false;var ta=[],ua={mode:'stream',format:'json'},va=new z('/probe').setDomain(ka.host+'.facebook.com').setPort(ka.port).setSecure(z().isSecure()).setQueryData(ua),wa=new g('GET',va);wa.onJSON=function(xa,ya){if(xa&&xa.json&&xa.json.t==='heartbeat'){ta.push(Date.now());if(ta.length>=2){var za=ta[1]-ta[0];if(za>=ka.PROBE_HEARTBEATS_INTERVAL_LOW&&za<=ka.PROBE_HEARTBEATS_INTERVAL_HIGH){ka.streamingCapable=true;ga.log('switch_to_streaming');}ga.log('probe_ok',{time:za});}}};wa.onSuccess=function(xa){if(ta.length!=2){ka.streamingCapable=false;ga.error('probe_error',{error:'beats.length = '+ta.length});}};wa.onError=function(xa){ka.streamingCapable=false;ga.error('probe_error',xa);};ga.log('probe_request');wa.send();}};e.exports=fa;if(k.channelConfig){fa.configure(k.channelConfig);if(/shutdown/.test(k.state))fa._shutdownHint=j[k.reason];fa.init(k.state,k.reason);}});
__d("ChannelConnection",["Arbiter","copyProperties","ChatConfig","Run","SystemEvents","ChannelConstants","ChannelManager","JSLogger","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('copyProperties'),i=b('ChatConfig'),j=b('Run'),k=b('SystemEvents'),l=b('ChannelConstants'),m=b('ChannelManager'),n=b('JSLogger'),o=b('setTimeoutAcrossTransitions'),p=n.create('channel_connection'),q=null,r=null,s=null,t=null,u=0,v=h(new g(),{CONNECTED:'chat-connection/connected',RECONNECTING:'chat-connection/reconnecting',SHUTDOWN:'chat-connection/shutdown',MUTE_WARNING:'chat-connection/mute',UNMUTE_WARNING:'chat-connection/unmute'});function w(){if(r){clearTimeout(r);r=null;}}function x(){w();p.log('unmute_warning');v.inform(v.UNMUTE_WARNING);}function y(ca){w();r=x.defer(ca,false);p.log('mute_warning',{time:ca});v.inform(v.MUTE_WARNING);}function z(){if(s){clearTimeout(s);s=null;}}function aa(ca,da){z();if(ca===l.ON_ENTER_STATE&&(da.nextState||da.state)==='pull'){if(t!==v.CONNECTED){p.log('connected');var ea=!t;t=v.CONNECTED;u=0;v.inform(v.CONNECTED,{init:ea});}}else if(ca===l.ON_ENTER_STATE&&((da.nextState||da.state)==='ping'||(!da.nextState&&da.state==='idle'))){s=(function(){var fa=null;if(!(da.state==='idle'&&!da.nextState))fa=(da.delay||0);p.log('reconnecting',{delay:fa});if(v.disconnected())p.log('reconnecting_ui',{delay:fa});t=v.RECONNECTING;(da.state==='idle')&&u++;if(u>1){v.inform(v.RECONNECTING,fa);}else if(!da.nextState&&da.state==='idle')aa(ca,da);}).defer(500,false);}else if(ca===l.ON_SHUTDOWN){p.log('shutdown',{reason:da.reason});t=v.SHUTDOWN;u=0;v.inform(v.SHUTDOWN,da.reason);}}function ba(ca){if(m.state==='ping'||m.isShutdown())return;p.log('reconnect',{now:ca});v.inform(v.RECONNECTING,0);if(!!ca){if(q!==null){clearTimeout(q);q=null;}m.enterState('ping!');}else if(!q)q=o(function(){m.enterState('ping!');q=null;},i.get('channel_manual_reconnect_defer_msec'));}if(m.isShutdown()){aa(l.ON_SHUTDOWN,m._shutdownHint);}else aa(l.ON_ENTER_STATE,{state:m.state,nextState:m.nextState,delay:0});g.subscribe([l.ON_ENTER_STATE,l.ON_SHUTDOWN],aa);k.subscribe(k.TIME_TRAVEL,function(){ba();y(i.get('mute_warning_time_msec'));});j.onBeforeUnload(z,false);h(v,{disconnected:function(){return t===v.SHUTDOWN||(t===v.RECONNECTING&&!r&&u>1);},isShutdown:function(){return t===v.SHUTDOWN;},reconnect:ba,unmuteWarning:x});e.exports=v;});
__d("ChatFavoriteList",["AsyncRequest","arrayContains","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('arrayContains'),i=b('emptyFunction'),j=false,k=[],l=[],m=false;function n(){var r=k.join(',');new g('/ajax/chat/favorite_list.php').setData({favorite_list:r}).setHandler(i).setErrorHandler(i).send();}function o(r){return r.toString();}function p(r){if(k.length!=r.length)return true;for(var s=0;s<r.length;s++)if(k[s]!==r[s].toString())return true;return false;}var q={isEditMode:function(){var r=null;d(['ChatSidebar'],function(s){r=s;});return j&&r&&r.isEnabled();},toggleEditMode:function(){j=!j;if(j)l=k.slice();},get:function(){if(j){return l.slice();}else return k.slice();},isFavored:function(r){return h(l,r.toString());},init:function(r){k=r.slice().map(o);l=k.slice();},toggleID:function(r){if(!j)return;r=r.toString();var s=l.indexOf(r);if(s>=0){l.splice(s,1);}else l.push(r);m=true;},hasChanged:function(){if(m){m=false;return true;}return false;},updateList:function(r){if(!j)return;l=r.map(o);},save:function(){if(p(l)){k=l;n();}}};e.exports=q;});
__d("ChatContexts",[],function(a,b,c,d,e,f){var g={};function h(k){var l=k?k.subtext:'';return l;}function i(k,l){g[k]=l;}var j={get:function(k){if(k in g){return g[k];}else return null;},update:function(k){for(var l in k)i(l,k[l]);},getShortDisplay:function(k){return h(j.get(k));}};e.exports=j;});
__d("Poller",["ArbiterMixin","AsyncRequest","Cookie","Env","copyProperties","emptyFunction","mixin"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('Cookie'),j=b('Env'),k=b('copyProperties'),l=b('emptyFunction'),m=b('mixin'),n=m(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(t){"use strict";this._config=k({clearOnQuicklingEvents:true,setupRequest:l,interval:null,maxRequests:Infinity,dontStart:false},t);if(!this._config.dontStart)this.start();}q.prototype.start=function(){"use strict";if(this._polling)return this;this._requests=0;this.request();return this;};q.prototype.stop=function(){"use strict";this._cancelRequest();return this;};q.prototype.mute=function(){"use strict";this._muted=true;return this;};q.prototype.resume=function(){"use strict";if(this._muted){this._muted=false;if(!this._handle&&this._polling)return this.request();}return this;};q.prototype.skip=function(){"use strict";this._skip=true;return this;};q.prototype.reset=function(){"use strict";return this.stop().start();};q.prototype.request=function(){"use strict";this._cancelRequest();this._polling=true;if(!s())return this._done();if(this._muted)return this;if(++this._requests>this._config.maxRequests)return this._done();var t=new h(),u=false;t.setInitialHandler(function(){return !u;});this._cancelRequest=function(){u=true;this._cleanup();}.bind(this);t.setFinallyHandler(r.bind(this));t.setInitialHandler=l;t.setFinallyHandler=l;this._config.setupRequest(t,this);if(this._skip){this._skip=false;r.bind(this).defer();}else t.send();return this;};q.prototype.isPolling=function(){"use strict";return this._polling;};q.prototype.isMuted=function(){"use strict";return this._muted;};q.prototype.setInterval=function(t){"use strict";if(t){this._config.interval=t;this.start();}};q.prototype.getInterval=function(){"use strict";return this._config.interval;};q.prototype._cleanup=function(){"use strict";if(this._handle)clearTimeout(this._handle);this._handle=null;this._cancelRequest=l;this._polling=false;};q.prototype._done=function(){"use strict";this._cleanup();this.inform('done',{sender:this});return this;};q.MIN_INTERVAL=2000;k(q.prototype,{_config:null,_requests:0,_muted:false,_polling:false,_skip:false,_cancelRequest:l});function r(){if(!this._polling)return;if(this._requests<this._config.maxRequests){var t=this._config.interval;t=typeof t==='function'?t(this._requests):t;this._handle=this.request.bind(this).defer((t>q.MIN_INTERVAL)?t:q.MIN_INTERVAL,this._config.clearOnQuicklingEvents);}else this._done();}function s(){return j.user==i.get('c_user');}e.exports=q;});
__d("PresenceStatus",["AvailableListConstants","ChatConfig","ChatVisibility","Env","PresencePrivacy","ServerTime","createObjectFrom"],function(a,b,c,d,e,f){var g=b('AvailableListConstants'),h=b('ChatConfig'),i=b('ChatVisibility'),j=b('Env'),k=b('PresencePrivacy'),l=b('ServerTime'),m=b('createObjectFrom'),n={},o={},p={},q={},r={},s={},t={resetPresenceData:function(){n={};s={};r={};q={};},reset:function(){t.resetPresenceData();o={};p={};},get:function(u){if(u==j.user)return i.isOnline()?g.ACTIVE:g.OFFLINE;var v=g.OFFLINE;if(u in n)v=n[u];if(v==g.OFFLINE)if(o[u])v=g.MOBILE;if(!k.allows(u))v=g.OFFLINE;return v;},getDetailedActivePresence:function(u){if(!h.get('sidebar_mobile_web_presence'))return null;var v=s[u];if(!v)return g.ACTIVE_ON_WEB;var w=v[g.WEB_STATUS],x=v[g.FB_APP_STATUS],y=v[g.MESSENGER_STATUS],z=v[g.OTHER_STATUS];if(x===g.STATUS_ACTIVE||y===g.STATUS_ACTIVE){return g.ACTIVE_ON_MOBILE;}else if(w===g.STATUS_ACTIVE||z===g.STATUS_ACTIVE){return g.ACTIVE_ON_WEB;}else return null;},isBirthday:function(u){return p[u];},getGroup:function(u){if(!h.get('chat_group_presence',0))return g.OFFLINE;return u.some(function(v){if(v==j.user)return false;return (t.get(v)===g.ACTIVE);})?g.ACTIVE:g.OFFLINE;},set:function(u,v,w,x,y){if(u==j.user)return false;switch(v){case g.OFFLINE:case g.IDLE:case g.ACTIVE:case g.MOBILE:break;default:return false;}var z=t.get(u)!=v;if(w){q[u]=l.get();r[u]=x;}n[u]=v;if(y)s[u]=y;return z;},setMobileFriends:function(u){o=m(u);},setBirthdayFriends:function(u){p=m(u);},getOnlineIDs:function(){var u,v=[];for(u in n)if(t.get(u)===g.ACTIVE)v.push(u);return v;},getAvailableIDs:function(){var u=t.getOnlineIDs(),v;for(v in o){if(n[v])continue;u.push(v);}return u;},getOnlineCount:function(){return t.getOnlineIDs().length;},getPresenceStats:function(){var u=0,v=0,w=0,x=0,y=0;for(var z in n){u+=1;switch(t.get(z)){case g.OFFLINE:v+=1;break;case g.IDLE:w+=1;break;case g.ACTIVE:x+=1;break;case g.MOBILE:y+=1;break;default:break;}}return {total:u,offline:v,idle:w,active:x,mobile:y};},getDebugInfo:function(u){return {id:u,presence:n[u],overlaySource:r[u],overlayTime:q[u],mobile:o[u]};}};e.exports=t;});
__d("PresencePoller",["AvailableListConstants","AvailableListInitialData","BanzaiODS","ChannelImplementation","ChatContexts","ChatFavoriteList","ChatVisibility","Env","JSLogger","LastMobileActiveTimes","Poller","PresenceStatus","ServerTime","ShortProfiles","UserActivity","copyProperties","debounceAcrossTransitions"],function(a,b,c,d,e,f){var g=b('AvailableListConstants'),h=b('AvailableListInitialData'),i=b('BanzaiODS'),j=b('ChannelImplementation').instance,k=b('ChatContexts'),l=b('ChatFavoriteList'),m=b('ChatVisibility'),n=b('Env'),o=b('JSLogger'),p=b('LastMobileActiveTimes'),q=b('Poller'),r=b('PresenceStatus'),s=b('ServerTime'),t=b('ShortProfiles'),u=b('UserActivity'),v=b('copyProperties'),w=b('debounceAcrossTransitions'),x=30,y=5,z='/ajax/chat/buddy_list.php',aa=1800000,ba=h.pollInterval,ca=h.lazyPollInterval,da=h.lazyThreshold,ea=o.create('available_list'),fa='presence_poller';i.setEntitySample(fa,.01);function ga(ha){"use strict";this.$PresencePoller0=ha;this.$PresencePoller1=false;this.$PresencePoller2=h.chatNotif;this.$PresencePoller3=new q({interval:ba,setupRequest:this.$PresencePoller4.bind(this),clearOnQuicklingEvents:false,dontStart:true});if(h.availableCount>=x){this.$PresencePoller5=Date.now();this.$PresencePoller6=Date.now();this.$PresencePoller7=Date.now();this.$PresencePoller8=h.updateTime;}else{this.$PresencePoller5=0;this.$PresencePoller8=0;this.$PresencePoller6=0;this.$PresencePoller7=0;}this.$PresencePoller9=false;this.$PresencePollera=0;if(h.favoriteList)l.init(h.favoriteList);this.$PresencePollerb('available_initial_data',h.updateTime,h.availableList,h.lastActiveTimes,h.mobileFriends,h.birthdayFriends);u.subscribe(function(ia,ja){if(ja.idleness>ba)this.forceUpdate();}.bind(this));}ga.prototype.start=function(){"use strict";this.$PresencePoller3.start.bind(this.$PresencePoller3).defer();};ga.prototype.forceUpdate=function(){"use strict";if(!this.$PresencePoller9)this.$PresencePoller3.request();};ga.prototype.getIsUserIdle=function(){"use strict";return this.$PresencePoller1;};ga.prototype.getWebChatNotification=function(){"use strict";return this.$PresencePoller2;};ga.prototype.getCallback=function(){"use strict";return this.$PresencePoller0;};ga.prototype.$PresencePollerc=function(){"use strict";return w(function(){this.$PresencePoller0(g.ON_AVAILABILITY_CHANGED);}.bind(this),0)();};ga.prototype.$PresencePollerb=function(ha,ia,ja,ka,la,ma){"use strict";this.$PresencePoller8=ia;if(!Array.isArray(ja)){r.resetPresenceData();for(var na in ja)r.set(na,ja[na].a,false,ha,ja[na].p);}if(ka)p.update(ka,ia);if(la)r.setMobileFriends(la);if(ma)r.setBirthdayFriends(ma);this.$PresencePollerc();};ga.prototype.$PresencePoller4=function(ha){"use strict";if(j.isShutdown()||!m.isOnline()){this.$PresencePoller3.skip();i.bumpEntityKey(fa,'skip.offline');return;}if(Date.now()-this.$PresencePoller5<ba){this.$PresencePoller3.skip();i.bumpEntityKey(fa,'skip.recent');return;}i.bumpEntityKey(fa,'request');this.$PresencePoller5=Date.now();var ia=(Date.now()-this.$PresencePoller7>aa),ja=t.getCachedProfileIDs().join(",");this.$PresencePoller9=true;ha.setHandler(this.$PresencePollerd.bind(this)).setErrorHandler(this.$PresencePollere.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({user:n.user,cached_user_info_ids:ja,fetch_mobile:ia}).setURI(z).setAllowCrossPageTransition(true);};ga.prototype.$PresencePollerd=function(ha){"use strict";var ia=ha.getPayload(),ja=ia.buddy_list;if(!ja){this.$PresencePollere(ha);return;}i.bumpEntityKey(fa,'response');this.$PresencePoller9=false;this.$PresencePollerf();this.$PresencePoller6=Date.now();s.update(ia.time);if(ja.mobile_friends)this.$PresencePoller7=Date.now();this.$PresencePollera=0;this.$PresencePollerg();var ka=ja.userInfos;if(ka)t.setMulti(ka);var la=ja.chatContexts;la&&k.update(la);this.$PresencePoller1=ja.userIsIdle;if(ja.chatNotif!==undefined){this.$PresencePoller2=ja.chatNotif;this.$PresencePoller0(g.ON_CHAT_NOTIFICATION_CHANGED,this.$PresencePoller2);}this.$PresencePollerb('buddy_list_poller',ia.time,ja.nowAvailableList,ja.last_active_times,ja.mobile_friends,ja.todays_birthdays);};ga.prototype.$PresencePollere=function(ha){"use strict";i.bumpEntityKey(fa,'error');if(ha.getError()==1356007)return;this.$PresencePoller9=false;this.$PresencePollera++;if(this.$PresencePollera++>=y)this.$PresencePoller0(g.ON_UPDATE_ERROR);};ga.prototype.$PresencePollerg=function(){"use strict";var ha=u.isActive(da)?ba:ca;i.bumpEntityKey(fa,'period.'+ha);this.$PresencePoller3.setInterval(ha);};ga.prototype.$PresencePollerf=function(){"use strict";var ha=Date.now(),ia=ha-this.$PresencePoller6;ea.log('buddylist_presence_stats',v({duration:ia},r.getPresenceStats()));};e.exports=ga;});
__d("AvailableList",["function-extensions","Arbiter","ArbiterMixin","AsyncRequest","AvailableListConstants","ChannelImplementation","ChannelConstants","ChatConfig","ChatFavoriteList","JSLogger","PresencePoller","PresencePrivacy","PresenceStatus","ShortProfiles","TypingDetector","copyProperties","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('AvailableListConstants'),k=b('ChannelImplementation').instance,l=b('ChannelConstants'),m=b('ChatConfig'),n=b('ChatFavoriteList'),o=b('JSLogger'),p=b('PresencePoller'),q=b('PresencePrivacy'),r=b('PresenceStatus'),s=b('ShortProfiles'),t=b('TypingDetector'),u=b('copyProperties'),v=b('debounceAcrossTransitions'),w=b('emptyFunction'),x=u({},j,h);x.subscribe([j.ON_AVAILABILITY_CHANGED,j.ON_UPDATE_ERROR],function(ea,fa){g.inform(ea,fa);});var y=v(function(){x.inform(j.ON_AVAILABILITY_CHANGED);},0);function z(ea,fa,ga,ha){var ia=r.set(ea,fa,ga,ha);if(ia)y();}function aa(ea){var fa=ea.payload.availability||{};for(var ga in fa)z(ga,fa[ga],true,'mercury_tabs');}function ba(ea){var fa=x.getDebugInfo(ea),ga=(fa.presence==j.ACTIVE),ha=new i('/ajax/mercury/tabs_presence.php').setData({target_id:ea,to_online:ga,presence_source:fa.overlaySource,presence_time:fa.overlayTime}).setHandler(aa).setErrorHandler(w).setAllowCrossPageTransition(true).send();}function ca(ea,fa){fa.chat_config=m.getDebugInfo();fa.available_list_debug_info={};x.getAvailableIDs().forEach(function(ga){fa.available_list_debug_info[ga]=x.getDebugInfo(ga);});fa.available_list_poll_interval=x._poller&&x._poller.getInterval();}var da=new p(function(event){x.inform(event);});u(x,{get:function(ea){return r.get(ea);},updateForID:function(ea){ba(ea);},getWebChatNotification:function(){return da.getWebChatNotification();},isUserIdle:function(){return da.getIsUserIdle();},isReady:function(){return true;},set:function(ea,fa,ga){z(ea,fa,true,ga);},update:function(){da.forceUpdate();},isIdle:function(ea){return x.get(ea)==j.IDLE;},getOnlineIDs:function(){return r.getOnlineIDs();},getAvailableIDs:function(){return r.getAvailableIDs();},getOnlineCount:function(){return r.getOnlineCount();},getDebugInfo:function(ea){var fa=r.getDebugInfo(ea),ga=s.getNow(ea);if(ga)fa.name=ga.name;return fa;}});da.start();g.subscribe(o.DUMP_EVENT,ca);g.subscribe(l.getArbiterType('favorite_list'),function(ea,fa){var ga=fa.obj,ha=ga.value?ga.value.split(','):[];n.init(ha);y();});q.subscribe(['privacy-changed','privacy-availability-changed','privacy-user-presence-response'],y);k.subscribe([k.CONNECTED,k.RECONNECTING,k.SHUTDOWN,k.MUTE_WARNING,k.UNMUTE_WARNING],y);g.subscribe(l.getArbiterType('buddylist_overlay'),function(ea,fa){var ga=fa.obj.overlay;for(var ha in ga)x.set(ha,ga[ha].a,ga[ha].s||'channel');});g.subscribe([l.getArbiterType('typ'),l.getArbiterType('ttyp')],function(ea,fa){var ga=fa.obj;if(ga.st===t.TYPING){var ha=ga.from;x.set(ha,j.ACTIVE,'channel-typing');}});a.AvailableList=e.exports=x;});
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('LegacyContextualDialog'),k=b('DOM'),l=b('LayerDestroyOnHide'),m=b('LayerHideOnTransition'),n=b('PresencePrivacy'),o=b('copyProperties'),p=b('BlackbirdUpsellConfig'),q=b('BlackbirdUpsellConstants'),r=b('BlackbirdUpsellTemplates'),s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.curry(la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;});
__d("ChatTypeaheadConstants",[],function(a,b,c,d,e,f){var g={USER_TYPE:'user',THREAD_TYPE:'thread',FRIEND_TYPE:'friend',NON_FRIEND_TYPE:'non_friend',FB4C_TYPE:'fb4c',HEADER_TYPE:'header'};e.exports=g;});
__d("Chat",["Arbiter","ChatTypeaheadConstants","MercuryParticipantTypes"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatTypeaheadConstants'),i=b('MercuryParticipantTypes');function j(o,p){d(['ChatImpressionLogger','PresenceStatus'],function(q,r){var s=p&&p.source;if(s&&s==='ordered_list'||s==='more_online_friends'||s==='online_friends'||s==='recent_threads_in_divebar_new'||s==='recent_threads_in_divebar'||s==='presence'||s==='typeahead'){p.viewport_width=document.body.clientWidth;p.target=o;p.target_presence=r.get(o);q.logImpressions(p);}});}var k={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function l(o,p){g.subscribe(k[o],function(event,q){p(q);});}function m(){return (Math.random()*2147483648|0).toString(16);}var n={openTab:function(o,p,q){if(window.External&&window.External.Chat&&window.External.Chat.openWindow)window.External.Chat.openWindow(o);j.curry(o,q).defer();d(['MercuryThreads'],function(r){if(!p||p===i.FRIEND||p===h.FRIEND_TYPE||p===h.USER_TYPE){var s=r.get().getCanonicalThreadToUser(o),t=m();g.inform('chat/open-tab',{thread_id:s.thread_id,signature_id:t});return;}if(p===h.THREAD_TYPE)d(['ChatOpenTab'],function(u){if(o){u.openThread(o);}else u.openEmptyTab();});});},openBuddyList:function(){l('buddyListNub',function(o){o.show();l('sidebar',function(p){p.enable();});});},closeBuddyList:function(){l('buddyListNub',function(o){o.hide();});},toggleSidebar:function(){l('sidebar',function(o){o.toggle();});},goOnline:function(o){d(['ChatVisibility'],function(p){p.goOnline(o);});},isOnline:function(){var o=null;d(['ChatVisibility'],function(p){o=p;});return o&&o.isOnline();}};a.Chat=e.exports=n;},3);
__d("ChatGroupThreadsController",["ArbiterMixin","ChatConfig","InitialMultichatList","MercuryOrderedThreadlist","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","MessagingTag","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('ChatConfig'),i=b('InitialMultichatList'),j=b('MercuryOrderedThreadlist').get(),k=b('MercuryServerRequests').get(),l=b('MercuryThreadInformer').get(),m=b('MercuryThreads').get(),n=b('MessagingTag'),o=b('copyProperties'),p,q=[],r=h.get('max_sidebar_multichats',3);function s(x){var y=m.getThreadMetaNow(x);return y&&!y.is_canonical&&m.canReply(x);}var t=i.payload;if(t){k.handleUpdate(t);var u=t.threads||[];q=u.map(function(x){return x.thread_id;});}if(q.length){var v=m.getThreadMetaNow(q[q.length-1]);p=v&&(v.timestamp-1);}if(!p)p=Date.now();var w={};o(w,g,{getThreadIDs:function(){var x=0;return q.filter(function(y){return x<r&&s(y)&&++x;});}});l.subscribe('threadlist-updated',function(){q=j.getThreadlistUntilTimestamp(p,n.INBOX,n.GROUPS).filter(s);w.inform('update');});e.exports=w;});
__d("ChatImpressionLogger",["AvailableList","AsyncSignal","ChatConfig","ChatVisibility","Poller"],function(a,b,c,d,e,f){var g=b('AvailableList'),h=b('AsyncSignal'),i=b('ChatConfig'),j=b('ChatVisibility'),k=b('Poller'),l=null,m=null,n={init:function(o){l=o;var p=i.get('chat_impression_logging_periodical',0);if(p){var q=i.get('periodical_impression_logging_config.interval');m=new k({interval:q,setupRequest:this.logImps.bind(this),clearOnQuicklingEvents:false});}this.init=function(){};},logImps:function(o){if(!j.isOnline())return;var p={source:'periodical_imps'},q=l.getCachedSortedList(),r=[];for(var s=0;s<q.length;s++)r[s]=g.get(q[s]);p.sorted_list=q.toString();p.list_availability=r.toString();o.setURI('/ajax/chat/imps_logging.php').setData(p);},getOrderedList:function(){return l;},logImpressions:function(o){var p=[],q=[];if(i.get('chat_impression_logging_with_click')){p=l.getCachedSortedList();for(var r=0;r<p.length;r++)q[r]=g.get(p[r]);}o.sorted_list=p.toString();o.list_availability=q.toString();new h('/ajax/chat/ct.php',o).send();}};e.exports=n;});
__d("ChatOptions",["Arbiter","ChannelConstants","JSLogger","PresenceUtil","copyProperties","ChatOptionsInitialData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('JSLogger'),j=b('PresenceUtil'),k=b('copyProperties'),l=i.create('chat_options'),m={};(function(){var o=b('ChatOptionsInitialData');for(var p in o){var q=o[p];m[p]=!!q;}})();var n=k(new g(),{getSetting:function(o){return m[o];},setSetting:function(o,p,q){if(this.getSetting(o)==p)return;if(q){q='from_'+q;l.log(q,{name:o,new_value:p,old_value:this.getSetting(o)});}m[o]=!!p;g.inform('chat/option-changed',{name:o,value:p});}});g.subscribe(h.getArbiterType('setting'),function(o,p){var q=p.obj;if(q.window_id===j.getSessionID())return;n.setSetting(q.setting,!!q.value,'channel');});g.subscribe(i.DUMP_EVENT,function(o,p){p.chat_options=m;});e.exports=n;});
__d("ChatOrderedListHover",["function-extensions","ArbiterMixin","ChatFavoriteList","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","copyProperties","cx","mixin","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f){b('function-extensions');var g=b('ArbiterMixin'),h=b('ChatFavoriteList'),i=b('CSS'),j=b('ErrorUtils'),k=b('Event'),l=b('LayerHideOnBlur'),m=b('Parent'),n=b('copyProperties'),o=b('cx'),p=b('mixin'),q=b('setTimeoutAcrossTransitions'),r=b('shield');function s(y){i.addClass(y,'fetching');}function t(y){i.removeClass(y,'fetching');}var u=p(g);for(var v in u)if(u.hasOwnProperty(v))x[v]=u[v];var w=u===null?null:u.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=u;function x(y){"use strict";this._orderedList=y;this._root=y.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));y.subscribe('click',r(this._hide,this));}x.prototype._mouseOver=function(event){"use strict";if(this._paused)return;var y=event.getTarget(),z=m.byClass(y,"_42fz")||m.byClass(y,"_5a58");z&&this._setActiveItem(z);};x.prototype._mouseLeave=function(event){"use strict";this._setActiveItem(null);};x.prototype._clearTimeouts=function(){"use strict";this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};x.prototype._hide=function(){"use strict";if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};x.prototype._show=function(){"use strict";var y=this.getActiveID(),z=false;if(this._handlers[y]){z=true;j.applyWithGuard(this._handlers[y],{},[y,this]);}else if(this._defaultHandler){z=true;j.applyWithGuard(this._defaultHandler,{},[y,this]);}if(z&&this._showingID!=this.getActiveID())s(this._activeItem);};x.prototype._setActiveItem=function(y){"use strict";if(h.isEditMode()){this._clearTimeouts();this._hide();return;}if(y!=this._activeItem){this._clearTimeouts();this._activeItem&&t(this._activeItem);this._activeItem=null;var z=y?0:100;this._hideTimeout=q(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),z);if(y){this._activeItem=y;var aa=z+500;this._showTimeout=q(function(){this._show();}.bind(this),aa);this.inform('hover');}else this.inform('leave');}};x.prototype.register=function(y,z){"use strict";if(!this._handlers[y]){this._handlers[y]=z;return {unregister:function(){if(y==this._showingID)this._hide();delete this._handlers[y];var aa=this._orderedList.getAllNodes(),ba=aa[y];ba&&t(ba);}.bind(this)};}};x.prototype.registerDefault=function(y){"use strict";this._defaultHandler=y;};x.prototype.getActiveID=function(){"use strict";var y=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return y||null;};x.prototype.showHovercard=function(y,z){"use strict";if(y==this.getActiveID()&&y!=this._showingID){this._clearTimeouts();t(this._activeItem);this._hide();this._showingDialog=z;this._showingID=y;var aa=z.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),ba=z.subscribe('mouseleave',function(){aa.unsubscribe();this._setActiveItem(null);}.bind(this)),ca=z.subscribe('hide',function(){this.inform('hovercard_hide');aa.unsubscribe();ba.unsubscribe();ca.unsubscribe();}.bind(this));z.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};x.prototype.setPaused=function(y){"use strict";this._paused=y;};n(x.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_handlers:{},_defaultHandler:null});e.exports=x;});
__d("ChatQuietLinks",["Event","DOM","UserAgent","DataStore","Parent"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('UserAgent'),j=b('DataStore'),k=b('Parent'),l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);},removeMessagesHrefs:function(q){o(q,function(r){return !r||r==='#'||r.indexOf('/messages/')!=-1;});}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;});
__d("ChatSidebarConstants",[],function(a,b,c,d,e,f){var g={LITESTAND_IMAGE_SIZE:24,LITESTAND_BLENDED_SIZE:32,LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:28};e.exports=g;});
__d("ChatSidebarItem.react",["AvailableListConstants","ChatConfig","ChatFavoriteList","ChatSidebarConstants","Image.react","Link.react","React","SplitImage.react","cx","ix"],function(a,b,c,d,e,f){var g=b('AvailableListConstants'),h=b('ChatConfig'),i=b('ChatFavoriteList'),j=b('ChatSidebarConstants'),k=b('Image.react'),l=b('Link.react'),m=b('React'),n=b('SplitImage.react'),o=b('cx'),p=b('ix'),q=9,r=m.createClass({displayName:'ChatSidebarItem',render:function(){var s=(("_55ln")+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount&&h.get('litestand_buddylist_count')?' '+"_5bom":'')),t;if(this.props.litestandSidebar)t=m.DOM.div({'aria-label':this.props.name,className:"_4_vf",'data-hover':"tooltip",'data-tooltip-position':"right"});return (l({className:s,href:this.props.href,onClick:this.props.onClick,rel:"ignore"},m.DOM.div({className:"_55lp"},this.renderFavorite(),m.DOM.div({className:"_56p9"},this.renderImage(),m.DOM.div({className:"_568w"})),m.DOM.div({className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),m.DOM.div({className:"_55lr"},this.props.name),m.DOM.div({className:"_55ls"},this.props.context)),t));},renderFavorite:function(){if(this.props.isAdded===undefined)return null;var s=null;if(this.props.litestandSidebar){s=this.props.isAdded?p('/images/litestand/bookmarks/sidebar/remove.png'):p('/images/litestand/bookmarks/sidebar/add.png');}else s=this.props.isAdded?p('/images/chat/delete.png'):p('/images/chat/add.png');var t=(("_568x")+(!this.props.showEditButton?' '+"hidden_elem":''));return (m.DOM.div({className:t,onClick:this.props.onEditClick},k({className:"_568y",src:s})));},renderImage:function(){var s=this.props.imageSize||j.IMAGE_SIZE;return n({size:s,srcs:this.props.images});},renderUnreadCount:function(){var s=this.props.unreadCount;if(!s||!h.get('litestand_buddylist_count'))return null;var t=(("_5boo")+(s>q?' '+"_5bop":''));if(s>q)s=q+'+';return (m.DOM.div({className:t},s));},renderStatus:function(){var s=this.getStatusSrc();if(!s)return null;if(this.props.unreadCount&&h.get('litestand_blended_sidebar')&&h.get('litestand_buddylist_count'))return;var t=h.get('divebar_favorite_list',0)&&i.isEditMode();if(t)return;return (m.DOM.div({className:"_568z"},m.DOM.div({className:"_568-"},this.props.statusTime),m.DOM.div({className:"_5t35"},this.props.detailedStatus),k({className:"_568_",src:s})));},renderBirthday:function(){if(!this.props.birthday)return null;var s=p('/images/gifts/icons/cake_icon.png');if(h.get('gray_cake'))s=p('/images/chat/sidebar/livebar/divebar_cake.png');return (k({className:"_5dv3",src:s}));},getStatusSrc:function(){switch(this.props.status){case g.ACTIVE:case g.IDLE:if(this.props.litestandSidebar)return h.get('litestand_blended_sidebar')?p('/images/litestand/sidebar/blended/online.png'):p('/images/litestand/sidebar/online.png');return h.get('litestand_classic_sidebar')?p('/images/litestand_classic/sidebar/online.png'):p('/images/chat/status/online.png');case g.MOBILE:if(this.props.litestandSidebar)return h.get('litestand_blended_sidebar')?p('/images/litestand/sidebar/blended/pushable.png'):p('/images/litestand/sidebar/pushable.png');return h.get('litestand_classic_sidebar')?p('/images/litestand_classic/sidebar/pushable.png'):p('/images/chat/status/mobile.png');}return null;}});e.exports=r;});
__d("ChatSidebarThread.react",["ChatSidebarItem.react","WebMessengerPermalinkConstants","React","MercuryThreadMetadataRawRenderer"],function(a,b,c,d,e,f){var g=b('ChatSidebarItem.react'),h=b('WebMessengerPermalinkConstants'),i=b('React'),j=b('MercuryThreadMetadataRawRenderer'),k=i.createClass({displayName:'ChatSidebarThread',render:function(){var n=this.props.name,o=l(this.props.threadID,this.props.participants),p=n?o:undefined,q=h.getURIPathForThreadID(this.props.threadID),r=m(this.props.image,this.props.participants),s=n?n:o;return (g({context:p,href:{url:q},imageSize:this.props.imageSize,images:r,litestandSidebar:this.props.litestandSidebar,name:s,status:this.props.status,unreadCount:this.props.unreadCount}));}});function l(n,o){return j.renderRawParticipantList(n,o,o.length,{names_renderer:j.renderShortNames});}function m(n,o){if(n)return n;return o.map(function(p){return p.image_src;});}e.exports=k;});
__d("ChatSidebarThreadlist.react",["ChatConfig","ChatGroupThreadsController","ChatSidebarConstants","ChatSidebarItem.react","ChatSidebarThread.react","MercuryServerRequests","MercuryThreads","MercuryParticipants","PresenceStatus","React","copyProperties","cx","fbt","ix"],function(a,b,c,d,e,f){var g=b('ChatConfig'),h=b('ChatGroupThreadsController'),i=b('ChatSidebarConstants'),j=b('ChatSidebarItem.react'),k=b('ChatSidebarThread.react'),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get(),n=b('MercuryParticipants'),o=b('PresenceStatus'),p=b('React'),q=b('copyProperties'),r=b('cx'),s=b('fbt'),t=b('ix'),u=p.createClass({displayName:'ChatSidebarThreadlist',render:function(){var v=this.state.threadData,w=this.state.participantData,x=g.get('litestand_classic_sidebar')?i.LITESTAND_CLASSIC_SIZE:i.IMAGE_SIZE,y=g.get('litestand_classic_sidebar')?t('/images/litestand/sidebar/blended/new_group_chat.png'):t('/images/chat/sidebar/newGroupChat.png');if(this.props.litestandSidebar){x=g.get('litestand_blended_sidebar')?i.LITESTAND_BLENDED_SIZE:i.LITESTAND_IMAGE_SIZE;y=g.get('litestand_blended_sidebar')?t('/images/litestand/sidebar/blended/new_group_chat.png'):t('/images/chat/sidebar/newGroupChatLitestand.png');}var z="New Group Chat...";z=g.get('divebar_group_new_button_name',z);var aa=[];aa.push(p.DOM.li({className:(("_56yg")+(' '+"_56yj")+(this.props.offlineItems?' '+"_570-":'')),key:"new"},j({images:y,imageSize:x,litestandSidebar:this.props.litestandSidebar,name:z})));var ba={};for(var ca in v){var da=v[ca],ea=da.participants.map(function(ia){return (w||{})[ia];}).filter(function(ia){return ia;}),fa=da.participants.map(function(ia){return n.getUserID(ia);}),ga=fa.sort().join('|');if(!ba[ga]&&ea.length){ba[ga]=1;var ha=l.getServerThreadIDNow(ca);aa.push(p.DOM.li({className:(("_5a58")+(' '+"_56yg")+(this.props.offlineItems?' '+"_570-":'')),'data-serverthreadid':ha,'data-threadid':ca,key:ca},k({image:da.image_src,imageSize:x,litestandSidebar:this.props.litestandSidebar,name:da.name,participants:ea,status:o.getGroup(fa),threadID:ca,unreadCount:da.unread_count})));}}return p.DOM.ul(null,aa);},getInitialState:function(){return {};},componentWillMount:function(){var v=function(){this.setState(this._calculateState());}.bind(this);this.token=h.subscribe('update',v);v();},componentWillUnmount:function(){this.token&&this.token.unsubscribe();this.token=null;},_calculateState:function(){var v=false,w={},x={},y=h.getThreadIDs(),z=y.length;y.forEach(function(ba){m.getThreadMeta(ba,function(ca){x[ba]=ca;n.getMulti(ca.participants,function(da){delete da[n.user];if(v){this.setState(this._calculateState());}else q(w,da);z--;}.bind(this));}.bind(this));}.bind(this));if(z===0){return {threadData:x,participantData:w};}else{v=true;var aa=this.state||{};return {threadData:q(aa.threadData,x),participantData:q(aa.participantData,w)};}}});e.exports=u;});
__d("ChatUnreadCount",["ArbiterMixin","MercuryThreadInformer","MercuryThreads","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('MercuryThreadInformer').get(),i=b('MercuryThreads').get(),j=b('copyProperties'),k={};h.subscribe('threads-updated',function(l,m){for(var n in m){var o=i.getCanonicalUserInThread(n);k.inform('unread-changed',o);}});j(k,g,{getUnreadCountForUID:function(l,m){i.getThreadMeta(i.getThreadIdForUser(l),function(n){m(n.unread_count);});}});e.exports=k;});
__d("OrderedFriendsList",["AvailableList","ChatConfig","createArrayFrom","ShortProfiles","InitialChatFriendsList"],function(a,b,c,d,e,f){var g=b('AvailableList'),h=b('ChatConfig'),i=b('createArrayFrom'),j=b('ShortProfiles'),k=[],l={},m=[],n={contains:function(o){return o in l;},compare:function(o,p){var q=n.getRank(o),r=n.getRank(p);if(q!==r)return q-r;var s=j.getNowUnsafe(o),t=j.getNowUnsafe(p),u=((s||{}).name||'~').toLowerCase(),v=((t||{}).name||'~').toLowerCase();if(u!==v)return u<v?-1:1;return 0;},getList:function(){if(h.get('chat_web_ranking_with_presence'))n.reRank();var o=i(k);o=o.filter(function(p){var q=j.getNowUnsafe(p);return !q||q.type=="friend";});return o;},getRank:function(o){return o in l?l[o]:k.length;},reRank:function(){var o={},p={};m.forEach(function(r,s){var t=r.substr(0,r.length-2),u=r.substring(r.length-1);if(typeof(p.uid)=='undefined'){if(typeof(o.uid)=='undefined')o[t]=g.get(t);var v=o[t];if(v==u)p[s]=t;}});k=[];for(var q in p)k.push(p[q]);k.forEach(function(r,s){l[r]=s;});}};(function(){var o=b('InitialChatFriendsList');k=o.list.length?o.list:[];if(h.get('chat_web_ranking_with_presence')){m=k.slice();n.reRank();}k.forEach(function(p,q){l[p]=q;});})();e.exports=a.OrderedFriendsList||n;});
__d("ChatOrderedList",["Animation","Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AvailableList","AvailableListConstants","Bootloader","Chat","ChatConfig","ChatContexts","ChatFavoriteList","ChatGroupThreadsController","ChatOrderedListHover","ChatQuietLinks","ChatSidebarThreadlist.react","ChatTypeaheadConstants","ChatUnreadCount","ChatVisibility","CSS","DataStore","DOM","Ease","Event","ImageSourceRequest","ImageSourceType","JSLogger","JSXDOM","LastMobileActiveTimes","MercuryParticipantTypes","OrderedFriendsList","Parent","PhotoResizeModeConst","PresencePrivacy","PresenceStatus","React","Rect","ShortProfiles","Style","TokenizeUtil","Tooltip","URI","Vector","XHPTemplate","copyProperties","createObjectFrom","csx","cx","debounceAcrossTransitions","guid","ix","requestAnimationFrame","runAfterScrollingStops","shield","throttle","tx","mixin","ChannelImplementation"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('AsyncDialog'),k=b('AsyncRequest'),l=b('AvailableList'),m=b('AvailableListConstants'),n=b('Bootloader'),o=b('Chat'),p=b('ChatConfig'),q=b('ChatContexts'),r=b('ChatFavoriteList'),s=b('ChatGroupThreadsController'),t=b('ChatOrderedListHover'),u=b('ChatQuietLinks'),v=b('ChatSidebarThreadlist.react'),w=b('ChatTypeaheadConstants'),x=b('ChatUnreadCount'),y=b('ChatVisibility'),z=b('CSS'),aa=b('DataStore'),ba=b('DOM'),ca=b('Ease'),da=b('Event'),ea=b('ImageSourceRequest'),fa=b('ImageSourceType'),ga=b('JSLogger'),ha=b('JSXDOM'),ia=b('LastMobileActiveTimes'),ja=b('MercuryParticipantTypes'),ka=b('OrderedFriendsList'),la=b('Parent'),ma=b('PhotoResizeModeConst'),na=b('PresencePrivacy'),oa=b('PresenceStatus'),pa=b('React'),qa=b('Rect'),ra=b('ShortProfiles'),sa=b('Style'),ta=b('TokenizeUtil'),ua=b('Tooltip'),va=b('URI'),wa=b('Vector'),xa=b('XHPTemplate'),ya=b('copyProperties'),za=b('createObjectFrom'),ab=b('csx'),bb=b('cx'),cb=b('debounceAcrossTransitions'),db=b('guid'),eb=b('ix'),fb=b('requestAnimationFrame'),gb=b('runAfterScrollingStops'),hb=b('shield'),ib=b('throttle'),jb=b('tx'),kb=b("mixin"),lb=b('ChannelImplementation').instance,mb=p.get('chat_ranked_by_coefficient',0),nb=null,ob,pb,qb=9,rb=kb(i);for(var sb in rb)if(rb.hasOwnProperty(sb))ub[sb]=rb[sb];var tb=rb===null?null:rb.prototype;ub.prototype=Object.create(tb);ub.prototype.constructor=ub;ub.__superConstructor__=rb;function ub(bc,cc,dc,ec,fc,gc){"use strict";this._isSidebar=bc;this._isLitestand=p.get('litestand',0)||p.get('test_litestand_sidebar',0);this._isLitestandSidebar=this._isSidebar&&this._isLitestand;this._isLeftCollapsedSidebar=!!la.byClass(cc,"_5ap0");this._root=cc;this._itemsMap={};this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._hasRendered=false;this._preventRendering=false;this._hoverController=null;this._template=dc;this._messageTemplate=ec;this._favoriteMode=p.get('divebar_favorite_list',0);this._contextualDialog=fc;this._cachedItemHeight=null;this._cachedItemPadding=null;if(gc&&ba.scry(gc,"._54y_").length){z.show(gc);this._pymk=gc;}this._usePlaceholder=this._isLitestand&&this._isSidebar;if(p.get('groups_in_divebar')){this._groupThreadsNode=ha.li({className:"_56yf"});this._updateGroupThreads();this._groupsList=this._favoriteMode&&ba.find(this._root,"._56yh");}if(this._favoriteMode){this._favoriteSidebar=ba.find(this._root,"._42g5");this._editButton=ba.scry(this._root,"._57m9 ._54sl")[0];this._favoriteList=ba.find(this._root,"._54sm");this._activeNowList=ba.find(this._root,"._54sn");this._activeNowLabel=ba.scry(this._root,"._42g9")[0];if(this._activeNowLabel)this._activeNowArea=la.byClass(this._activeNowLabel,"_57yh");}this._orderedList=ba.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=la.byClass(this._root,'scrollableOrderedList');this._chatSidebar=la.byClass(this._root,'fbChatSidebar');this._scrollableArea=la.byClass(this._root,'scrollable');da.listen(this._root,'click',this._onClick.bind(this));da.listen(this._root,'mouseenter',this._mouseEnter.bind(this));da.listen(this._root,'mouseleave',this._mouseLeave.bind(this));if(this._editButton){da.listen(this._editButton,'click',this.toggleEditMode.bind(this));h.subscribe(['LitestandSidebarBookmarks/close','LitestandSidebar/collapse'],this._onEditEnd.bind(this));}h.subscribe(['LitestandSidebar/collapse','LitestandSidebar/expand'],function(event){if(this._isLitestandSidebar)this.getHoverController().setPaused(event==='LitestandSidebar/collapse');this.render();}.bind(this));l.subscribe(m.ON_AVAILABILITY_CHANGED,hb(this.update,this));na.subscribe('privacy-changed',hb(this.update,this));lb.subscribe([lb.CONNECTED,lb.RECONNECTING,lb.SHUTDOWN,lb.MUTE_WARNING,lb.UNMUTE_WARNING],hb(this.update,this));this.inform('initialized',this,h.BEHAVIOR_PERSISTENT);this.render();h.subscribe(ga.DUMP_EVENT,function(hc,ic){ic.chat_lists=ic.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:ka.getList(),available_list:ub.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}.bind(this));h.subscribe('ChatOrderedList/itemHeightChange',function(){this._cachedItemHeight=null;this._cachedItemPadding=null;}.bind(this));this._renderUnreadCount=p.get('divebar_message_count');if(this._renderUnreadCount)x.subscribe('unread-changed',function(hc,ic){if(!this._renderedTopUsers||!(ic in this._renderedTopUsers)||!this._itemsMap[ic])return;x.getUnreadCountForUID(ic,this._updateUnreadCount.bind(this,ic));}.bind(this));}ub.prototype.getAllNodes=function(){"use strict";var bc={},cc=ba.scry(this._root,"li._42fz");for(var dc=0;dc<cc.length;dc++){var ec=aa.get(cc[dc],'id');if(ec)bc[ec]=cc[dc];}return bc;};ub.prototype.getShowingUsers=function(){"use strict";return ba.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};ub.prototype.getUserForNode=function(bc){"use strict";return aa.get(bc,'id')||aa.get(bc,'serverthreadid');};ub.prototype.getHoverController=function(){"use strict";if(!this._hoverController){this._hoverController=new t(this,this._contextualDialog);if(this._isLitestandSidebar&&this._isLitestandSidebarCollapsed())this._hoverController.setPaused(true);}return this._hoverController;};ub.prototype._isLitestandSidebarCollapsed=function(){"use strict";if(this._isLeftCollapsedSidebar)return true;if(ob)return !ob.isExpanded();n.loadModules(['LitestandSidebar'],function(bc){ob=bc;});return z.hasClass(document.documentElement,"_4kdq");};ub.prototype.getPaddingOffset=function(){"use strict";return this._favoriteMode?24:8;};ub.prototype._calculateItemMeasurements=function(){"use strict";var bc=this._orderedList,cc=this._template.build(),dc=cc.getRoot();ba.setContent(cc.getNode('name'),'test');if(this._favoriteSidebar){bc=this._favoriteList;z.addClass(this._favoriteSidebar,"_4zmr");}dc.style.visibility='hidden';ba.appendContent(bc,dc);this._cachedItemHeight=wa.getElementDimensions(dc).y;this._cachedItemPadding=sa.getFloat(cc.getNode('anchor'),'padding')||0;ba.remove(dc);if(this._favoriteSidebar)z.removeClass(this._favoriteSidebar,"_4zmr");};ub.prototype.getItemHeight=function(){"use strict";if(this._cachedItemHeight===null)this._calculateItemMeasurements();return this._cachedItemHeight;};ub.prototype.getItemPadding=function(){"use strict";if(this._cachedItemPadding===null)this._calculateItemMeasurements();return this._cachedItemPadding;};ub.prototype._updateGroupThreads=function(){"use strict";if(this._groupThreadsNode){var bc=na.getVisibility(),cc=v({offlineItems:lb.disconnected()||!bc,litestandSidebar:this._isSidebar&&this._isLitestand&&!p.get('test_old_divebar')});pa.renderComponent(cc,this._groupThreadsNode);}};ub.prototype._placeholderUpdate=function(){"use strict";if(!this._usePlaceholder||!this._scrollContainer)return;var bc=this._root.offsetTop-this._scrollContainer.scrollTop;this._scrollContainerHeight=this._scrollContainerHeight||this._scrollContainer.offsetHeight;var cc=this.getItemHeight(),dc=Math.ceil(this._scrollContainerHeight/cc),ec=bc<0?Math.max(Math.floor(-bc/cc)-dc,0):0,fc=ec+dc+dc;this._cachedItems=this._cachedItems||ba.scry(this._root,"li._42fz");for(var gc=0,hc=this._cachedItems.length;gc<hc;gc++)z.conditionClass(this._cachedItems[gc],"_50zv",gc<ec||gc>fc);};ub.prototype._getListItem=function(bc,cc){"use strict";var dc=this._itemsMap[bc];if(!dc)return;var ec=oa.get(bc),fc=oa.isBirthday(bc),gc=na.allows(bc)&&!lb.disconnected();if(dc.buttonNode===undefined){dc.buttonNode=ba.scry(dc.node,"._54sk")[0];dc.contextNode=ba.find(dc.node,"._52zk");dc.timeNode=ba.scry(dc.node,'.active_time')[0];dc.statusNodes=ba.scry(dc.node,'img.status');dc.detailedPresenceNode=ba.scry(dc.node,"._5t30")[0];}z.conditionClass(dc.node,"_42f-",cc);z.conditionClass(dc.node,"_54sj",cc);z.conditionClass(dc.node,"_52s3",this._isLitestand&&cc);if(dc.buttonNode)if(!this._isLitestand){z.conditionClass(dc.buttonNode,"_42f_",cc);z.conditionClass(dc.buttonNode,"_42g0",!cc);}var hc={active:false,mobile:false,birthday:false};hc.active=ec===m.ACTIVE;hc.mobile=ec===m.MOBILE;hc.birthday=fc;if(hc.mobile){var ic=ia.getShortDisplay(bc);if(dc.timeNode&&dc.lastActiveTime!==ic){dc.lastActiveTime=ic;ba.setContent(dc.timeNode,ic);}}else if(dc.lastActiveTime){dc.lastActiveTime=null;ba.empty(dc.timeNode);}if(hc.active){var jc=oa.getDetailedActivePresence(bc);if(dc.detailedPresenceNode&&jc){ba.setContent(dc.detailedPresenceNode,jc);ba.empty(dc.timeNode);}}else if(dc.detailedPresenceNode)ba.empty(dc.detailedPresenceNode);for(var kc in hc)z.conditionClass(dc.node,kc,hc[kc]&&gc);z.conditionClass(dc.node,'invis',!gc);var lc=z.hasClass(document.documentElement,'highContrast');dc.statusNodes.forEach(function(mc){if(ec===m.ACTIVE&&gc){mc.alt="Online";if(lc)mc.src=eb('/images/chat/status/online.png');}else if(ec===m.MOBILE&&gc){mc.alt="Mobile";if(lc)mc.src=eb('/images/chat/status/mobile.png');}else{mc.alt='';if(lc)mc.src=eb('/images/spacer.gif');}});this._applyContext(bc,dc);return dc.node;};ub.prototype.getRoot=function(){"use strict";return this._root;};ub.prototype.getSortedList=function(bc){"use strict";return ub.getSortedList(bc||this._excludedIds,this._numTopFriends);};ub.prototype.getCachedSortedList=function(bc){"use strict";if(nb==null)nb=this.getSortedList(bc);return nb;};ub.prototype.toggleFavoriteSidebar=function(bc,cc){"use strict";function dc(gc,hc){z.conditionShow(hc,gc);var ic=la.byClass(hc,'uiContextualLayerPositioner');ic&&z.conditionShow(ic,gc);}z.conditionShow(this._orderedList,!bc);if(this._favoriteSidebar)z.conditionShow(this._favoriteSidebar,bc);var ec=ba.scry(this._scrollableOrderedList||this._root,"._42i3");ec.forEach(dc.curry(bc));var fc=ba.scry(this._scrollableOrderedList||this._root,"._56yi");fc.length&&dc(cc,fc[0]);};ub.prototype.hide=function(){"use strict";if(!this._isVisible)return;this._isVisible=false;z.hide(this._scrollableOrderedList||this._root);this.inform('hide');};ub.prototype._onFavoriteOrderChange=function(){"use strict";var bc=this.sortableGroup.getOrder();r.updateList(bc);r.save();};ub.prototype._getFavoriteItems=function(){"use strict";var bc=[],cc=r.get();for(var dc=0;dc<cc.length;dc++){var ec=this._itemsMap[cc[dc]];if(ec)bc.push(ec.node);}return bc;};ub.prototype._getChatTabOpenLogData=function(bc){"use strict";var cc=z.hasClass(document.documentElement,'sidebarMode'),dc={mode:cc?'sidebar':'chatNub',typehead:false};if(this._scrollableArea&&this._scrollContainer){var ec=wa.getElementPosition(this._scrollableArea,'viewport').y,fc=wa.getElementPosition(bc,'viewport').y,gc=this._scrollContainer.scrollTop;if(fc>ec){dc.visible_slot=Math.round((fc-ec)/32);var hc=Math.round(gc/32);dc.global_slot=dc.visible_slot+hc;}}if(cc){dc.sidebar_height=this._chatSidebar&&this._chatSidebar.clientHeight;if(this._scrollContainer)dc.buddylist_height=this._scrollContainer.clientHeight;}return dc;};ub.prototype._resetFavoriteBounds=function(){"use strict";var bc=r.get(),cc=bc.length;if(cc){var dc=bc[0],ec=bc[cc-1],fc=this._itemsMap[dc],gc=this._itemsMap[ec],hc=new qa(wa.getElementPosition(fc.node).y,0,wa.getElementPosition(gc.node).y+wa.getElementDimensions(gc.node).y,0);this.sortableGroup.setBoundingBox(hc);}};ub.prototype._createSortableGroup=function(){"use strict";if(this.sortableGroup)this.sortableGroup.destroy();n.loadModules(['SortableGroup'],function(bc){this.sortableGroup=new bc().setBeforeGrabCallback(this._resetFavoriteBounds.bind(this)).setOrderChangeHandler(this._onFavoriteOrderChange.bind(this));if(this._isLitestand)this.sortableGroup.gutter=1;var cc=this._getFavoriteItems();for(var dc=0;dc<cc.length;dc++){var ec=cc[dc];this.sortableGroup.addSortable(aa.get(ec,'id'),ec);}}.bind(this));};ub.prototype.toggleEditMode=function(){"use strict";r.toggleEditMode();if(r.isEditMode()){this._createSortableGroup();ba.setContent(this._editButton,"DONE");z.addClass(this._favoriteSidebar,"_4-d6");this.inform('editStart');}else this._onEditEnd();};ub.prototype._onEditEnd=function(){"use strict";if(r.isEditMode())r.toggleEditMode();ba.setContent(this._editButton,"EDIT");z.removeClass(this._favoriteSidebar,"_4-d6");this.inform('editEnd');};ub.prototype._onClick=function(event){"use strict";var bc=event.getTarget(),cc=la.byTag(bc,'li');if(r.isEditMode()){var dc=la.byClass(bc,"_54sk");if(dc&&cc){var ec=aa.get(cc,'id');if(ec){r.toggleID(ec);r.save();}this.update();}event.prevent();return false;}if(cc){if(z.hasClass(cc,'blackbirdWhitelist')){var fc=new va('/ajax/chat/privacy/settings_dialog.php').addQueryData({ref:'whitelist_separator'});j.send(new k(fc));event.prevent();return false;}var gc=aa.get(cc,'id'),hc=z.hasClass(cc,"_56yg");if(gc||hc){var ic=this._getChatTabOpenLogData(cc),jc=z.hasClass(document.documentElement,'sidebarMode'),kc=na.getOnlinePolicy()===na.ONLINE_TO_WHITELIST,lc=kc?'white_list':'ordered_list';if(hc){gc=cc.getAttribute('data-threadid');lc=gc?'recent_threads_in_divebar':'recent_threads_in_divebar_new';}else if(jc&&this._favoriteMode&&!kc){while(cc.parentNode){cc=cc.parentNode;if(z.hasClass(cc,"_42g8")){lc='more_online_friends';break;}if(z.hasClass(cc,"_42g7"))break;}}else while(cc.previousSibling){cc=cc.previousSibling;if(z.hasClass(cc,"_554m")){if(z.hasClass(cc,'moreOnlineFriends')){lc='more_online_friends';break;}if(z.hasClass(cc,'blackbirdWhitelist')){lc='blackbird_offline_section';break;}}}ic.source=lc;var mc=hc?w.THREAD_TYPE:ja.FRIEND;o.openTab(gc,mc,ic);this.inform('click',{id:gc});}else if(z.hasClass(cc,"_554m")&&la.byClass(bc,"_554n")){this.scrollTo(cc);}else if(z.hasClass(cc,"_55nf"))return;return false;}};ub.prototype._mouseEnter=function(){"use strict";this._preventRendering=true;};ub.prototype._mouseLeave=function(){"use strict";this._preventRendering=false;};ub.prototype.setExcludedIds=function(bc){"use strict";this._excludedIds=za(bc||[]);};ub.prototype.setNumTopFriends=function(bc){"use strict";if(bc!==this._numTopFriends){this._numTopFriends=bc;this.render();}};ub.prototype._getOfflineToSectionItems=function(){"use strict";var bc='subheader-text-'+db(),cc=ba.create('a',{href:'#','aria-describedby':bc},ba.tx._("Edit")),dc=[],ec=ba.tx._("MORE FRIENDS");dc.push(ha.li({className:"_554m"},ha.div({className:"_554o"},ha.div({className:"_554n"},ha.span({className:"_554p"},ec),ha.div({className:"_554q"},ha.span({className:"_554r"}))))));dc.push(ha.li({className:"_554m blackbirdWhitelist"},ha.div({className:"_554o"},ha.div({className:"fbChatOrderedList/separatorInner"},ha.div({className:"fbChatOrderedList/separatorSubheader"},ha.span({id:bc,className:"_554t"},jb._("These friends can't see you on chat. {=link}",{'=link':cc})))))));return dc;};ub.prototype._renderOrderedList=function(){"use strict";if(!this._isVisible||(this._preventRendering&&this._hasRendered)||pb)return;this._hasRendered=true;this._cachedItems=null;var bc=[],cc,dc,ec=false,fc=false,gc=z.hasClass(document.documentElement,'sidebarMode'),hc=na.getVisibility(),ic=na.getOnlinePolicy()===na.ONLINE_TO_WHITELIST,jc=this._isLitestandSidebar&&this._isLitestandSidebarCollapsed(),kc=p.get('groups_in_divebar');kc&&this._updateGroupThreads();var lc=kc&&s.getThreadIDs().length,mc=gc&&this._favoriteMode&&hc&&!ic;if(mc&&kc&&lc&&this._groupThreadsNode){ba.setContent(this._groupsList,this._groupThreadsNode);u.nukeLinks(this._groupThreadsNode);u.nukeLinks(this._favoriteList);this.inform('render');}var nc=mc&&this._groupThreadsNode&&this._groupsList,oc=nc&&lc,pc=this._isLitestand&&!la.byClass(this._root,"_4w59");if(nc&&(lc||pc)){ba.setContent(this._groupsList,this._groupThreadsNode);z.show(this._groupsList);u.nukeLinks(this._favoriteList);this.inform('render');}else this._groupsList&&z.hide(this._groupsList);var qc=lc||0;if(oc||!mc)qc++;var rc=[],sc,tc;if(mc){this._chatSidebar&&z.addClass(this._chatSidebar,'fbSidebarFavoriteList');rc=r.get();if(jc)rc=rc.slice(0,Math.max(0,this._numTopFriends-qc));for(sc=0,tc=rc.length;sc<tc;sc++){cc=rc[sc];dc=this._getListItem(cc,true);if(dc){bc.push(dc);}else{fc=true;this._renderListItem(cc,this.update.bind(this));}}}this.toggleFavoriteSidebar(mc,oc);var uc=jc?1:0,vc=ub.getSortedList(za(rc),Math.max(0,this._numTopFriends-rc.length-qc+uc));if(mc){if(rc.length&&vc.length){var wc=ba.create('li',{className:"_42g3"});bc.push(wc);}}else if(lc)this._groupThreadsNode&&bc.push(this._groupThreadsNode);var xc=na.getVisibility()&&na.getOnlinePolicy()==na.ONLINE_TO_WHITELIST;for(var yc=0,zc=vc.length;yc<zc;yc++){cc=vc[yc];if(xc)if(!na.allows(cc)){if(yc+2>=vc.length)break;xc=false;var ad=this._getOfflineToSectionItems();bc.push(ad[0]);bc.push(ad[1]);zc-=2;}dc=this._getListItem(cc);if(dc){bc.push(dc);}else this._renderListItem(cc,this.render.bind(this));}if(mc){ba.setContent(this._favoriteList,bc);if(bc.length)u.nukeLinks(this._favoriteList);this.inform('render');}var bd;if(jc){bd=[];}else bd=ub.getAvailableList(this._excludedIds);var cd=rc.concat(vc),dd=za(cd);bd=bd.filter(function(md){return !(md in dd);});if(this._renderUnreadCount){var ed=[];if(this._renderedTopUsers){var fd=Object.keys(this._renderedTopUsers).filter(function(md){return !(md in dd);});fd.forEach(function(md){this._updateUnreadCount(md,0);}.bind(this));cd.forEach(function(md){if(!(md in this._renderedTopUsers))ed.push(md);}.bind(this));}else ed=cd;var gd=this._updateUnreadCount.bind(this);ed.forEach(function(md){x.getUnreadCountForUID(md,function(nd){gd(md,nd);});});this._renderedTopUsers=dd;}if(p.get('divebar_show_mobile_more_friends_alphabetical')){bd.sort(zb);}else bd.sort(ac);var hd="MORE FRIENDS";if(mc){bc=[];}else if(bd.length&&bc.length){var id;if(this._isLitestand){id=ha.span(null,ha.span({className:"_554u"},hd," · ",bd.length),ha.span({className:"_554v"}," +",bd.length));}else id=jb._("{MORE ONLINE FRIENDS} ({=count})",{'MORE ONLINE FRIENDS':hd,'=count':bd.length});if(this._pymk){ec=true;bc.push(this._pymk);}bc.push(ha.li({className:"_554m moreOnlineFriends"},ha.div({className:"_554o"},ha.div({className:"_554n"},ha.span({className:"_554p"},id),ha.div({className:"_554q"},ha.span({className:"_554r"}))))));}for(sc=0,tc=bd.length;sc<tc;sc++){cc=bd[sc];dc=this._getListItem(cc);if(dc){bc.push(dc);}else this._renderListItem(cc,this.render.bind(this));}if(!vc.length&&!bd.length&&!qc){var jd=this._messageTemplate.render(),kd=xa.getNode(jd,'message');ba.setContent(kd,"No one is available to chat.");bc.push(jd);}if(bc.length){if(mc){z.show(this._activeNowList);if(this._activeNowLabel){var ld;z.show(this._activeNowArea);if(this._isLitestand){ld=ha.span(null,ha.span({className:"_554u"},hd," · ",bd.length),ha.span({className:"_554v"}," +",bd.length));}else ld=jb._("{MORE ONLINE FRIENDS} ({=count})",{'MORE ONLINE FRIENDS':"ACTIVE NOW",'=count':bd.length});ba.setContent(this._activeNowLabel,ld);}ba.setContent(this._activeNowList,bc);u.nukeLinks(this._activeNowList);}else{if(this._pymk&&!ec)bc.push(this._pymk);ba.setContent(this._orderedList,bc);if(this._pymk){u.removeMessagesHrefs(this.getRoot());}else u.nukeLinks(this.getRoot());}this.inform('render');this._placeholderUpdate();if(!this._renderingAfterScroll){this._renderingAfterScroll=true;this.render=cb(gb.curry(this._renderOrderedList.bind(this),'ChatOrderedList/render',true),300);}}else if(mc){z.hide(this._activeNowList);if(this._activeNowArea)z.hide(this._activeNowArea);}if(mc&&!fc)if(r.isEditMode()&&r.hasChanged())this._createSortableGroup();};ub.prototype.render=function(){"use strict";this.render=cb(this._renderOrderedList.bind(this),300);this.render();};ub.prototype._renderListItem=function(bc,cc){"use strict";ra.get(bc,function(dc){var ec=this._template.render(),fc=xa.getNode(ec,'profile-photo');if(p.get('chat_use_client_side_image_requests',0)){var gc=this._isLitestand?24:28;new ea().setFBID(dc.id).setType(fa.PROFILE_PICTURE).setDimensions(gc,gc).setResizeMode(ma.COVER).setCallback(function(lc){fc.setAttribute('src',lc.uri);}).send();}else fc.setAttribute('src',dc.thumbSrc);var hc=xa.getNode(ec,'name');ba.setContent(hc,dc.name);var ic=xa.getNode(ec,'accessible-name');ba.setContent(ic,dc.name);var jc=xa.getNode(ec,'anchor');jc.setAttribute('href','/messages/'+bc);var kc=xa.getNode(ec,'tooltip');kc&&ua.set(kc,dc.name,'right');aa.set(ec,'id',bc);this._itemsMap[bc]={node:ec};cc&&cc(ec);}.bind(this));};ub.prototype._updateUnreadCount=function(bc,cc){"use strict";var dc=this._itemsMap[bc];if(!dc)return;if(this._isSidebar){this._unreadMessages=this._unreadMessages||{};if(!!cc){this._unreadMessages[bc]=true;}else delete this._unreadMessages[bc];h.inform('buddylist-nub/updateCount',{count:Object.keys(this._unreadMessages).length});}dc.unreadCount=dc.unreadCount||ba.find(dc.node,"._550_");cc=cc?cc:0;ba.setContent(dc.unreadCount,cc>qb?qb+'+':cc);z.conditionClass(dc.unreadCount,"_550z",cc>qb);z.conditionClass(dc.node,"_550-",cc);};ub.prototype.show=function(){"use strict";if(this._isVisible)return;this._isVisible=true;z.show(this._scrollableOrderedList||this._root);this.render();this.inform('show');};ub.prototype.isVisible=function(){"use strict";return this._isVisible;};ub.prototype.update=function(){"use strict";this._hasRendered=false;if(!this._renderRequest)this._renderRequest=fb(function(){this.render();this._renderRequest=null;}.bind(this));};ub.prototype.setScrollContainer=function(bc){"use strict";if(ba.contains(bc,this._root)){this._scrollContainer=bc;if(this._usePlaceholder){da.listen(bc,'scroll',ib.acrossTransitions(this._placeholderUpdate.bind(this)));da.listen(window,'resize',ib.acrossTransitions(function(){this._scrollContainerHeight=null;this._placeholderUpdate();}.bind(this),250));}}};ub.prototype.scrollTo=function(bc){"use strict";if(!this._scrollContainer)return;var cc=this._scrollContainer.scrollHeight,dc=this._scrollContainer.clientHeight,ec=this._scrollContainer.scrollTop,fc=Math.min(bc.offsetTop,cc-dc);if(ec!==fc){var gc=this._isLitestand?600:Math.abs(fc-ec)/this._scrollContainer.clientHeight*500,hc=this._isLitestand?ca.easeOutExpo:g.ease.end;new g(this._scrollContainer).to('scrollTop',fc).ease(hc).duration(gc).go();}};ub.prototype._applyContext=function(bc,cc){"use strict";var dc=q.getShortDisplay(bc)||'';if(cc.contextNode){ba.setContent(cc.contextNode,dc);z.conditionClass(cc.node,"_52zj",dc);var ec=q.get(bc),fc=ec?ec.type:null;for(var gc in ub.CONTEXT_CLASSES){var hc=(gc===fc),ic=ub.CONTEXT_CLASSES[gc]||"_56x-";z.conditionClass(cc.contextNode,ic,hc);}}};ub.getSortedList=function(bc,cc){"use strict";var dc=ka.getList().filter(function(gc){return !(gc in bc)&&na.getFriendVisibility(gc)!==na.BLACKLISTED;}),ec=[];if(!y.isOnline()){Array.prototype.push.apply(ec,dc);}else{if(na.getOnlinePolicy()===na.ONLINE_TO_WHITELIST)dc=this._filterByWhitelist(dc);if(p.get('chat_web_ranking_with_presence')){Array.prototype.push.apply(ec,dc);}else ec=this._splitOutTopFriends(dc,cc);}ec=ec.slice(0,cc);if(ec.length===cc){var fc=ub.getAvailableList(ec.concat(bc)).length;fc&&ec.splice(-1);}if(!p.get('chat_web_ranking_with_presence'))ec.sort(vb);nb=ec.slice();return ec;};ub._filterByWhitelist=function(bc){"use strict";var cc=bc,dc={},ec,fc;bc=[];for(ec=0;ec<cc.length;++ec){fc=cc[ec];if(na.allows(fc)){dc[fc]=true;bc.push(fc);}}var gc=na.getWhitelist();for(ec=0;ec<gc.length;++ec){fc=gc[ec];if(!(fc in dc))bc.push(fc);}for(ec=0;ec<cc.length;++ec){fc=cc[ec];if(!na.allows(fc))bc.push(fc);}return bc;};ub._splitOutTopFriends=function(bc,cc){"use strict";var dc=[],ec=[],fc=p.get('ordered_list.top_friends',0),gc=p.get('ordered_list.top_mobile',0),hc=cc,ic=bc.length;for(var jc=0;jc<ic&&hc>0;jc++){var kc=bc[jc],lc=oa.get(kc),mc=lc===m.ACTIVE;if(mc||(lc===m.MOBILE&&jc<gc)||jc<fc){dc.push(kc);mc&&hc--;}else ec.push(kc);}if(jc<ic)Array.prototype.push.apply(ec,bc.slice(jc));if(dc.length<cc)Array.prototype.push.apply(dc,ec);return dc;};ub.getAvailableList=function(bc){"use strict";var cc;if(p.get('divebar_show_mobile_more_friends')||p.get('divebar_show_mobile_more_friends_alphabetical'))cc=l.getAvailableIDs();if(!cc)cc=l.getOnlineIDs();return cc.filter(function(dc){return !(dc in bc);});};ub._pause=function(){"use strict";pb=true;};ub._unpause=function(){"use strict";pb=false;};ub._registerToggleRenderItem=function(bc){"use strict";da.listen(bc,'click',function(){pb=!pb;z.conditionClass(bc,'checked',pb);});};function vb(bc,cc){var dc=wb(bc,cc);if(dc!==0)return dc;if(!mb){var ec=zb(bc,cc);if(ec!==0)return ec;}return ka.compare(bc,cc);}function wb(bc,cc){var dc=na.allows(bc),ec=na.allows(cc);if(dc!==ec)return dc?-1:1;return 0;}var xb={};function yb(bc){return xb[bc]||(xb[bc]=ta.flatten(bc));}function zb(bc,cc){var dc=ra.getNowUnsafe(bc),ec=ra.getNowUnsafe(cc),fc=yb((dc||{}).name||'~'),gc=yb((ec||{}).name||'~');if(fc!==gc)return fc<gc?-1:1;return 0;}function ac(bc,cc){var dc=oa.get(bc)===m.MOBILE,ec=oa.get(cc)===m.MOBILE;if(dc!==ec)return ec?-1:1;return zb(bc,cc);}ya(ub,{CONTEXT_CLASSES:{nearby:"_56xw",visiting:"_56xx",neighbourhood:"_56xy",listening:"_56xz"}});e.exports=ub;});
__d("ChatTypeaheadBehavior",["Chat","ChatConfig","ChatFavoriteList","CSS","DOM","Parent","Rect","copyProperties","cx","tx"],function(a,b,c,d,e,f){var g=b('Chat'),h=b('ChatConfig'),i=b('ChatFavoriteList'),j=b('CSS'),k=b('DOM'),l=b('Parent'),m=b('Rect'),n=b('copyProperties'),o=b('cx'),p=b('tx');function q(s,t){if(!h.get('litestand_classic_sidebar'))return;var u=l.byClass(s,"_4oes");if(u)j.conditionClass(u,"_5q83",t);}function r(s){"use strict";this._typeahead=s;}r.prototype.enable=function(){"use strict";var s=this._typeahead;this._subscriptions=[s.subscribe('focus',function(){s.getData().refreshData();q(s.getElement(),true);}),s.subscribe('blur',function(t){s.getCore().reset();q(s.getElement(),false);}),s.subscribe('respond',function(t,u){if(u.value&&u.value===s.getCore().getValue()){if(!u.results.length){var v=h.get('divebar_typeahead_group_fof',0);if(v&&!u.isAsync)return;var w=k.create('div',{className:'noResults'},"Friend not found.");k.setContent(s.getView().getElement(),w);}j.addClass(s.getElement(),'hasValue');}}),s.subscribe('reset',function(){j.removeClass(s.getElement(),'hasValue');}),s.subscribe('select',function(t,u){s.getView().hide();if(i.isEditMode()){i.toggleID(u.selected.uid);i.save();}else{var v=j.hasClass(document.documentElement,'sidebarMode'),w={mode:v?'sidebar':'chatNub',source:'typeahead',type:u.selected.type,typeahead:true};g.openTab(u.selected.uid,u.selected.type,w);}}),s.subscribe('highlight',function(t,u){if(u.index>=0){var v=s.getView().getItems()[u.index];if(v){var w=new m(v),x=v.offsetParent,y=w.boundWithin(new m(x)).getPositionVector();w.getPositionVector().sub(y).scrollElementBy(x);}}})];};r.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(s){this._typeahead.unsubscribe(s);}.bind(this));this._subscriptions=null;};n(r.prototype,{_subscriptions:null});e.exports=r;});
__d("ChatTypeaheadCore",["function-extensions","Event","Keys","TypeaheadCore","copyProperties","emptyFunction","shield"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Event'),h=b('Keys'),i=b('TypeaheadCore'),j=b('copyProperties'),k=b('emptyFunction'),l=b('shield');for(var m in i)if(i.hasOwnProperty(m))o[m]=i[m];var n=i===null?null:i.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=i;function o(){"use strict";if(i!==null)i.apply(this,arguments);}o.prototype.init=function(p,q,r){"use strict";n.init.call(this,p,q,r);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}.bind(this));};o.prototype.keydown=function(event){"use strict";var p=g.getKeyCode(event);if(p===h.ESC){l(this.reset,this).defer();if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return n.keydown.call(this,event);};o.prototype.checkValue=function(){"use strict";var p=this.getValue(),q=this.value;if(p==q)return;if(q&&!p){this.typeaheadActive=false;this.informEndActive=true;}else if(!q&&p){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}n.checkValue.call(this);};j(o.prototype,{handleTab:k});e.exports=o;});
__d("ChatTypeaheadDataSource",["DataSource","Env","JSLogger","MercuryParticipantTypes","OrderedFriendsList","Run","ShortProfiles"],function(a,b,c,d,e,f){var g=b('DataSource'),h=b('Env'),i=b('JSLogger'),j=b('MercuryParticipantTypes'),k=b('OrderedFriendsList'),l=b('Run'),m=b('ShortProfiles');for(var n in g)if(g.hasOwnProperty(n))p[n]=g[n];var o=g===null?null:g.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=g;function p(q){"use strict";q=q||{};q.kanaNormalization=true;g.call(this,q);this.persistOnRefresh=q.persistOnRefresh!==false;this.showOfflineUsers=!!q.showOfflineUsers;this._jslog=i.create('chat_typeahead');this._jslog.log('created');}p.prototype.init=function(){"use strict";this._jslog.log('init');o.init.call(this);this._update();};p.prototype.bootstrap=function(){"use strict";this._jslog.log('bootstrap');o.bootstrap.call(this);if(this.showOfflineUsers){this._jslog.log('show_offline_users');this._jslog.log('ensured_short_profiles');if(m.hasAll()){this._update();}else{this._jslog.log('fetch_all_short_profiles');m.fetchAll();this.inform('activity',{activity:true});var q=m.subscribe('updated',function(){this.inform('activity',{activity:false});this._update();}.bind(this));if(!this.persistOnRefresh)l.onLeave(function(){m.unsubscribe(q);});}}};p.prototype._update=function(){"use strict";d(['AvailableList'],function(q){var r=this.value;this.dirty();var s=m.getCachedProfileIDs(),t=s.filter(function(v){var w=m.getNow(v);return w.type===j.FRIEND;});t.sort(k.compare);var u=[];t.forEach(function(v){if(v==h.user)return;var w=q.get(v);if(!this.showOfflineUsers&&w!==q.ACTIVE)return;var x=m.getNow(v),y=x.additionalName;if(x.hasOwnProperty('searchTokens'))y=y!==null?y+" "+x.searchTokens.join(" "):x.searchTokens.join(" ");u.push({uid:v,text:x.name,tokens:y,localized_text:x.name,additional_text:x.additionalName,photo:x.thumbSrc,type:x.type});}.bind(this));if(u.length)this.addEntries(u);this.value=r;if(r)this.query(r);}.bind(this));};p.prototype.refreshData=function(){"use strict";d(['AvailableList'],function(q){q.update();}.bind(this));};e.exports=p;});
__d("ChatSidebarHeader.react",["React","cx"],function(a,b,c,d,e,f){var g=b('React'),h=b('cx'),i=g.createClass({displayName:'ReactChatSidebarHeader',render:function(){return (g.DOM.div({className:"_55ob"},g.DOM.div({className:"_55oc"},this.props.name)));}});e.exports=i;});
__d("ChatSidebarUser.react",["ChatFavoriteList","WebMessengerPermalinkConstants","ChatConfig","React","ChatSidebarItem.react"],function(a,b,c,d,e,f){var g=b('ChatFavoriteList'),h=b('WebMessengerPermalinkConstants'),i=b('ChatConfig'),j=b('React'),k=b('ChatSidebarItem.react'),l=j.createClass({displayName:'ChatSidebarUser',render:function(){var m=h.getURIPathForIDOrVanity(this.props.userID),n=g.isFavored(this.props.userID),o=function(){g.toggleID(this.props.userID);}.bind(this),p=i.get('divebar_favorite_list',0)?n:undefined;return (k({href:{url:m},imageSize:this.props.imageSize,images:this.props.image,litestandSidebar:this.props.litestandSidebar,isAdded:p,showEditButton:g.isEditMode(),name:this.props.name,onEditClick:o,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,detailedStatus:this.props.detailedStatus,context:this.props.context}));}});e.exports=l;});
__d("ChatTypeaheadView",["BucketedTypeaheadView","ChatConfig","ChatTypeaheadConstants","Env","MercuryThreadSearchUtils","arrayContains","fbt","tx"],function(a,b,c,d,e,f){var g=b('BucketedTypeaheadView'),h=b('ChatConfig'),i=b('ChatTypeaheadConstants'),j=b('Env'),k=b('MercuryThreadSearchUtils'),l=b('arrayContains'),m=b('fbt'),n=b('tx'),o=h.get('divebar_typeahead_group_fof',0);for(var p in g)if(g.hasOwnProperty(p))r[p]=g[p];var q=g===null?null:g.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=g;function r(s,t){"use strict";g.call(this,s,t);this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[i.NON_FRIEND_TYPE]={uid:i.NON_FRIEND_TYPE,type:i.HEADER_TYPE,text:"FRIENDS OF FRIENDS"};this.typeObjectsOrder.push(i.NON_FRIEND_TYPE);this.typeObjects[i.THREAD_TYPE]={uid:i.THREAD_TYPE,type:i.HEADER_TYPE,text:"GROUP CONVERSATIONS"};this.typeObjectsOrder.push(i.THREAD_TYPE);this.typeObjects[i.FB4C_TYPE]={uid:i.FB4C_TYPE,type:i.HEADER_TYPE,text:"CO-WORKERS"};this.typeObjectsOrder.push(i.FB4C_TYPE);this.typeObjects[i.FRIEND_TYPE]={disabled:true,uid:i.FRIEND_TYPE,type:i.HEADER_TYPE,text:"FRIENDS"};this.typeObjectsOrder.push(i.FRIEND_TYPE);}r.prototype.buildBuckets=function(s,t){"use strict";if(o){t=t.reverse();t=t.filter(function(u){var v=u.render_type||u.type;if(v==='thread'){var w='fbid:'+j.user;if(!l(u.mercury_thread.participants,w))return false;var x=u.participants_to_render.some(function(z){return k.queryMatchesName(s,z.name);}),y=k.queryMatchesName(s,u.mercury_thread.name);if(!x&&!y)return false;}return true;});}t=q.buildBuckets.call(this,s,t);if(!o)t=t.filter(function(u){return u&&!u.disabled;});return t;};r.prototype.getDefaultIndex=function(s){"use strict";if(!o)return q.getDefaultIndex.call(this,s);if(s.length===0)return -1;var t=s.length-1;while(!this.isHighlightable(s[t])&&t>=0)t--;return t;};e.exports=r;});
__d("ChatBehavior",["Arbiter","AvailableList","AvailableListConstants","ChatConfig","copyProperties","MercuryConstants","ChatSidebarCalloutData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AvailableList'),i=b('AvailableListConstants'),j=b('ChatConfig'),k=b('copyProperties'),l=b('MercuryConstants').ChatNotificationConstants,m=b('ChatSidebarCalloutData').isShown,n=h.getWebChatNotification(),o=m,p=true,q=k(new g(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return n!==l.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return o;},showsTabUnreadUI:function(){if(j.get('web_messenger_suppress_tab_unread'))return p;return true;}});function r(){q.inform(q.ON_CHANGED);}h.subscribe(i.ON_CHAT_NOTIFICATION_CHANGED,function(){var s=n,t=h.getWebChatNotification();n=t;if(s!=t)r();});g.subscribe('chat/set_does_page_occlude_tabs',function(s,t){o=!!t;r();});g.subscribe('chat/set_show_tab_unread_ui',function(s,t){p=!!t;r();});e.exports=q;});
__d("ChatSidebarSheet",["function-extensions","ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","React","XUIButton.react","copyProperties","csx","cx","fbt","mixin","tx"],function(a,b,c,d,e,f){b('function-extensions');var g=b('ArbiterMixin'),h=b('BlackbirdUpsell'),i=b('ChannelConnection'),j=b('ChannelConstants'),k=b('ChatBehavior'),l=b('ChatConfig'),m=b('ChatVisibility'),n=b('CSS'),o=b('DOM'),p=b('Event'),q=b('JSLogger'),r=b('PresencePrivacy'),s=b('React'),t=b('XUIButton.react'),u=b('copyProperties'),v=b('csx'),w=b('cx'),x=b('fbt'),y=b('mixin'),z=b('tx'),aa=q.create('sidebar_sheet');function ba(ha){switch(ha){case j.HINT_AUTH:return "Your session has timed out. Please log in.";case j.HINT_CONN:return z._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});case j.HINT_MAINT:return z._("Facebook {Chat} is currently down for maintenance.",{Chat:"Chat"});default:return z._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});}}function ca(ha){var ia;if(ha===null){ia="Unable to connect to chat. Check your Internet connection.";}else if(ha>l.get('warning_countdown_threshold_msec')){var ja=o.create('a',{href:'#',className:'fbChatReconnectLink'},"Try again");ia=o.tx._("Unable to connect to chat. {try-again-link}",{'try-again-link':ja});}else if(ha>1000){ia=z._("Unable to connect to chat. Reconnecting in {seconds}...",{seconds:Math.floor(ha/1000)});}else ia="Unable to connect to chat. Reconnecting...";return ia;}var da=y(g);for(var ea in da)if(da.hasOwnProperty(ea))ga[ea]=da[ea];var fa=da===null?null:da.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=da;function ga(ha){"use strict";this._root=ha;this._litestandOffline=o.scry(ha,"._52d2");this._message=o.find(ha,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ga.prototype._handleConnectionChange=function(ha,ia){"use strict";this._channelStatus=ha;this._channelData=ia;this._render();};ga.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,ba(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var ha=this._channelData;o.setContent(this._message,ca(ha));if(ha>1000){if(ha>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=setTimeout(this._handleConnectionChange.bind(this,i.RECONNECTING,ha-1000),1000,false);}}};ga.prototype._renderOffline=function(){"use strict";if(this._isLitestand)return;if(this._litestandOffline&&this._litestandOffline.length)this._renderLitestandOffline();var ha='fbChatGoOnlineLink',ia="Turn on chat",ja=o.create('a',{href:'#',className:ha},ia),ka=o.tx._("{=Go online} to see who's available.",{'=Go online':ja});o.setContent(this._message,ka);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),ha)){aa.log('sidebar_go_online');m.goOnline();return false;}});};ga.prototype._renderLitestandOffline=function(){"use strict";this._litestandOffline=this._litestandOffline[0];this._isLitestand=true;if(l.get('litestand_blended_sidebar')){s.renderComponent(t({className:"_52cx _5d9x",href:{url:'#'},label:"Turn on Chat",onClick:function(){aa.log('sidebar_go_online');m.goOnline();}}),this._litestandOffline);this._litestandOffline=null;}else{s.renderComponent(s.DOM.a({className:"_52cx _52i7",href:"#",onClick:function(){aa.log('sidebar_go_online');m.goOnline();}},s.DOM.i({className:"_52c_"}),s.DOM.div({className:"_52cz"},s.DOM.div({className:"_52c-"},s.DOM.i({className:"_52d1"}),s.DOM.div({className:"_52cy"},o.tx._("Turn on Chat")))),s.DOM.i({className:"_52d0"}),s.DOM.div({className:"_4_vf",'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-position':"right",'aria-label':"Turn on Chat"})),this._litestandOffline);this._litestandOffline=null;}};ga.prototype._renderBlackbirdUpsell=function(){"use strict";o.setContent(this._message,h.getOfflineContent());};ga.prototype._renderBlackbird=function(ha){"use strict";o.setContent(this._message,h.getBlackbirdContent(ha));};ga.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ga.prototype._render=function(){"use strict";this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var ha=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,ha);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ia;if(l.get('litestand_blended_sidebar')){ia="Alerts are off";}else ia="Alerts are off while you use another client to chat.";o.setContent(this._message,ia);}this.inform('updated');};u(ga.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ga;});
__d("FBDesktopPlugin",["CacheStorage","DOM","Env","FBDesktopDetect","URI","Style"],function(a,b,c,d,e,f){var g=b('CacheStorage'),h=b('DOM'),i=b('Env'),j=b('FBDesktopDetect'),k=b('URI'),l=b('Style'),m=new g('localstorage','_socialfox_'),n={_plugin:'_not_checked',arbiterInform:function(o,p){var q=JSON.stringify({name:o,payload:p});this._transmitCommand('arbiterinform',q);},bringToFront:function(){this._transmitCommand('bringtofront');},dock:function(){this._transmitCommand('dock');},getPlugin:function(){if(this._plugin==='_not_checked'){this._plugin=null;if(j.isPluginInstalled()){var o=h.create('object',{id:'kiwi_plugin',type:j.mimeType});l.set(o,'width',0);l.set(o,'height',0);var p=h.create('div',{},o);l.set(p,'width',0);l.set(p,'height',0);document.body.appendChild(p);this._plugin=o;}}return this._plugin;},getUserID:function(){var o=this.getPlugin();return o&&'getUserID' in o&&o.getUserID();},getVersion:function(){var o=this.getPlugin();return o&&'getVersion' in o&&o.getVersion();},isAppRunning:function(){var o=this.getPlugin();return o&&'isAppRunning' in o&&o.isAppRunning();},launchApp:function(){var o=this.getPlugin();return o&&'launchApp' in o&&o.launchApp();},login:function(o,p){if(p&&o&&o.length>0){var q=this.getPlugin();if(q){this._transmitCommand('relogin\n'+o+'\n'+p);return;}}},logout:function(o){o=o||"0";var p=this.getPlugin();if(p)p.logout(o);},recheck:function(){if(this._plugin===null)this._plugin='_not_checked';},shouldSuppressBeeper:function(){return this.isAppRunning();},shouldSuppressMessages:function(){if(m&&m.get('connected'))return true;var o=this.getUserID();if(o){return o===i.user;}else return this.isAppRunning();},shouldSuppressSidebar:function(){var o=this.getPlugin(),p=o&&'isAppDocked' in o&&o.isAppDocked(),q=m&&m.get('active')==='true';return p||q;},transferAuthToken:function(o,p){if(o&&o.length>0){var q=this.getPlugin();if(q){q.setAccessToken(o,p);var r=setInterval(function(){q.setAccessToken(o,p);},500);setTimeout(function(){clearInterval(r);},10*1000);}}if(this.redirectHome)window.location.href=k().setPath().toString();},_transmitCommand:function(o,p){p=p||'';var q=this.getPlugin();if(q&&'transmitCommand' in q)q.transmitCommand(o,p);}};e.exports=n;});
__d("ChatSidebar",["ChatOrderedList","ChatTypeaheadBehavior","ChatTypeaheadCore","ChatTypeaheadDataSource","ChatTypeaheadRenderer","ChatTypeaheadView","Typeahead","Arbiter","ArbiterMixin","AsyncRequest","AsyncSignal","Bootloader","Chat","ChatConfig","ChatHovercard","ChatImpressionLogger","ChatOptions","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","FBDesktopPlugin","JSLogger","JSXDOM","KeyEventController","OrderedFriendsList","Parent","PresencePrivacy","ScrollableArea","SidebarFitWindowHeight","Style","UserAgent","ViewportBounds","copyProperties","createArrayFrom","csx","cx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f){b('ChatOrderedList');b('ChatTypeaheadBehavior');b('ChatTypeaheadCore');b('ChatTypeaheadDataSource');b('ChatTypeaheadRenderer');b('ChatTypeaheadView');b('Typeahead');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('AsyncSignal'),k=b('Bootloader'),l=b('Chat'),m=b('ChatConfig'),n=b('ChatHovercard'),o=b('ChatImpressionLogger'),p=b('ChatOptions'),q=b('ChatSidebarSheet'),r=b('CSS'),s=b('DOM'),t=b('DOMDimensions'),u=b('Event'),v=b('FBDesktopPlugin'),w=b('JSLogger'),x=b('JSXDOM'),y=b('KeyEventController'),z=b('OrderedFriendsList'),aa=b('Parent'),ba=b('PresencePrivacy'),ca=b('ScrollableArea'),da=b('SidebarFitWindowHeight'),ea=b('Style'),fa=b('UserAgent'),ga=b('ViewportBounds'),ha=b('copyProperties'),ia=b('createArrayFrom'),ja=b('csx'),ka=b('cx'),la=b('debounce'),ma=b('emptyFunction'),na=b('ge'),oa,pa=false,qa=false,ra=false,sa=false,ta=false,ua=false,va,wa,xa,ya,za,ab=null,bb,cb,db,eb,fb,gb,hb=28,ib=38,jb=w.create('chat_sidebar');function kb(){if(cb)return;r.removeClass(document.documentElement,'sidebarMode');if(!sa||!tb.isVisible()){g.inform('reflow');return;}ra=false;ab=null;va.hide();ya.getCore().reset();r.hide(wa);jb.rate('sidebar_hide',sa);tb.inform('sidebar/hide',tb);g.inform('sidebar/hide',tb);g.inform('reflow');}function lb(){var ub=tb.shouldShowSidebar();r.conditionClass(document.documentElement,'sidebarCapable',ub);if(tb.isEnabled()&&ub){ob();var vb;if(bb){var wb=r.hasClass(wa,"_4w59");if(wb)return;gb=gb||s.find(wa,"._50g0");if(bb.has_favorites_editing)fb=fb||s.scry(wa,"._52s9")[0];vb=[gb];}else vb=ia(wa.childNodes);var xb=nb(vb),yb=va.getItemHeight()||32,zb=va.getPaddingOffset()||8,ac;if(cb){if(cb.isExpanded()){zb=zb+hb;if(bb&&bb.always_show_one_see_more)zb+=yb;}if(!l.isOnline())zb+=ib;var bc=Math.floor(va.getItemPadding()/2);ac=Math.floor((xb-zb+bc)/yb);if(!va.isVisible())ea.set(oa,'height',xb+'px');}else{ac=Math.floor((xb-zb)/(yb+1));ea.set(oa,'height',xb+'px');}va.setNumTopFriends(ac);var cc=Math.floor((xb-zb)/yb);if(qb())cc=(cc-2)>0?cc-2:0;ya.getData().setMaxResults(cc);tb.inform('sidebar/resized',tb);g.inform('sidebar/resized',tb);g.inform('reflow');}else kb();if(!sa){sb();sa=true;}ab=null;}function mb(){if(ya&&tb.isVisible())ya.getCore().getElement().focus();}function nb(ub){if(!ub)if(bb){gb=gb||s.find(wa,"._50g0");ub=[gb];}else ub=ia(wa.childNodes);var vb=za.height;if(cb&&db)vb-=db.getFullHeight();ub.forEach(function(wb){if(wb&&wb!==oa)vb-=t.getElementDimensions(wb).height;});if(eb)vb-=eb.getOffset();return Math.max(0,vb);}function ob(){if(tb.isVisible())return;ra=true;ab=null;r.show(wa);r.addClass(document.documentElement,'sidebarMode');va.show();jb.rate('sidebar_show',sa);tb.inform('sidebar/show',tb);g.inform('sidebar/show',tb);}function pb(){p.setSetting('sidebar_mode',tb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(ma).setErrorHandler(ma).setData({sidebar_mode:tb.isEnabled()}).setAllowCrossPageTransition(true).send();}function qb(){return m.get('divebar_typeahead_group_fof',0);}function rb(){return z.getList().length<=m.get('sidebar.min_friends');}function sb(){var ub=true;if(!tb.isEnabled()){jb.log('state_not_enabled');ub=false;}if(!tb.isViewportCapable()){jb.log('state_not_shown_viewport');ub=false;}if(qa){jb.log('state_not_shown_hidden');ub=false;}if(rb()){jb.log('state_not_shown_num_friends');ub=false;}if(v.shouldSuppressSidebar()){jb.log('state_not_shown_fbdesktop');ub=false;}jb.log(ub?'state_shown':'state_not_shown');}var tb={init:function(ub,vb,wb,xb){tb.init=ma;ta=true;wa=ub;va=vb;ya=wb;xa=xb;oa=s.find(ub,'div.fbChatSidebarBody');cb=xb&&xb.ls_module;bb=xb&&xb.ls_config;if(cb){g.subscribe('ViewportSizeChange',function(){g.inform('ChatOrderedList/itemHeightChange');lb();});g.subscribe('Sidebar/BookmarksHeightChange',lb);k.loadModules(['LitestandSidebarBookmarksDisplay'],function(bc){db=bc;});}else u.listen(window,'resize',lb);y.registerKey('q',function(event){if(ra){var bc=null;if(gb){bc=s.scry(gb,'.inputsearch')[0];}else bc=s.scry(ub,'.inputsearch')[0];if(bc){bc.focus();event.prevent();}}});new n(vb);var yb=new q(ub);yb.subscribe('updated',lb);g.subscribe('sidebar/invalidate',lb);vb.setScrollContainer(aa.byClass(vb.getRoot(),'uiScrollableAreaWrap'));vb.subscribe(['render','show','hide'],la(function(bc){if(bc==='render'&&!ua){ua=true;tb.inform('sidebar/chatRendered',null,g.BEHAVIOR_PERSISTENT);}var cc=vb.getRoot(),dc=ca.getInstance(cc);dc&&dc.adjustGripper();}));vb.subscribe(['editStart','editEnd'],function(bc){r.conditionClass(ya.getView().element,"_4-d6",bc=='editStart');});if(fa.firefox()>=17)u.listen(window,'storage',function(bc){if(bc.key=='_socialfox_active'&&bc.oldValue!=bc.newValue)lb();});g.subscribe('chat/option-changed',function(bc,cc){if(cc.name=="sidebar_mode"){pa=!!p.getSetting('sidebar_mode');lb();}});wb.getCore().subscribe('sidebar/typeahead/active',tb.updateOnActiveTypeahead);wb.subscribe('reset',function(){if(!wb.getCore().getValue()&&!va.isVisible())tb.updateOnActiveTypeahead(null,false);});if(cb){wb.getCore().subscribe('sidebar/typeahead/preActive',function(bc,cc){if(pa&&ya.getView().isVisible()){g.inform(bc,cc);}else lb();});}else g.subscribe('buddylist-nub/initialized',function(bc,cc){u.listen(cc.getButton(),'click',function(event){var dc=qa;qa=false;tb.enable();var ec=tb.shouldShowSidebar();qa=dc&&!ec;return !ec;});});pa=!!p.getSetting('sidebar_mode');fa.ie()&&u.listen(ub,'click',function(bc){if(aa.byClass(bc.getTarget(),"_57du"))mb();});ba.subscribe('privacy-user-presence-changed',lb);lb();o.init(va);if(!cb)ga.addRight(tb.getVisibleWidth);tb.inform('sidebar/initialized',tb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',tb,g.BEHAVIOR_PERSISTENT);if(m.get('sidebar_below_bluebar')){var zb=s.find(ub,"._5qqe");eb=new da(zb);eb.subscribe('resized',lb);}if(m.get('chat_sidebar_load_log')){var ac={loaded:true,session_token:xb.session_token,buddylist_short:m.get('buddylist_short_group')};new j('/ajax/chat/sidebar_load_log.php',ac).send();}},updateOnActiveTypeahead:function(ub,vb){if(!ra)return;if(vb){va.hide();if(cb){r.addClass(wa,"_5384");var wb=nb();if(fb)wb+=t.getElementDimensions(fb).height;ea.set(oa,'height',wb+'px');}}else{va.show();if(cb){ea.set(oa,'height','auto');r.removeClass(wa,"_5384");g.inform('sidebar/typeahead/active',false);lb();}else lb();}},isInitialized:function(){return sa;},disable:function(){if(!tb.isEnabled())return;pa=false;pb();kb();},enable:function(){if(tb.isEnabled())return;pa=true;pb();lb();mb.defer();},forceEnsureLoaded:function(){if(ta)return;if(na('pagelet_sidebar'))return;d(['UIPagelet'],function(ub){var vb=x.div({id:"pagelet_sidebar"});s.appendContent(document.body,vb);ub.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ta=true;},ensureLoaded:function(){if(!pa)return;tb.forceEnsureLoaded();},hide:function(){if(qa)return;qa=true;kb();},unhide:function(){if(!qa)return;qa=false;lb();},getBody:function(){return oa;},getRoot:function(){return wa;},getVisibleWidth:function(){if(!ra||!wa)return 0;if(ab===null)ab=wa.offsetWidth;return ab;},isEnabled:function(){return pa;},isViewportCapable:function(){za=t.getViewportWithoutScrollbarDimensions();if(cb)return true;var ub=m.get('sidebar.minimum_width');return za.width>ub;},shouldShowSidebar:function(){var ub=tb.isViewportCapable();return cb||(ub&&!qa&&(!rb()||m.get('litestand_blended_sidebar',false))&&!v.shouldSuppressSidebar());},isVisible:function(){return ra;},resize:lb,toggle:function(){if(cb){cb.toggle();}else tb.isEnabled()?tb.disable():tb.enable();},isLitestandSidebar:function(){return !!cb;}};ha(tb,h);e.exports=tb;});
__d("legacy:ChatTypeaheadBehavior",["ChatTypeaheadBehavior"],function(a,b,c,d){var e=b('ChatTypeaheadBehavior');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.chatTypeahead=function(f){f.enableBehavior(e);};},3);
__d("Dock",["function-extensions","Event","shield","WebMessengerWidthControl","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","ge"],function(a,b,c,d,e,f){b('function-extensions');var g=b('Event'),h=b('shield');b('WebMessengerWidthControl');var i=b('Arbiter'),j=b('ArbiterMixin'),k=b('ChatQuietLinks'),l=b('CSS'),m=b('DataStore'),n=b('DOM'),o=b('Parent'),p=b('Style'),q=b('Toggler'),r=b('Vector'),s=b('copyProperties'),t=b('csx'),u=b('emptyFunction'),v=b('ge');function w(){}s(w,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(x){this.init=u;this.rootEl=x;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(x,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(y,z){var aa=z.getActive();if(!n.contains(x,aa))return;if(l.hasClass(aa,'fbNub')){this.notifyNub(aa,y);if(y==='show')this._resizeNubFlyout(aa);}else{var ba=o.byClass(aa,'fbNubFlyout');if(ba)l.conditionClass(ba,'menuOpened',y==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var x=v('blueBar');if(x){var y=p.isFixed(x)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(x,y).y+r.getElementDimensions(x).y;}},toggle:function(x){var y=this._findFlyout(x);if(!y)return;this.subscribe('init',function(){q.toggle(x);});},show:function(x){this.subscribe('init',function(){q.show(x);});},showNub:function(x){l.show(x);},hide:function(x){this.subscribe('init',function(){var y=q.getInstance(x);n.contains(x,y.getActive())&&y.hide();});},hideNub:function(x){l.hide(x);this.hide(x);},setUseMaxHeight:function(x,y){l.conditionClass(x,'maxHeight',y!==false);this._resizeNubFlyout(x);},_resizeNubFlyout:function(x){var y=this._findFlyout(x);if(!y||!(l.hasClass(x,'openToggler')||l.hasClass(x,'opened')))return;var z=n.find(y,'div.fbNubFlyoutOuter'),aa=n.find(z,'div.fbNubFlyoutInner'),ba=n.find(aa,'div.fbNubFlyoutBody'),ca=ba.scrollTop,da=ba.offsetHeight;p.set(ba,'height','auto');var ea=r.getElementDimensions(y),fa=r.getElementDimensions(ba),ga=this.getMaxFlyoutHeight(x);p.set(y,'max-height',ga+'px');p.set(z,'max-height',ga+'px');ea=r.getElementDimensions(y);var ha=r.getElementDimensions(aa),ia=ha.y-fa.y,ja=ea.y-ia,ka=parseInt(ba.style.height||ba.clientHeight,10),la=ja!==ka;if(ea.y>ia&&la)p.set(ba,'height',ja+'px');l.removeClass(y,'swapDirection');var ma=r.getElementPosition(y).x;l.conditionClass(y,'swapDirection',function(){if(ma<0)return true;return (ma+ea.x>this.viewportDimensions.x);}.bind(this)());if(la&&ca+da>=fa.y){ba.scrollTop=ba.scrollHeight;}else ba.scrollTop=ca;this.notifyNub(x,'resize');},getMaxFlyoutHeight:function(x){var y=this._findFlyout(x),z=r.getElementPosition(y,'viewport'),aa=r.getElementDimensions(y),ba=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-z.y-aa.y);return Math.max(ba,0);},resizeAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this._resizeNubFlyout(x[y]);},hideAllFlyouts:function(){var x=this._getAllNubs(),y=x.length;while(y--)this.hide(x[y]);},_getAllNubs:function(){var x=n.scry(this.rootEl,"div._50-v.openToggler");return x.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var x=event.getTarget(),y=o.byClass(x,'fbNub');if(y){if(o.byClass(x,'fbNubFlyoutTitlebar')){var z=o.byTag(x,'a'),aa=x.nodeName=='INPUT'&&x.getAttribute('type')=='submit';if(!z&&!aa){this.hide(y);return false;}}this.notifyNub(y,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(x){return l.hasClass(x,'fbNubFlyout')?x:n.scry(x,'div.fbNubFlyout')[0]||null;},registerNubController:function(x,y){m.set(x,'dock:nub:controller',y);y.subscribe('nub/button/content-changed',h(this.inform,this,'resize',x));y.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,x));},unregisterNubController:function(x){m.remove(x,'dock:nub:controller');},notifyNub:function(x,y,z){var aa=m.get(x,'dock:nub:controller');aa&&aa.inform(y,z);}});e.exports=a.Dock||w;});
__d("NubController",["ArbiterMixin","Dock","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('Dock'),i=b('copyProperties');function j(){}i(j.prototype,g,{init:function(k){this.el=k;h.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){h.hide(this.el);},show:function(){h.show(this.el);}});e.exports=j;});
__d("swfobject",["AsyncRequest","Bootloader","ControlledReferer","copyProperties","CSS","DOM","function-extensions","ge","htmlSpecialChars"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('ControlledReferer'),j=b('copyProperties'),k=b('CSS'),l=b('DOM');b('function-extensions');var m=b('ge'),n=b('htmlSpecialChars');if(typeof o=="undefined")var o={};if(typeof o.util=="undefined")o.util={};if(typeof o.SWFObjectUtil=="undefined")o.SWFObjectUtil={};o.SWFObject=function(u,v,w,x,y,z,aa,ba,ca,da){if(!document.getElementById)return;this.DETECT_KEY=da?da:'detectflash';this.skipDetect=o.util.getRequestParameter(this.DETECT_KEY);this.params={};this.variables={};this.attributes=[];this.fallback_html='';this.fallback_js_fcn=function(){};if(u)this.setAttribute('swf',u);if(v)this.setAttribute('id',v);if(w)this.setAttribute('width',w);if(x)this.setAttribute('height',x);this.installedVer=o.SWFObjectUtil.getPlayerVersion();if(y){if(!(y instanceof Array))y=[y];var ea;y.forEach(function(ha){ea=new o.PlayerVersion(ha.toString().split('.'));if(ea.major==this.installedVer.major){this.setAttribute('version',ea);return;}else if(!this.getAttribute('version')||ea.major<this.getAttribute('version').major)this.setAttribute('version',ea);}.bind(this));}if(!window.opera&&document.all&&this.installedVer.major>7)if(!o.unloadSet){o.SWFObjectUtil.prepUnload=function(){var ha=function(){},ia=function(){};window.attachEvent("onunload",o.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",o.SWFObjectUtil.prepUnload);o.unloadSet=true;}if(z)this.addParam('bgcolor',z);var fa=aa?aa:'high';this.addParam('quality',fa);this.setAttribute('useExpressInstall',false);this.setAttribute('doExpressInstall',false);var ga=(ba)?ba:window.location;this.setAttribute('xiRedirectUrl',ga);this.setAttribute('redirectUrl','');if(ca)this.setAttribute('redirectUrl',ca);this.setAttribute('useIframe',false);};o.SWFObject.ieWorkaroundApplied=false;o.SWFObject.ensureIEWorkaroundAttached=function(){if(!o.SWFObject.ieWorkaroundApplied&&document.attachEvent){o.SWFObject.ieWorkaroundApplied=true;document.attachEvent('onpropertychange',o.SWFObject.onDocumentPropertyChange);}};o.SWFObject.onDocumentPropertyChange=function(event){if(event.propertyName=="title"){var u=document.title;if(u!=null&&u.indexOf('#!')!=-1){u=u.substring(0,u.indexOf('#!'));document.title=u;}}};j(o.SWFObject.prototype,{useExpressInstall:function(u){this.xiSWFPath=!u?"/swf/expressinstall.swf":u;this.setAttribute('useExpressInstall',true);},setAttribute:function(u,v){this.attributes[u]=v;},getAttribute:function(u){return this.attributes[u]||"";},addParam:function(u,v){this.params[u]=v;},getParams:function(){return this.params;},addVariable:function(u,v){this.variables[u]=v;},getVariable:function(u){return this.variables[u]||"";},getVariables:function(){return this.variables;},getVariablePairs:function(){var u=[],v,w=this.getVariables();for(v in w)u[u.length]=v+"="+w[v];return u.join('&');},getSWFHTML:function(){var u,v,w;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute('swf',this.xiSWFPath);}v={type:'application/x-shockwave-flash',src:this.getAttribute('swf'),width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;',id:this.getAttribute('id'),name:this.getAttribute('id')};var x=this.getParams();for(var y in x)v[y]=x[y];w=this.getVariablePairs();if(w)v.flashvars=w;u=t('embed',v,null);}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute('swf',this.xiSWFPath);}v={id:this.getAttribute('id'),classid:'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000',width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;'};var z=t('param',{name:'movie',value:this.getAttribute('swf')},null),x=this.getParams();for(var y in x)z+=t('param',{name:y,value:x[y]},null);w=this.getVariablePairs();if(w)z+=t('param',{name:'flashvars',value:w},null);u=t('object',v,z);}return u;},write:function(u){if(this.getAttribute('useExpressInstall')){var v=new o.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(v)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable("MMredirectURL",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}var w=(typeof u=='string')?document.getElementById(u):u;if(!w)return false;k.addClass(w,'swfObject');w.setAttribute('data-swfid',this.getAttribute('id'));if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){if(!this.getAttribute('useIframe')){o.SWFObject.ensureIEWorkaroundAttached();w.innerHTML=this.getSWFHTML();}else this._createIframe(w);return true;}else{if(this.getAttribute('redirectUrl')!="")document.location.replace(this.getAttribute('redirectUrl'));var x=this.getAttribute('version').major+'.'+this.getAttribute('version').minor+'.'+this.getAttribute('version').release+'.'+this.getAttribute('version').build,y=this.installedVer.major+'.'+this.installedVer.minor+'.'+this.installedVer.release+'.'+this.installedVer.build;this.fallback_js_fcn(y,x);w.innerHTML=this.fallback_html;}return false;},_createIframe:function(u){var v=l.create('iframe',{width:this.getAttribute('width'),height:this.getAttribute('height'),frameBorder:0});l.empty(u);u.appendChild(v);i.useFacebookRefererHtml(v,this.getSWFHTML(),this.getAttribute('iframeSource'));}});o.SWFObjectUtil.getPlayerVersion=function(){var u=new o.PlayerVersion([0,0,0,0]),v;if(navigator.plugins&&navigator.mimeTypes.length){for(var w=0;w<navigator.plugins.length;w++)try{var y=navigator.plugins[w];if(y.name=='Shockwave Flash'){v=new o.PlayerVersion(y.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+(r|d)|\s+b[0-9]+)/,".").split("."));if(typeof u=='undefined'||v.major>u.major||(v.major==u.major&&(v.minor>u.minor||(v.minor==u.minor&&(v.release>u.release||(v.release==u.release&&v.build>u.build))))))u=v;}}catch(x){}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var z=1,aa=3;while(z)try{aa++;z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+aa);u=new o.PlayerVersion([aa,0,0]);}catch(ba){z=null;}}else{try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(ca){try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");u=new o.PlayerVersion([6,0,21]);z.AllowScriptAccess="always";}catch(da){if(u.major==6)return u;}try{z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(ea){}}if(z!=null)u=new o.PlayerVersion(z.GetVariable("$version").split(" ")[1].split(","));}return u;};o.PlayerVersion=function(u){this.major=u[0]!=null?parseInt(u[0],10):0;this.minor=u[1]!=null?parseInt(u[1],10):0;this.release=u[2]!=null?parseInt(u[2],10):0;this.build=u[3]!=null?parseInt(u[3],10):0;};o.PlayerVersion.prototype.versionIsValid=function(u){if(this.major<u.major)return false;if(this.major>u.major)return true;if(this.minor<u.minor)return false;if(this.minor>u.minor)return true;if(this.release<u.release)return false;if(this.release>u.release)return true;if(this.build<u.build)return false;return true;};o.util={getRequestParameter:function(u){var v=document.location.search||document.location.hash;if(u==null)return v;if(v){var w=v.substring(1).split("&");for(var x=0;x<w.length;x++)if(w[x].substring(0,w[x].indexOf("="))==u)return w[x].substring((w[x].indexOf("=")+1));}return "";}};o.SWFObjectUtil.cleanupSWFs=function(){var u=document.getElementsByTagName("OBJECT");for(var v=u.length-1;v>=0;v--){u[v].style.display='none';for(var w in u[v])if(typeof u[v][w]=='function')u[v][w]=function(){};}};if(!document.getElementById&&document.all)document.getElementById=function(u){return document.all[u];};var p=o.util.getRequestParameter,q=o.SWFObject,r=o.SWFObject;o.spawn_flash_update_dialog=function(){new g().setURI('/ajax/flash_update_dialog.php').setMethod('GET').setReadOnly(true).send();};function s(u,v){var w=m(u),x=o.SWFObjectUtil.getPlayerVersion(),y;v.forEach(function(ba){ba=new o.PlayerVersion(ba.toString().split('.'));if(ba.major==x.major){y=ba;return;}else if(typeof y=='undefined'||ba.major<y.major)y=ba;}.bind(this));if(w&&x.major>0){var z=x.major+'.'+x.minor+'.'+x.release+'.'+x.build,aa=y.major+'.'+y.minor+'.'+y.release+'.'+y.build;l.setContent(w,l.tx._("Flash {required-version} is required to view this content. Your current version is {current-version}. Please download the latest Flash Player.",{'required-version':aa,'current-version':z}));}}o.showFlashErrorDialog=function(u,v){h.loadModules(['ErrorDialog'],function(w){w.show(u,v);});};function t(u,v,w){var x=/^[A-Za-z0-9\-]+$/;if(!u.match(x))throw new Error('Invalid tag '+u);var y='<'+u;for(var z in v){if(!z.match(x))throw new Error('Invalid attr '+z);y+=' '+z+'="'+n(v[z])+'"';}if(w===null){return y+'/>';}else return y+'>'+w+'</'+u+'>';}e.exports=a.deconcept||o;});
__d("swfobject2",[],function(a,b,c,d,e,f){var g=function(){var h="undefined",i="object",j="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",l="application/x-shockwave-flash",m="SWFObjectExprInst",n="onreadystatechange",o=window,p=document,q=navigator,r=false,s=[ka],t=[],u=[],v=[],w,x,y,z,aa=false,ba=false,ca,da,ea=true,fa=function(){var eb=typeof p.getElementById!=h&&typeof p.getElementsByTagName!=h&&typeof p.createElement!=h,fb=q.userAgent.toLowerCase(),gb=q.platform.toLowerCase(),hb=gb?/win/.test(gb):/win/.test(fb),ib=gb?/mac/.test(gb):/mac/.test(fb),jb=/webkit/.test(fb)?parseFloat(fb.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,kb=!+"\v1",lb=[0,0,0],mb=null;if(typeof q.plugins!=h&&typeof q.plugins[j]==i){mb=q.plugins[j].description;if(mb&&!(typeof q.mimeTypes!=h&&q.mimeTypes[l]&&!q.mimeTypes[l].enabledPlugin)){r=true;kb=false;mb=mb.replace(/^.*\s+(\S+\s+\S+$)/,"$1");lb[0]=parseInt(mb.replace(/^(.*)\..*$/,"$1"),10);lb[1]=parseInt(mb.replace(/^.*\.(.*)\s.*$/,"$1"),10);lb[2]=/[a-zA-Z]/.test(mb)?parseInt(mb.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else if(typeof o.ActiveXObject!=h)try{var ob=new ActiveXObject(k);if(ob){mb=ob.GetVariable("$version");if(mb){kb=true;mb=mb.split(" ")[1].split(",");lb=[parseInt(mb[0],10),parseInt(mb[1],10),parseInt(mb[2],10)];}}}catch(nb){}return {w3:eb,pv:lb,wk:jb,ie:kb,win:hb,mac:ib};}(),ga=function(){if(!fa.w3)return;if((typeof p.readyState!=h&&p.readyState=="complete")||(typeof p.readyState==h&&(p.getElementsByTagName("body")[0]||p.body)))ha();if(!aa){if(typeof p.addEventListener!=h)p.addEventListener("DOMContentLoaded",ha,false);if(fa.ie&&fa.win){p.attachEvent(n,function(){if(p.readyState=="complete"){p.detachEvent(n,arguments.callee);ha();}});if(o==top)(function(){if(aa)return;try{p.documentElement.doScroll("left");}catch(eb){setTimeout(arguments.callee,0);return;}ha();})();}if(fa.wk)(function(){if(aa)return;if(!/loaded|complete/.test(p.readyState)){setTimeout(arguments.callee,0);return;}ha();})();ja(ha);}}();function ha(){if(aa)return;try{var fb=p.getElementsByTagName("body")[0].appendChild(xa("span"));fb.parentNode.removeChild(fb);}catch(eb){return;}aa=true;var gb=s.length;for(var hb=0;hb<gb;hb++)s[hb]();}function ia(eb){if(aa){eb();}else s[s.length]=eb;}function ja(eb){if(typeof o.addEventListener!=h){o.addEventListener("load",eb,false);}else if(typeof p.addEventListener!=h){p.addEventListener("load",eb,false);}else if(typeof o.attachEvent!=h){ya(o,"onload",eb);}else if(typeof o.onload=="function"){var fb=o.onload;o.onload=function(){fb();eb();};}else o.onload=eb;}function ka(){if(r){la();}else ma();}function la(){var eb=p.getElementsByTagName("body")[0],fb=xa(i);fb.setAttribute("type",l);fb.setAttribute('style','visibility: hidden; position: absolute; top: -1000px;');var gb=eb.appendChild(fb);if(gb){var hb=0;(function(){if(typeof gb.GetVariable!=h){var ib=gb.GetVariable("$version");if(ib){ib=ib.split(" ")[1].split(",");fa.pv=[parseInt(ib[0],10),parseInt(ib[1],10),parseInt(ib[2],10)];}}else if(hb<10){hb++;setTimeout(arguments.callee,10);return;}gb=null;ma();})();}else ma();}function ma(){var eb=t.length;if(eb>0)for(var fb=0;fb<eb;fb++){var gb=t[fb].id,hb=t[fb].callbackFn,ib={success:false,id:gb};if(fa.pv[0]>0){var jb=wa(gb);if(jb)if(za(t[fb].swfVersion)&&!(fa.wk&&fa.wk<312)){bb(gb,true);if(hb){ib.success=true;ib.ref=na(gb);hb(ib);}}else if(t[fb].expressInstall&&oa()){var kb={};kb.data=t[fb].expressInstall;kb.width=jb.getAttribute("width")||"0";kb.height=jb.getAttribute("height")||"0";if(jb.getAttribute("class"))kb.styleclass=jb.getAttribute("class");if(jb.getAttribute("align"))kb.align=jb.getAttribute("align");var lb={},mb=jb.getElementsByTagName("param"),nb=mb.length;for(var ob=0;ob<nb;ob++)if(mb[ob].getAttribute("name").toLowerCase()!="movie")lb[mb[ob].getAttribute("name")]=mb[ob].getAttribute("value");pa(kb,lb,gb,hb);}else{qa(jb);if(hb)hb(ib);}}else{bb(gb,true);if(hb){var pb=na(gb);if(pb&&typeof pb.SetVariable!=h){ib.success=true;ib.ref=pb;}hb(ib);}}}}function na(eb){var fb=null,gb=wa(eb);if(gb&&gb.nodeName=="OBJECT")if(typeof gb.SetVariable!=h){fb=gb;}else{var hb=gb.getElementsByTagName(i)[0];if(hb)fb=hb;}return fb;}function oa(){return !ba&&za("6.0.65")&&(fa.win||fa.mac)&&!(fa.wk&&fa.wk<312);}function pa(eb,fb,gb,hb){ba=true;y=hb||null;z={success:false,id:gb};var ib=wa(gb);if(ib){if(ib.nodeName=="OBJECT"){w=ra(ib);x=null;}else{w=ib;x=gb;}eb.id=m;if(typeof eb.width==h||(!/%$/.test(eb.width)&&parseInt(eb.width,10)<310))eb.width="310";if(typeof eb.height==h||(!/%$/.test(eb.height)&&parseInt(eb.height,10)<137))eb.height="137";p.title=p.title.slice(0,47)+" - Flash Player Installation";var jb=fa.ie&&fa.win?"ActiveX":"PlugIn",kb="MMredirectURL="+o.location.toString().replace(/&/g,"%26")+"&MMplayerType="+jb+"&MMdoctitle="+p.title;if(typeof fb.flashvars!=h){fb.flashvars+="&"+kb;}else fb.flashvars=kb;if(fa.ie&&fa.win&&ib.readyState!=4){var lb=xa("div");gb+="SWFObjectNew";lb.setAttribute("id",gb);ib.parentNode.insertBefore(lb,ib);ib.style.display="none";(function(){if(ib.readyState==4){ib.parentNode.removeChild(ib);}else setTimeout(arguments.callee,10);})();}sa(eb,fb,gb);}}function qa(eb){if(fa.ie&&fa.win&&eb.readyState!=4){var fb=xa("div");eb.parentNode.insertBefore(fb,eb);fb.parentNode.replaceChild(ra(eb),fb);eb.style.display="none";(function(){if(eb.readyState==4){eb.parentNode.removeChild(eb);}else setTimeout(arguments.callee,10);})();}else eb.parentNode.replaceChild(ra(eb),eb);}function ra(eb){var fb=xa("div");if(fa.win&&fa.ie){fb.innerHTML=eb.innerHTML;}else{var gb=eb.getElementsByTagName(i)[0];if(gb){var hb=gb.childNodes;if(hb){var ib=hb.length;for(var jb=0;jb<ib;jb++)if(!(hb[jb].nodeType==1&&hb[jb].nodeName=="PARAM")&&!(hb[jb].nodeType==8))fb.appendChild(hb[jb].cloneNode(true));}}}return fb;}function sa(eb,fb,gb){var hb,ib=wa(gb);if(fa.wk&&fa.wk<312)return hb;if(ib){if(typeof eb.id==h)eb.id=gb;if(fa.ie&&fa.win){var jb="";for(var kb in eb)if(eb[kb]!=Object.prototype[kb])if(kb.toLowerCase()=="data"){fb.movie=eb[kb];}else if(kb.toLowerCase()=="styleclass"){jb+=' class="'+eb[kb]+'"';}else if(kb.toLowerCase()!="classid")jb+=' '+kb+'="'+eb[kb]+'"';var lb="";for(var mb in fb)if(fb[mb]!=Object.prototype[mb])lb+='<param name="'+mb+'" value="'+fb[mb]+'" />';ib.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+jb+'>'+lb+'</object>';u[u.length]=eb.id;hb=wa(eb.id);}else{var nb=xa(i);nb.setAttribute("type",l);for(var ob in eb)if(eb[ob]!=Object.prototype[ob])if(ob.toLowerCase()=="styleclass"){nb.setAttribute("class",eb[ob]);}else if(ob.toLowerCase()!="classid")nb.setAttribute(ob,eb[ob]);for(var pb in fb)if(fb[pb]!=Object.prototype[pb]&&pb.toLowerCase()!="movie")ta(nb,pb,fb[pb]);ib.parentNode.replaceChild(nb,ib);hb=nb;}}return hb;}function ta(eb,fb,gb){var hb=xa("param");hb.setAttribute("name",fb);hb.setAttribute("value",gb);eb.appendChild(hb);}function ua(eb){var fb=wa(eb);if(fb&&fb.nodeName=="OBJECT")if(fa.ie&&fa.win){fb.style.display="none";(function(){if(fb.readyState==4){va(eb);}else setTimeout(arguments.callee,10);})();}else fb.parentNode.removeChild(fb);}function va(eb){var fb=wa(eb);if(fb){for(var gb in fb)if(typeof fb[gb]=="function")fb[gb]=null;fb.parentNode.removeChild(fb);}}function wa(eb){var fb=null;try{fb=p.getElementById(eb);}catch(gb){}return fb;}function xa(eb){return p.createElement(eb);}function ya(eb,fb,gb){eb.attachEvent(fb,gb);v[v.length]=[eb,fb,gb];}function za(eb){var fb=fa.pv,gb=eb.split(".");gb[0]=parseInt(gb[0],10);gb[1]=parseInt(gb[1],10)||0;gb[2]=parseInt(gb[2],10)||0;return (fb[0]>gb[0]||(fb[0]==gb[0]&&fb[1]>gb[1])||(fb[0]==gb[0]&&fb[1]==gb[1]&&fb[2]>=gb[2]))?true:false;}function ab(eb,fb,gb,hb){if(fa.ie&&fa.mac)return;var ib=p.getElementsByTagName("head")[0];if(!ib)return;var jb=(gb&&typeof gb=="string")?gb:"screen";if(hb){ca=null;da=null;}if(!ca||da!=jb){var kb=xa("style");kb.setAttribute("type","text/css");kb.setAttribute("media",jb);ca=ib.appendChild(kb);if(fa.ie&&fa.win&&typeof p.styleSheets!=h&&p.styleSheets.length>0)ca=p.styleSheets[p.styleSheets.length-1];da=jb;}if(fa.ie&&fa.win){if(ca&&typeof ca.addRule==i)ca.addRule(eb,fb);}else if(ca&&typeof p.createTextNode!=h)ca.appendChild(p.createTextNode(eb+" {"+fb+"}"));}function bb(eb,fb){if(!ea)return;var gb=fb?"visible":"hidden";if(aa&&wa(eb)){wa(eb).style.visibility=gb;}else ab("#"+eb,"visibility:"+gb);}function cb(eb){var fb=/[\\\"<>\.;]/,gb=fb.exec(eb)!=null;return gb&&typeof encodeURIComponent!=h?encodeURIComponent(eb):eb;}var db=function(){if(fa.ie&&fa.win)window.attachEvent("onunload",function(){var eb=v.length;for(var fb=0;fb<eb;fb++)v[fb][0].detachEvent(v[fb][1],v[fb][2]);var gb=u.length;for(var hb=0;hb<gb;hb++)ua(u[hb]);for(var ib in fa)fa[ib]=null;fa=null;for(var jb in g)g[jb]=null;g=null;});}();return {registerObject:function(eb,fb,gb,hb){if(fa.w3&&eb&&fb){var ib={};ib.id=eb;ib.swfVersion=fb;ib.expressInstall=gb;ib.callbackFn=hb;t[t.length]=ib;bb(eb,false);}else if(hb)hb({success:false,id:eb});},getObjectById:function(eb){if(fa.w3)return na(eb);},embedSWF:function(eb,fb,gb,hb,ib,jb,kb,lb,mb,nb){var ob={success:false,id:fb};if(fa.w3&&!(fa.wk&&fa.wk<312)&&eb&&fb&&gb&&hb&&ib){bb(fb,false);ia(function(){gb+="";hb+="";var pb={};if(mb&&typeof mb===i)for(var qb in mb)pb[qb]=mb[qb];pb.data=eb;pb.width=gb;pb.height=hb;var rb={};if(lb&&typeof lb===i)for(var sb in lb)rb[sb]=lb[sb];if(kb&&typeof kb===i)for(var tb in kb)if(typeof rb.flashvars!=h){rb.flashvars+="&"+tb+"="+kb[tb];}else rb.flashvars=tb+"="+kb[tb];if(za(ib)){var ub=sa(pb,rb,fb);if(pb.id==fb)bb(fb,true);ob.success=true;ob.ref=ub;}else if(jb&&oa()){pb.data=jb;pa(pb,rb,fb,nb);return;}else bb(fb,true);if(nb)nb(ob);});}else if(nb)nb(ob);},switchOffAutoHideShow:function(){ea=false;},ua:fa,getFlashPlayerVersion:function(){return {major:fa.pv[0],minor:fa.pv[1],release:fa.pv[2]};},hasFlashPlayerVersion:za,createSWF:function(eb,fb,gb){if(fa.w3){return sa(eb,fb,gb);}else return undefined;},showExpressInstall:function(eb,fb,gb,hb){if(fa.w3&&oa())pa(eb,fb,gb,hb);},removeSWF:function(eb){if(fa.w3)ua(eb);},createCSS:function(eb,fb,gb,hb){if(fa.w3)ab(eb,fb,gb,hb);},addDomLoadEvent:ia,addLoadEvent:ja,getQueryParamValue:function(eb){var fb=p.location.search||p.location.hash;if(fb){if(/\?/.test(fb))fb=fb.split("?")[1];if(eb==null)return cb(fb);var gb=fb.split("&");for(var hb=0;hb<gb.length;hb++)if(gb[hb].substring(0,gb[hb].indexOf("="))==eb)return cb(gb[hb].substring((gb[hb].indexOf("=")+1)));}return "";},expressInstallCallback:function(){if(ba){var eb=wa(m);if(eb&&w){eb.parentNode.replaceChild(w,eb);if(x){bb(x,true);if(fa.ie&&fa.win)w.style.display="block";}if(y)y(z);}ba=false;}}};}();e.exports=g;});
__d("SoundPlayer",["Arbiter","ChatConfig","swfobject","swfobject2","URI","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatConfig'),i=b('swfobject').SWFObject,j=b('swfobject2'),k=b('URI'),l=b('createArrayFrom'),m={},n=null,o=false,p='so_sound_player',q='/swf/SoundPlayer.swf?v=1',r='10.0.22.87',s=null,t=h.get('sound.useswfobject_2',false),u=h.get('sound.force_flash',false);function v(da){var ea=k(da);if(!ea.getDomain())return k().setPath(ea.getPath()).toString();return da;}function w(da){var ea=k(da).getPath();if(/\.mp3$/.test(ea))return 'audio/mpeg';if(/\.og[ga]$/.test(ea))return 'audio/ogg';return '';}function x(){if(!s&&!u){var da=document.createElement('audio');if(!da||!da.canPlayType)return null;da.setAttribute('preload','auto');document.body.appendChild(da);s=da;}return s;}function y(){var da=document[p]||window[p];if(da)if(!da.playSound&&da.length)da=da[0];return (da&&da.playSound&&da.loopSound)?da:null;}function z(){return o;}function aa(da,ea,fa){n={path:da,sync:ea,loop:fa};}function ba(){o=true;if(n){var da=y();if(n.loop){da.loopSound(n.path,n.sync);}else da.playSound(n.path,n.sync);}}var ca={init:function(da){da=l(da);var ea;for(var fa=0;fa<da.length;++fa){ea=da[fa];if(m[ea])return;}var ga=x();for(fa=0;ga&&fa<da.length;++fa){ea=da[fa];if(ga.canPlayType(ea)){m[ea]=true;return;}}m['audio/mpeg']=true;if(y())return;try{g.registerCallback(ba,['sound/player_ready','sound/ready']);var ia=document.createElement('div');ia.id='sound_player_holder';document.body.appendChild(ia);if(t){j.embedSWF(q,ia.id,'1px','1px',r,null,{swf_id:p},{allowscriptaccess:'always',wmode:'transparent'},null,function(ka){window[p]=ka.ref;g.inform('sound/player_ready');});}else{var ja=new i(q,p,'1px','1px',[r],'#ffffff');ja.addParam('allowscriptaccess','always');ja.addParam('wmode','transparent');ja.addVariable('swf_id',p);ja.fallback_html=' ';ja.write(ia.id);window[p]=ja;g.inform('sound/player_ready');}}catch(ha){}},play:function(da,ea){da=l(da);var fa=x(),ga,ha;for(var ia=0;fa&&ia<da.length;++ia){ga=da[ia];ha=w(ga);if(!fa.canPlayType(ha))continue;ca.init([ha]);fa.src=v(ga);if(ea){fa.setAttribute('loop','');}else fa.removeAttribute('loop');fa.play();return;}for(ia=0;ia<da.length;++ia){ga=v(da[ia]);ha=w(ga);if(ha!='audio/mpeg')continue;ca.init([ha]);var ja=y();if(!z()){aa(ga,true,ea);return;}else if(ja){if(ea){ja.loopSound(ga,true);}else ja.playSound(ga,true);return;}}},stop:function(da){da=l(da);for(var ea=0;ea<da.length;++ea){var fa=v(da[ea]),ga=x(),ha=y();if(ga&&ga.src==fa){ga.pause();ga.src=undefined;}else ha&&ha.stopSound(fa);}}};e.exports=ca;});
__d("SoundSynchronizer",["SoundPlayer","WebStorage","createArrayFrom"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('WebStorage'),i=b('createArrayFrom'),j='fb_sounds_playing3';function k(){var o=h.getLocalStorage();if(o)try{var q=o[j];if(q){q=JSON.parse(q);if(Array.isArray(q))return q;}}catch(p){}return [];}function l(o){var p=h.getLocalStorage();if(p){var q=k();q.push(o);while(q.length>5)q.shift();try{p[j]=JSON.stringify(q);}catch(r){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;g.play(o,q);l(p);},isSupported:function(){return !!h.getLocalStorage();}};e.exports=n;});
__d("Sound",["SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('SoundRPC'),i=b('SoundSynchronizer'),j=b('URI'),k=b('UserAgent'),l=null,m={init:function(q){if(!l)g.init(q);},play:function(q,r,s){if(l){h.playRemote(l.contentWindow,q,r,false);}else h.playLocal(q,r,s);},stop:function(q){if(!l)g.stop(q);}},n=new j(location.href);if(n.getSubdomain()&&n.getSubdomain()!=='www')n.setSubdomain('www');var o=n.getDomain();function p(){if(k.ie()<9)return false;return i.isSupported()&&h.supportsRPC();}if(n.isFacebookURI()&&location.host!==o&&p()){l=document.createElement('iframe');l.setAttribute('src','//'+o+'/sound_iframe.php');l.style.display='none';document.body.appendChild(l);}e.exports=m;});