/*!CK:1380569912!*//*1384823947,178146371*/

if (self.CavalryLogger) { CavalryLogger.start_js(["UfU98"]); }

__d("PUWApplications",[],function(a,b,c,d,e,f){e.exports={WEB_FLASH:"web_flash",WEB_ARCHIVE:"web_archive",MOBILE_PMA_ANDROID:"mobile_pma_android",MOBILE_FB4A:"mobile_fb4a",WEB_COMPOSER:"web_composer",WEB_M_TOUCH:"web_m_touch",WEB_M_ZERO:"web_m_zero",MOBILE_PMA_IOS:"mobile_pma_ios",WEB_SIMPLE:"web_simple",MOBILE_FB4IOS_SNAP:"mobile_fb4ios_snap",THIRD_PARTY:"third_party",WEB_M_BASIC:"web_m_basic",WEB_MESSENGER:"web_messenger",WEB_M_OTHERS:"web_m_others",MOBILE_FB4IOS:"mobile_fb4ios",WEB_HTML5:"web_html5"};});
__d("PUWMethods",[],function(a,b,c,d,e,f){e.exports={DRAGDROP:"dragdrop",RECENT_PHOTOS:"recent_photos",VAULT:"vault",PHOTOS_OF_YOU:"photos_of_you",FILE_SELECTOR:"file_selector",METHOD_EDITOR:"editor"};});
__d("PUWSteps",[],function(a,b,c,d,e,f){e.exports={CLIENT_FLOW_INCOMPLETE:"client_flow_incomplete",SERVER_UPLOAD_BEGIN:"server_upload_begin",CLIENT_UPLOAD_CANCEL:"client_upload_cancel",CLIENT_SELECT_BEGIN:"client_select_begin",CLIENT_FLOW_FATAL:"client_flow_fatal",CLIENT_TRANSFER_BATCH_FAIL:"client_transfer_batch_fail",CLIENT_PROCESS_UNAVAILABLE:"client_process_unavailable",CLIENT_PUBLISH_SUCCESS:"client_publish_success",CLIENT_PROCESS_CANCEL:"client_process_cancel",CLIENT_TRANSFER_BATCH_BEGIN:"client_transfer_batch_begin",CLIENT_UPLOAD_FAIL:"client_upload_fail",SERVER_PUBLISH_BEGIN:"server_publish_begin",CLIENT_TRANSFER_BEGIN:"client_transfer_begin",CLIENT_RETRY_CANCEL:"client_retry_cancel",CLIENT_PROCESS_BEGIN:"client_process_begin",CLIENT_TRANSFER_BATCH_SUCCESS:"client_transfer_batch_success",CLIENT_FLOW_RETRY:"client_flow_retry",CLIENT_TRANSFER_ENQUEUE:"client_transfer_enqueue",CLIENT_RETRY_FAIL:"client_retry_fail",CLIENT_PUBLISH_ENQUEUE:"client_publish_enqueue",CLIENT_TRANSFER_SUCCESS:"client_transfer_success",SERVER_UPLOAD_FAIL:"server_upload_fail",CLIENT_FLOW_CANCEL:"client_flow_cancel",CLIENT_RETRY_SUCCESS:"client_retry_success",CLIENT_FLOW_GIVEUP:"client_flow_giveup",SERVER_PUBLISH_FAIL:"server_publish_fail",CLIENT_PROCESS_SUCCESS:"client_process_success",CLIENT_SELECT_CANCEL:"client_select_cancel",CLIENT_SELECT_FAIL:"client_select_fail",CLIENT_PUBLISH_BEGIN:"client_publish_begin",CLIENT_UPLOAD_BEGIN:"client_upload_begin",CLIENT_TRANSFER_CANCEL:"client_transfer_cancel",CLIENT_UPLOAD_SUCCESS:"client_upload_success",CLIENT_FLOW_SUCCESS:"client_flow_success",CLIENT_TRANSFER_BATCH_CANCEL:"client_transfer_batch_cancel",CLIENT_FLOW_BEGIN:"client_flow_begin",CLIENT_PROCESS_FAIL:"client_process_fail",SERVER_PUBLISH_SUCCESS:"server_publish_success",SERVER_UPLOAD_SUCCESS:"server_upload_success",CLIENT_SELECT_SUCCESS:"client_select_success",CLIENT_RETRY_BEGIN:"client_retry_begin",CLIENT_PUBLISH_FAIL:"client_publish_fail",CLIENT_FLOW_POST:"client_flow_post",CLIENT_TRANSFER_FAIL:"client_transfer_fail",CLIENT_FLOW_FAIL:"client_flow_fail"};});
__d("FlexibleBlock.react",["LeftRight.react","React","cx","invariant","keyMirror","merge"],function(a,b,c,d,e,f){var g=b('LeftRight.react'),h=b('React'),i=b('cx'),j=b('invariant'),k=b('keyMirror'),l=b('merge'),m=k({left:true,right:true});function n(p){j(p.flex&&p.flex in o.FLEX);j(p.children&&p.children.length===2);}var o=h.createClass({displayName:'FlexibleBlock',render:function(){n(this.props);var p,q=this.props.children[0],r=this.props.children[1],s=this.props.flex==m.left,t=h.DOM.div({className:"_42ef"});if(s){t.props.children=[q];p=g.DIRECTION.right;}else{t.props.children=[r];p=g.DIRECTION.left;}var u=g({direction:p},s?t:this.props.children[0],s?this.props.children[1]:t);u.props=l(this.props,u.props);return u;}});o.FLEX=m;e.exports=o;});
__d("Grid.react",["ReactPropTypes","React","cx","flattenChildren","getObjectValues","joinClasses"],function(a,b,c,d,e,f){var g=b('ReactPropTypes'),h=b('React'),i=b('cx'),j=b('flattenChildren'),k=b('getObjectValues'),l=b('joinClasses'),m=h.createClass({displayName:'Grid',propTypes:{cols:g.number.isRequired,fixed:g.bool,alignv:g.oneOf(['top','middle','bottom']),alignh:g.oneOf(['left','center','right']),spacing:g.string},render:function(){var p=k(j(this.props.children)),q=p.length,r=[],s=[],t=0;p.forEach(function(u,v){if(!(u instanceof n.componentConstructor))u=n(null,u);u.props.alignv=u.props.alignv||this.props.alignv;u.props.alignh=u.props.alignh||this.props.alignh;if(this.props.spacing)o(u,this.props.spacing);s.push(u);t+=Math.max(u.props.colSpan||0,1);if(t%this.props.cols===0||v+1===q){if(this.props.fixed&&t<this.props.cols){for(var w=t;w<this.props.cols;w++)s.push(n(null));t=this.props.cols;}if(t===this.props.cols)o(s[s.length-1],"_51mw");r.push(h.DOM.tr({className:"_51mx",key:v},s));s=[];t=0;}}.bind(this));return this.transferPropsTo(h.DOM.table({className:(("uiGrid")+(' '+"_51mz")+(this.props.fixed?' '+"_5f0n":'')),cellSpacing:"0",cellPadding:"0"},h.DOM.tbody(null,r)));}}),n=h.createClass({displayName:'GridItem',propTypes:{alignv:g.oneOf(['top','middle','bottom']),alignh:g.oneOf(['left','center','right'])},render:function(){var p=(("_51m-")+(this.props.alignv==='top'?' '+"vTop":'')+(this.props.alignv==='middle'?' '+"vMid":'')+(this.props.alignv==='bottom'?' '+"vBot":'')+(this.props.alignh==='left'?' '+"hLeft":'')+(this.props.alignh==='center'?' '+"hCent":'')+(this.props.alignh==='right'?' '+"hRght":''));return this.transferPropsTo(h.DOM.td({className:p},this.props.children));}}),o=function(p,q){p.props.className=l(p.props.className,q);};m.GridItem=n;e.exports=m;});
__d("AbstractDialog.react",["DialogX","LayerHideOnBlur","ReactPropTypes","copyProperties","merge"],function(a,b,c,d,e,f){var g=b('DialogX'),h=b('LayerHideOnBlur'),i=b('ReactPropTypes'),j=b('copyProperties'),k=b('merge'),l={createSpec:function(m){return {displayName:m.displayName,propTypes:{behaviors:i.object,modal:i.bool,autohide:i.number,width:i.number,titleID:i.string,causalElement:i.object,causalElementRef:i.string,shown:i.bool,layerHideOnBlur:i.bool},createLayer:function(n){var o=j({width:this.props.width,xui:true,autohide:this.props.autohide,titleID:this.props.titleID,causalElement:this._getCausalElement()},m||{}),p=k(m.addedBehaviors,this.props.behaviors);if(this.props.layerHideOnBlur!==false)p.LayerHideOnBlur=h;o.addedBehaviors=this.enumerateBehaviors(p);var q=new g(o,n);q.conditionShow(this.props.shown);return q;},receiveProps:function(n){this.updateBehaviors(n.behaviors);this.layer.setCausalElement(this._getCausalElement());this.layer.conditionShow(n.shown);n.shown&&this.layer.updatePosition();},_getCausalElement:function(){var n;if(this.props.causalElementRef){n=this.getNodeForOwnerRef(this.props.causalElementRef);}else n=this.props.causalElement;return n;}};}};e.exports=l;});
__d("formatDate",["DateFormatConfig","fbt","invariant"],function(a,b,c,d,e,f){var g=b('DateFormatConfig'),h=b('fbt'),i=b('invariant'),j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=["January","February","March","April","May","June","July","August","September","October","November","December"],n=['',"st","nd","rd","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","th","st","nd","rd","th","th","th","th","th","th","th","st"];function o(s,t,u){u=u||{};if(!t||!s)return '';if(typeof s==='string')s=parseInt(s,10);if(typeof s==='number')s=new Date(s*1000);i(s instanceof Date);i(!isNaN(s.getTime()));i(s.getTime()<1e+15);if(typeof t!=='string'){var v=q();for(var w in v){var x=v[w];if(x.start<=s.getTime()&&t[x.name]){t=t[x.name];break;}}}var y;if(u.skipPatternLocalization||r()||t.length===1){y=t;}else{i(g.formats[t]);y=g.formats[t];}var z=u.utc?'getUTC':'get',aa=s[z+'Date'](),ba=s[z+'Day'](),ca=s[z+'Month'](),da=s[z+'FullYear'](),ea=s[z+'Hours'](),fa=s[z+'Minutes'](),ga=s[z+'Seconds'](),ha=s[z+'Milliseconds'](),ia='';for(var ja=0;ja<y.length;ja++){var ka=y.charAt(ja);switch(ka){case '\\':ja++;ia+=y.charAt(ja);break;case 'd':ia+=p(aa,2);break;case 'j':ia+=aa;break;case 'S':ia+=n[aa];break;case 'D':ia+=j[ba];break;case 'l':ia+=k[ba];break;case 'F':case 'f':ia+=m[ca];break;case 'M':ia+=l[ca];break;case 'm':ia+=p(ca+1,2);break;case 'n':ia+=ca+1;break;case 'Y':ia+=da;break;case 'y':ia+=(''+da).slice(2);break;case 'a':if(ea<12){ia+="am";}else ia+="pm";break;case 'A':if(ea<12){ia+="AM";}else ia+="PM";break;case 'g':ia+=(ea===0||ea===12)?12:ea%12;break;case 'G':ia+=ea;break;case 'h':if(ea===0||ea===12){ia+=12;}else ia+=p(ea%12,2);break;case 'H':ia+=p(ea,2);break;case 'i':ia+=p(fa,2);break;case 's':ia+=p(ga,2);break;case 'X':ia+=p(ha,3);break;default:ia+=ka;}}return ia;}function p(s,t){return Array(t-(''+s).length+1).join('0')+s;}function q(){var s=new Date(),t=s.getTime(),u=s.getFullYear(),v=s.getDate()-((s.getDay()-g.weekStart+6)%7),w=new Date(u,s.getMonth()+1,0).getDate(),x=new Date(u,1,29).getMonth()===1?366:365,y=1000*60*60*24;return [{name:'today',start:s.setHours(0,0,0,0)},{name:'withinDay',start:t-y},{name:'thisWeek',start:new Date(s.getTime()).setDate(v)},{name:'withinWeek',start:t-y*7},{name:'thisMonth',start:s.setDate(1)},{name:'withinMonth',start:t-y*w},{name:'thisYear',start:s.setMonth(0)},{name:'withinYear',start:t-y*x},{name:'older',start:-Infinity}];}o.periodNames=['today','thisWeek','thisMonth','thisYear','withinDay','withinWeek','withinMonth','withinYear','older'];function r(){if(!window||!window.location)return false;var s=window.location.pathname,t='/intern';return s.substr(0,t.length)===t;}e.exports=o;});
__d("MercuryMessages",["AsyncRequest","Env","KeyedCallbackManager","MercuryActionTypeConstants","MercuryActionStatus","MercuryAssert","MercuryAttachmentType","MercuryGenericConstants","MercuryIDs","MercuryLogMessageType","MercuryMessageClientState","MercuryMessageSourceTags","MercuryPayloadSource","MercurySendLogger","MercurySingletonMixin","MercurySourceType","MercuryTimePassed","MercuryMessageIDs","MercuryParticipants","PresenceUtil","RangedCallbackManager","ReportState","MercuryServerRequests","MercuryThreadInformer","MercuryThreads","copyProperties","debounceAcrossTransitions","formatDate","invariant","isNode","randomInt","tx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Env'),i=b('KeyedCallbackManager'),j=b('MercuryActionTypeConstants'),k=b('MercuryActionStatus'),l=b('MercuryAssert'),m=b('MercuryAttachmentType'),n=b('MercuryGenericConstants'),o=b('MercuryIDs'),p=b('MercuryLogMessageType'),q=b('MercuryMessageClientState'),r=b('MercuryMessageSourceTags'),s=b('MercuryPayloadSource'),t=b('MercurySendLogger'),u=b('MercurySingletonMixin'),v=b('MercurySourceType'),w=b('MercuryTimePassed'),x=b('MercuryMessageIDs'),y=b('MercuryParticipants'),z=b('PresenceUtil'),aa=b('RangedCallbackManager'),ba=b('ReportState'),ca=b('MercuryServerRequests'),da=b('MercuryThreadInformer'),ea=b('MercuryThreads'),fa=b('copyProperties'),ga=b('debounceAcrossTransitions'),ha=b('formatDate'),ia=b('invariant'),ja=b('isNode'),ka=b('randomInt'),la=b('tx');function ma(eb,fb){var gb=fb;if(eb._localIdsMap[fb])gb=eb._localIdsMap[fb];return eb._messages[gb];}var na=new i();function oa(eb,fb){if(fb.status===undefined)fb.status=k.UNSENT;fb.timestamp_absolute="Today";fb.message_id=fb.message_id||eb.generateNewClientMessageID(fb.timestamp);var gb=y.getIDForUser(eb._fbid);fb.specific_to_list=fb.specific_to_list||[];if(fb.specific_to_list.length&&fb.specific_to_list.indexOf(gb)===-1)fb.specific_to_list.push(gb);if(!fb.thread_id){if(fb.specific_to_list.length==1){fb.thread_id='user:'+eb._fbid;}else if(fb.specific_to_list.length==2){var hb=fb.specific_to_list[0]==gb?fb.specific_to_list[1]:fb.specific_to_list[0];if(o.tokenize(hb).type=='email'){fb.thread_id=n.PENDING_THREAD_ID;}else fb.thread_id=eb._threads.getThreadIDForParticipant(hb);}fb.thread_id=fb.thread_id||'root:'+fb.message_id;}if(!fb.specific_to_list.length){var ib=eb._serverRequests.tokenizeThreadID(fb.thread_id);if(ib.type=='user')fb.specific_to_list=['fbid:'+ib.value,gb];}}function pa(eb,fb,gb,hb){var ib=ab(gb)?[r.CHAT]:[],jb=Date.now(),kb=ha(new Date(jb),'g:ia'),lb={action_type:fb,thread_id:hb,author:y.getIDForUser(eb._fbid),author_email:null,coordinates:null,timestamp:jb,timestamp_absolute:(new Date(jb)).toLocaleDateString(),timestamp_relative:kb,timestamp_time_passed:w.TODAY,is_unread:false,is_cleared:false,is_forward:false,is_filtered_content:false,is_spoof_warning:false,source:gb,source_tags:ib};return lb;}function qa(eb){switch(eb){case s.UNKNOWN:case s.SERVER_INITIAL_DATA:case s.SERVER_FETCH_THREAD_INFO:case s.SERVER_THREAD_SYNC:return true;}return false;}function ra(eb){return eb&&eb.substr(0,6)==='server';}function sa(eb,fb){if(!eb._threadsToMessages[fb])eb._threadsToMessages[fb]=new aa(function(gb){return ma(eb,gb).timestamp;},function(gb,hb){return hb-gb;});return eb._threadsToMessages[fb];}function ta(eb){var fb=[];return JSON.stringify(eb,function(gb,hb){if(typeof hb==='object'&&hb!==null){if(ja(hb))return '<'+hb.nodeName+'>';if(fb.indexOf(hb)!==-1)return 'CIRCULAR';fb.push(hb);}return hb;});}ba.registerCallback('mercury-messages',function(){var eb={},fb={},gb=va._getInstances();for(var hb in gb){eb[hb]={};for(var ib in gb[hb]._messages){var jb=gb[hb]._messages[ib];if(Object.keys(jb).length===0)continue;var kb=jb.thread_id;eb[hb][kb]=eb[hb][kb]||{};eb[hb][kb][jb.message_id]=JSON.parse(ta(jb));}fb[hb]=fa({},gb[hb]._localIdsMap);}var lb={};lb.local_message_ids=fb;lb.messages=eb;return lb;});function ua(eb,fb,gb){fb.forEach(function(hb){var ib=sa(eb,hb);ib.setReachedEndOfArray();eb._threadInformer.reorderedMessages(hb,gb);});}function va(eb){this._fbid=eb;this._serverRequests=ca.getForFBID(this._fbid);this._threadInformer=da.getForFBID(this._fbid);this._threads=ea.getForFBID(this._fbid);this._failedHistoryFetchThreads={};this._threadsToMessages={};this._titanMessagesCount={};this._localTitanMessagesCount={};this._messages={};this._attachmentData={};this._messagesNeedingAttachmentData={};this._localIdsMap={};this._serverRequests.subscribe('update-messages',function(fb,gb){var hb=(gb.actions||[]).filter(function(jb){var kb=jb.action_type;return (jb.is_forward||jb.thread_id)&&(kb==j.LOG_MESSAGE||kb==j.USER_GENERATED_MESSAGE||kb==j.SEND_MESSAGE||kb==j.CLEAR_CHAT||kb==j.DELETE_THREAD||kb==j.DELETE_MESSAGES);}),ib=qa(gb.payload_source);if(ra(gb.payload_source))hb.forEach(function(jb){if(!jb.is_forward){var kb=this._threads.getThreadMetaNow(jb.thread_id);if(kb)jb.is_cleared=jb.timestamp<kb.chat_clear_time;}}.bind(this));this.handleUpdates(hb,ib,gb.payload_source,gb.from_client);if(gb.end_of_history)ua(this,gb.end_of_history,gb.payload_source);}.bind(this));}fa(va.prototype,{getMessagesFromIDs:function(eb){return (eb||[]).map(ma.curry(this)).filter(function(fb){return fb;});},hasLoadedNMessages:function(eb,fb){var gb=sa(this,eb);return gb.hasReachedEndOfArray()||gb.getCurrentArraySize()>=fb;},hasLoadedExactlyNMessages:function(eb,fb){var gb=sa(this,eb);return gb.getCurrentArraySize()==fb;},getThreadMessagesRange:function(eb,fb,gb,hb,ib,jb){var kb=sa(this,eb),lb=function(rb){hb(wa(this,rb));}.bind(this),mb=kb.executeOrEnqueue(fb,gb,lb),nb=kb.getUnavailableResources(mb),ob=this._failedHistoryFetchThreads[eb];if(nb.length&&!ob){var pb=(this._titanMessagesCount[eb]||0)-(this._localTitanMessagesCount[eb]||0),qb=nb.length+(this._localTitanMessagesCount[eb]||0);this._serverRequests.fetchThreadMessages(eb,pb,qb,ib,jb);}else this._failedHistoryFetchThreads[eb]=false;return mb;},getThreadMessagesSinceTimestamp:function(eb,fb){var gb=sa(this,eb),hb=gb.getElementsUntil(fb);return wa(this,hb);},hasLoadedAllMessages:function(eb){return sa(this,eb).hasReachedEndOfArray();},getCurrentlyLoadedMessages:function(eb){var fb=sa(this,eb).getAllResources();return wa(this,fb);},unsubscribe:function(eb,fb){l.isThreadID(fb);var gb=sa(this,fb);gb.unsubscribe(eb);},addAttachmentData:function(eb,fb,gb){var hb=ma(this,eb);if(hb){var ib=hb.attachments.indexOf(fb);if(ib!=-1){hb.attachments[ib]=gb;this._threadInformer.updatedMessage(hb.thread_id,hb.message_id,'attach');}}else{if(!this._attachmentData[eb])this._attachmentData[eb]=[];this._attachmentData[eb].push({attach_key:fb,data:gb});}},handleUpdates:function(eb,fb,gb,hb){var ib,jb={},kb={};for(var lb=0;lb<eb.length;lb++){var mb=eb[lb];if(mb.is_forward||gb==s.SERVER_SEARCH){if(!this._messages[mb.message_id]){this._messages[mb.message_id]=mb;bb(this,mb);}continue;}if(mb.client_state===q.SEND_TO_SERVER){this._messages[mb.message_id]=mb;bb(this,mb);continue;}var nb=mb.action_type;if(nb==j.SEND_MESSAGE){var ob=mb.client_message_id;if(ob&&this._localIdsMap[ob]&&mb.status){if(mb.status==k.UNCONFIRMED){if(!kb[mb.thread_id])kb[mb.thread_id]=[];kb[mb.thread_id].push(mb.client_message_id);}else if(!jb[mb.thread_id])jb[mb.thread_id]=[];var pb=ma(this,mb.client_message_id),qb=pb.status;pb.status=mb.status;if(mb.status===k.SUCCESS||mb.error_data)pb.error_data=mb.error_data;if(mb.status==k.SUCCESS){this.updateLocalMessage(mb,gb);if(mb.client_thread_id==n.PENDING_THREAD_ID){pb.thread_id=mb.thread_id;jb[mb.thread_id].push(pb.message_id);na.setResource(pb.message_id,pb.thread_id);}}if(typeof qb!='undefined'||mb.status==k.FAILED_UNKNOWN_REASON||mb.status==k.UNABLE_TO_CONFIRM||mb.status==k.SUCCESS||mb.status==k.ERROR)this._threadInformer.updatedMessage(mb.thread_id,ma(this,mb.client_message_id).message_id,gb);}continue;}else if(nb==j.DELETE_THREAD){sa(this,mb.thread_id).removeAllResources();continue;}else if(nb==j.DELETE_MESSAGES){var rb=mb.message_ids.map(function(yb){return ma(this,yb).message_id;}.bind(this));ib=sa(this,mb.thread_id);ib.removeResources(rb);this._threadInformer.reorderedMessages(mb.thread_id,gb);continue;}else if(nb==j.LOG_MESSAGE){if(mb.log_message_type==p.SERVER_ERROR)this._failedHistoryFetchThreads[mb.thread_id]=true;}else if(nb==j.CLEAR_CHAT){var sb=sa(this,mb.thread_id).getAllResources();sb.map(ma.curry(this)).forEach(function(yb){yb.is_cleared=true;});continue;}var tb=ma(this,mb.message_id);if((mb.threading_id&&this._localIdsMap[mb.threading_id])||(tb&&!tb.is_forward))continue;if(!jb[mb.thread_id])jb[mb.thread_id]=[];jb[mb.thread_id].push(mb.message_id);this._messages[mb.message_id]=mb;bb(this,mb);if(mb.threading_id&&mb.threading_id!=mb.message_id)x.addServerID(mb.threading_id,mb.message_id);if(!fb)this._threadInformer.receivedMessage(mb);}for(var ub in jb){ib=sa(this,ub);var vb=ib.getAllResources(),wb=vb.filter(function(yb){var zb=this._messages[yb];return zb.action_type==j.LOG_MESSAGE&&zb.log_message_type==p.SERVER_ERROR;}.bind(this));ib.removeResources(wb);xa(this,ub,jb[ub]);if(hb)ya(this,ub,jb[ub]);if(fb){ib.addResources(jb[ub]);this._threadInformer.reorderedMessages(ub,gb);}else ib.addResourcesWithoutSorting(jb[ub].reverse(),0);this._threadInformer.updatedThread(ub);}var xb=Object.keys(kb);if(xb.length)this._serverRequests.requestMessageConfirmation(kb);},sendMessage:function(eb,fb,gb){var event=t.CLIENT_SEND_ATTEMPTED;if(eb.status===k.RESENDING)event=t.CLIENT_RESEND_ATTEMPTED;var hb=false;if(o.isValid(eb.thread_id))hb=!o.isMultichat(eb.thread_id);(function(){t.log(event,eb.message_id,{canonical:hb});}).defer();fb=fb||Function.prototype;oa(this,eb);this._localIdsMap[eb.message_id]=eb.message_id;if(eb.thread_id=='root:'+eb.message_id)sa(this,eb.thread_id).setReachedEndOfArray();this._serverRequests.sendNewMessage(eb,gb);if(eb.thread_id==n.PENDING_THREAD_ID){this._messages[eb.message_id]=eb;return na.executeOrEnqueue(eb.message_id,fb);}else fb(eb.thread_id);},isOutbound:function(eb){return eb.author==y.user;},isInbound:function(eb){return !this.isOutbound(eb);},isFirstMessage:function(eb){var fb=sa(this,eb.thread_id);if(fb.getCurrentArraySize()===0)return false;var gb=fb.getResourceAtIndex(fb.getCurrentArraySize()-1),hb=ma(this,gb).message_id,ib=ma(this,eb.message_id).message_id;return fb.hasReachedEndOfArray()&&hb==ib;},unsubscribeSend:function(eb){na.unsubscribe(eb);},resendMessage:function(eb,fb){var gb=fa({},eb);gb.status=k.RESENDING;gb.timestamp=Date.now();gb.message_id=eb.message_id;this._messages[eb.message_id]=gb;var hb=sa(this,eb.thread_id);hb.resortResources([eb.message_id]);this.sendMessage(gb,null,fb);this._threadInformer.reorderedMessages(eb.thread_id,s.CLIENT_SEND_MESSAGE);},deleteMessages:function(eb,fb){if(fb.length){var gb=sa(this,eb),hb=gb.getCurrentArraySize()==fb.length&&gb.hasReachedEndOfArray();this._serverRequests.deleteMessages(eb,fb,hb);}},deleteLocalMessage:function(eb){if(this._localTitanMessagesCount[eb])this._localTitanMessagesCount[eb]--;},markMessagesSpam:function(eb,fb){if(fb.length){var gb=sa(this,eb),hb=gb.getCurrentArraySize()==fb.length&&gb.hasReachedEndOfArray();if(hb){this._serverRequests.markThreadSpam(eb);}else this._serverRequests.markMessagesSpam(eb,fb);}},updateLocalMessage:function(eb,fb){var gb=eb.message_id,hb=eb.client_message_id;this._localIdsMap[hb]=gb;this._messages[gb]=this._messages[hb];x.addServerID(hb,gb);this._messages[hb]={};var ib=ma(this,hb);if(eb.timestamp)ib.timestamp=eb.timestamp;if(eb.attachments&&eb.attachments.length){ib.raw_attachments=null;ib.attachments=eb.attachments;bb(this,ib,gb);}if(eb.log_message_data)ib.log_message_data=eb.log_message_data;if(za(ib))this._localTitanMessagesCount[ib.thread_id]--;},constructUserGeneratedMessageObject:function(eb,fb,gb,hb){var ib=pa(this,j.USER_GENERATED_MESSAGE,fb,gb);ib.body=eb;ib.has_attachment=false;ib.html_body=false;ib.attachments=[];ib.specific_to_list=hb||[];return ib;},constructLogMessageObject:function(eb,fb,gb,hb){var ib=pa(this,j.LOG_MESSAGE,eb,fb);ib.log_message_type=gb;ib.log_message_data=hb;return ib;},generateNewClientMessageID:function(eb){var fb=eb+':'+(ka(0,4294967295)+1)+'-'+z.getSessionID();return '<'+fb+'@mail.projektitan.com>';},getNumberLocalMessages:function(eb){return this._localTitanMessagesCount[eb]||0;},_uploadMessages:{},updateNewMessage:function(eb,fb,gb){if(gb.preview_attachments.length>0){eb.has_attachment=true;eb.preview_attachments=gb.preview_attachments;}eb.client_state=q.DO_NOT_SEND_TO_SERVER;eb.status=k.RESENDING;this._uploadMessages[fb]=eb;return eb;},updateMessageAfterUpload:function(eb,fb){var gb=this._uploadMessages[eb];ia(gb);gb.image_ids=fb.image_ids;gb.client_state=q.SEND_TO_SERVER;return gb;},clearUploadedMessage:function(eb){delete this._uploadMessages[eb];}});fa(va,u,{addAttachmentData:function(eb,fb,gb,hb){hb=hb||h.user;va.getForFBID(hb).addAttachmentData(eb,fb,gb);}});function wa(eb,fb){var gb=fb.map(ma.curry(eb));return gb.reverse();}function xa(eb,fb,gb){var hb=gb.filter(function(ib){return za(ma(eb,ib));});if(!eb._titanMessagesCount[fb])eb._titanMessagesCount[fb]=0;eb._titanMessagesCount[fb]+=hb.length;}function ya(eb,fb,gb){var hb=gb.filter(function(ib){return za(ma(eb,ib));});if(!eb._localTitanMessagesCount[fb])eb._localTitanMessagesCount[fb]=0;eb._localTitanMessagesCount[fb]+=hb.length;}function za(eb){var fb=eb.action_type;if(fb==j.USER_GENERATED_MESSAGE)return true;switch(eb.log_message_type){case p.SUBSCRIBE:case p.UNSUBSCRIBE:case p.SERVER_ERROR:case p.LIVE_LISTEN:return false;default:return true;}}function ab(eb){switch(eb){case v.CHAT_WEB:case v.CHAT_JABBER:case v.CHAT_IPHONE:case v.CHAT_MEEBO:case v.CHAT_ORCA:case v.CHAT_TEST:case v.CHAT:case v.DESKTOP:return true;default:return false;}}function bb(eb,fb,gb){gb=gb||fb.message_id;var hb=eb._attachmentData[gb];if(hb){hb.forEach(function(ib){var jb=fb.attachments.indexOf(ib.attach_key);if(jb!==-1)fb.attachments[jb]=ib.data;});delete eb._attachmentData[gb];}else if(!fb.is_forward&&cb(eb,fb)){eb._messagesNeedingAttachmentData[gb]=true;db(eb);}}function cb(eb,fb){if(!fb||!fb.attachments)return false;for(var gb=0;gb<fb.attachments.length;gb++){var hb=fb.attachments[gb];if(typeof hb==='string'&&hb.indexOf(m.SHARE)===0)return true;}var ib=fb.forward_message_ids||[];for(gb=0;gb<ib.length;gb++){var jb=ma(eb,ib[gb]);if(cb(eb,jb))return true;}return false;}var db=ga(function(eb){var fb={};for(var gb in eb._messagesNeedingAttachmentData){var hb=ma(eb,gb);if(cb(eb,hb))fb[gb]=true;}var ib=Object.keys(fb);if(ib.length){var jb={message_ids:ib};if(eb._fbid!=h.user)jb.request_user_id=eb._fbid;new g('/ajax/mercury/attachments/fetch_shares.php').setData(jb).setAllowCrossPageTransition(true).send();}eb._messagesNeedingAttachmentData={};},0,this);e.exports=va;});
__d("TooltipLink.react",["React","ReactPropTypes","Tooltip","ReactComponent","DOM"],function(a,b,c,d,e,f){var g=b('React'),h=b('ReactPropTypes'),i=b('Tooltip'),j=b('ReactComponent'),k=b('DOM'),l=g.createClass({displayName:'TooltipLink',props:{tooltip:h.instanceOf(j).isRequired,position:h.oneOf(['above','below','left','right']),alignH:h.oneOf(['left','center','right'])},render:function(){return this.transferPropsTo(g.DOM.a({href:"#"},this.props.children));},componentDidMount:function(){var m=k.create('div');g.renderComponent(this.props.tooltip,m);i.set(this.getDOMNode(),m,this.props.position,this.props.alignH);}});e.exports=l;});
__d("MercuryMessageStatus.react",["arrayContains","cx","fbt","formatDate","getObjectValues","MercuryActionStatus","MercuryErrorInfo","MercuryIDs","MercuryMessages","MercuryMessageSourceTags","MercuryParticipants","MercuryThreads","React","ReactPropTypes","TooltipLink.react"],function(a,b,c,d,e,f){var g=b('arrayContains'),h=b('cx'),i=b('fbt'),j=b('formatDate'),k=b('getObjectValues'),l=b('MercuryActionStatus'),m=b('MercuryErrorInfo'),n=b('MercuryIDs'),o=b('MercuryMessages').get(),p=b('MercuryMessageSourceTags'),q=b('MercuryParticipants'),r=b('MercuryThreads').get(),s=b('React'),t=b('ReactPropTypes'),u=b('TooltipLink.react'),v=s.createClass({displayName:'MercuryMessageStatus',propTypes:{message:t.object.isRequired,showSentFrom:t.bool,seen:t.object},getInitialState:function(){return {seenUsers:[]};},componentWillMount:function(){this.seenUsersUpdate();},componentWillReceiveProps:function(){this.seenUsersUpdate();},seenUsersUpdate:function(){if(this.props.seen){var w=Object.keys(this.props.seen);q.getMulti(w,function(x){x=k(x);this.setState({seenUsers:x});}.bind(this));}},render:function(){var w=this._typeRenderer[this.getType()],x="_5frt"+' '+w.className,y=this.props.message,z=y.error_data;return this.transferPropsTo(s.DOM.div({className:x,tabIndex:m.isTransient(z)?0:null,onClick:m.isTransient(z)?this.messageResend:null},s.DOM.div({className:"_5ihg"}),s.DOM.span(null,w.text.call(this))));},getType:function(){var w=this.props.message,x=w.status,y=o.isInbound(w),z=n.isMultichat(w.thread_id),aa=this.props.showSentFrom;if(x===l.RESENDING){return 'resending';}else if(x===l.FAILED_UNKNOWN_REASON||x===l.UNABLE_TO_CONFIRM||x===l.ERROR){var ba=w.error_data,ca=m.isTransient(ba)?'Transient':'Permanent',da=m.isConnectionError(ba),ea=da?'Connection':'Generic';return 'error'+ea+ca;}else if(aa&&!z&&y){var fa=w.source_tags;if(w.location_text){return 'sentFromLocation';}else if(g(fa,p.MESSENGER)){return 'sentFromOrca';}else if(g(fa,p.MOBILE)){return 'sentFromMobile';}else if(g(fa,p.EMAIL)){return 'sentFromEmail';}else return 'none';}else if(!y&&this.state&&this.state.seenUsers.length){if(z){return 'seenBy';}else return 'seenAt';}else return 'none';},messageResend:function(){o.resendMessage(this.props.message);},_typeRenderer:{className:"_5fry",resending:{text:function(){return "Sending...";}},errorConnectionPermanent:{className:"_5fru _5frz _5ihh",text:function(){return "Unable to connect to Facebook. This message failed to send.";}},errorConnectionTransient:{className:"_5fru _5frz _5ihi",text:function(){return i._("{message} Check your network connection or click to try again.",[i.param("message",this._typeRenderer.errorConnectionPermanent.text.call(this))]);}},errorGenericPermanent:{className:"_5fru _5fr- _5ihh",text:function(){var w=this.props.message;if(w.error_data&&w.error_data.description){return w.error_data.description;}else return "This message failed to send.";}},errorGenericTransient:{className:"_5fru _5fr- _5ihi",text:function(){return i._("{message} Click to send again.",[i.param("message",this._typeRenderer.errorGenericPermanent.text.call(this))]);}},seenBy:{className:"_5ihj _5ihk",text:function(){var w=this.props.message,x=r.getThreadMetaNow(w.thread_id),y=x?x.participants.length:[],z=this.state.seenUsers;if(z.length===y.length){return "Seen by everyone";}else if(z.length===1){return i._("Seen by {user}",[i.param("user",z[0].short_name)]);}else if(z.length===2){return i._("Seen by {user1}, {user2}",[i.param("user1",z[0].short_name),i.param("user2",z[1].short_name)]);}else if(z.length===3){return i._("Seen by {user1}, {user2}, {user3},",[i.param("user1",z[0].short_name),i.param("user2",z[1].short_name),i.param("user3",z[2].short_name)]);}else{var aa=s.DOM.div(null,z.slice(2).map(function(ba){return s.DOM.div(null,ba.short_name);}));return i._("Seen by {user1}, {user2}, {more link}",[i.param("user1",z[0].short_name),i.param("user2",z[1].short_name),i.param("more link",u({tooltip:aa},i._("{num} more",[i.param("num",z.length-2)])))]);}}},seenAt:{className:"_5ihj _5ihl",text:function(){var w=this.props.seen[Object.keys(this.props.seen)[0]],x=j(w,{withinDay:'g:ia',withinWeek:'D g:ia',older:'M j'});return i._("Seen {timestamp}",[i.param("timestamp",x)]);}},sentFromLocation:{className:"_5ihm _5ihn",text:function(){var w=this.props.message;return i._("Sent from {location}",[i.param("location",w.location_text)]);}},sentFromMobile:{className:"_5ihm _5ihn",text:function(){return s.DOM.a({href:"/mobile",className:"fcg",target:"_blank"},"Sent from Mobile");}},sentFromOrca:{className:"_5ihm _5ihn",text:function(){return s.DOM.a({href:"/mobile/messenger",className:"fcg",target:"_blank"},"Sent from Messenger");}},sentFromEmail:{className:"_5ihm _5ihn _5iho",text:function(){return "Sent from email";}},none:{className:"_5frx",text:function(){}}}});e.exports=v;});
__d("MercuryAudioPlayer",["Event","Arbiter","DOM","Flash","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('DOM'),j=b('Flash'),k=b('copyProperties'),l=200;function m(){var v=i.create('audio'),w=false;try{if(!!v.canPlayType)if(v.canPlayType('video/mp4;').replace(/^no$/,''))w=true;}finally{return w;}}function n(){return j.isAvailable();}var o=function(){this.interval=null;this.arbiterInstance=null;this.audio=i.create('audio');g.listen(this.audio,'playing',function(){this.informAttachment('playing',this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment('playing',this.audio.currentTime);}.bind(this),l);}.bind(this));g.listen(this.audio,'ended',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};k(o.prototype,{setAudio:function(v,w){this.audio.setAttribute('src',v);this.arbiterInstance=w;},informAttachment:function(v,w){if(this.arbiterInstance)this.arbiterInstance.inform(v,w);},play:function(){this.audio.play();this.informAttachment('played');},resume:function(){this.audio.play();this.informAttachment('played');},pause:function(){this.audio.pause();clearInterval(this.interval);this.informAttachment('paused');},getType:function(){return 'html5';}});var p=function(){this.src=null;this.arbiterInstance=null;var v=i.create('div');document.body.appendChild(v);this.swf=j.embed('/swf/SoundStreamPlayer.swf',v,null,{});this.interval=null;h.subscribe('soundstream/finished',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};k(p.prototype,{setAudio:function(v,w){this.src=v;this.arbiterInstance=w;},informAttachment:function(v,w){if(this.arbiterInstance)this.arbiterInstance.inform(v,w);},play:function(){this.swf.playSound(this.src);this.interval=setInterval(function(){var v=this.swf.getCurrentTime();this.informAttachment('playing',v);}.bind(this),l);this.informAttachment('played');},resume:function(){this.swf.resume();this.informAttachment('played');},pause:function(){clearInterval(this.interval);this.swf.pause();this.informAttachment('paused');},getType:function(){return 'flash';}});function q(){if(m()){return new o();}else if(n())return new p();return false;}var r=null,s=null,t=0;function u(v,w){this.src=v;this.arbiterInstance=w;this.audio_id=++t;r!==null||(r=q());if(!r)return false;}k(u.prototype,{getType:function(){if(!r){return false;}else return r.getType();},play:function(v){if(v&&s==this.audio_id){r.resume();}else{this.pause();s=this.audio_id;r.setAudio(this.src,this.arbiterInstance);r.play();}},pause:function(){r.pause();}});e.exports=u;});
__d("MercuryAttachmentAudioClip.react",["Arbiter","ArbiterMixin","MercuryAudioPlayer","Env","JSLogger","LeftRight.react","React","cx","shield","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('MercuryAudioPlayer'),j=b('Env'),k=b('JSLogger'),l=b('LeftRight.react'),m=b('React'),n=b('cx'),o=b('shield'),p=b('tx'),q='MercuryAttachmentAudioClip/play',r=k.create('mercury_audio_clip'),s=m.createClass({displayName:'AudioClip',mixins:[h],getInitialState:function(){this.subscribe('playing',this.updateTime);this.subscribe('played',o(this.setState,this,{playing:true,started:true}));this.subscribe('paused',o(this.setState,this,{playing:false}));this.subscribe('finished',o(this.setState,this,{playing:false,started:false,time:this.props.duration}));this.logged=false;var t=this.props.downloadOnly?false:new i(this.props.src,this);g.subscribe(q,function(u,v){if(this.props.src!=v)this.setState({time:0});}.bind(this));return {time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:t};},updateTime:function(t,u){this.setState({time:u});},play:function(){if(this.state.playing){this.state.audioPlayer.pause();}else{this.state.audioPlayer.play(this.state.started);g.inform(q,this.props.src);if(!this.logged){this.logged=true;r.log('play',{uid:j.user,duration:this.props.duration});}}},_formatSeconds:function(t){if(t){t=Math.ceil(t);var u=t%60;if(u<10)u='0'+u;var v=Math.floor(t/60);return v+':'+u;}else return null;},_renderPlayer:function(t,u){return (m.DOM.a({className:"_1miz",style:{width:t},onClick:this.play},m.DOM.span({className:"_1mi-"},m.DOM.i({className:"_1mi_"})),m.DOM.span({className:"_1mj0"},u),m.DOM.div({className:"_1mj1"})));},render:function(){var t=this.state.time,u=this.state.playing,v=this._formatSeconds(this.state.duration),w=this.props.width||170,x=null,y=Math.ceil((t*(w+2))/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var z=this._renderPlayer(w,v),aa=this._renderPlayer(w,v),ba=(("_1mj2")+(u&&(t!==0)?' '+"_1mj3":'')+(u&&(t===0)?' '+"_4g4x":''));x=(m.DOM.div({className:ba},z,m.DOM.div({className:"_1mj4",style:{width:y}},aa)));}else x=(m.DOM.div({className:"_1mj2"},m.DOM.div({className:"_1miz"},l(null,m.DOM.a({className:"_1mj5",href:this.props.src},m.DOM.span({className:"_3qi6"},m.DOM.i({className:"_1mj6"})),m.DOM.span({className:"_1mj7"},"Voice Message"),m.DOM.span({className:"_1mj8"},v)),m.DOM.a({href:this.props.src,className:"_1mj9"},m.DOM.i({className:"_1mja"}))))));return (m.DOM.div({className:"_1mjb"},x));}});e.exports=s;});
__d("loadImage",[],function(a,b,c,d,e,f){"use strict";function g(h,i){var j=new Image();j.onload=function(){i(j.width,j.height,j);};j.src=h;}e.exports=g;});
__d("PixelzFocus",[],function(a,b,c,d,e,f){"use strict";var g={search:function(h,i){var j=0,k=h.length-1;while(j<=k){var l=j+Math.floor((k-j)/2),m=h[l];if(m>i){k=l-1;}else if(m<i){j=l+1;}else return l;}return Math.min(j,k);},forceSpecificPoint:function(h,i,j){var k=1e-09,l=g.search(h,i-j-k)+1,m=g.search(h,i+j);return h.slice(l,m+1);},findBiggestSets:function(h,i){var j=[],k=-1;for(var l=0;l<h.length;++l){var m=h[l],n=l,o=g.search(h,m+i),p=o-n;if(p>k)j=[];if(p>=k){k=p;j.push({low:n,high:o});}}return j;},getBestSet:function(h,i,j){var k=-1,l=null;for(var m=0;m<i.length;++m){var n=i[m],o=h[n.low],p=h[n.high],q=o+(p-o)/2,r=Math.min(o-(q-j),(q+j)-p);if(r>k){k=r;l=n;}}return l;},getFocusFromSet:function(h,i){var j=h[i.low],k=h[i.high];return j+(k-j)/2;},clampFocus:function(h,i){var j=i/2,k=1-(i/2);if(h<j)return j;if(h>k)return k;return h;},convertFromCenterToCSS:function(h,i){if(Math.abs(1-i)<1e-05)return 0;return (h-i/2)/(1-i);},convertFromCSSToCenter:function(h,i){return h*(1-i)+i/2;},getVisible:function(h,i){if(h<i)return h/i;return i/h;},getHidden:function(h,i){return 1-g.getVisible(h,i);},focusHorizontally:function(h,i){return h<i;},convertVectorFromCenterToCSS:function(h,i,j){var k=g.focusHorizontally(i,j),l;if(k){l=h.x/100;}else l=h.x/100;var m=g.convertFromCenterToCSS(l,g.getVisible(i,j));if(k){return {x:m,y:0};}else return {x:0,y:m};},getCropRect:function(h,i,j){var k=g.focusHorizontally(i,j),l=g.getVisible(i,j);if(k){var m=(1-l)*h.x;return {left:m,top:0,width:l,height:1};}else{var n=(1-l)*h.y;return {left:0,top:n,width:1,height:l};}}};e.exports=g;});
__d("Pixelz.react",["arrayContains","copyProperties","cx","invariant","loadImage","React","ReactPropTypes","PixelzFocus"],function(a,b,c,d,e,f){"use strict";var g=b('arrayContains'),h=b('copyProperties'),i=b('cx'),j=b('invariant'),k=b('loadImage'),l=b('React'),m=b('ReactPropTypes'),n=b('PixelzFocus'),o=l.createClass({displayName:'Pixelz',propTypes:{width:m.number,height:m.number,resizeMode:m.oneOf(['contain','cover','stretch']),alt:m.string,letterbox:m.bool,borderRadius:m.number,insetBorderColor:m.string,animated:m.bool,upscale:m.bool,cropRect:function(p,q,r){var s=p[q],t=('Invalid prop `'+q+'` supplied to `'+r+'`, expected a rectangle with values normalized '+'between 0 and 1');j(s.left>=0);j(s.top>=0);j(s.width>=0);j(s.height>=0);j(s.left+s.width<=1);j(s.top+s.height<=1);},focus:function(p,q,r){var s=p[q],t=('Invalid prop `'+q+'` supplied to `'+r+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1');if(Array.isArray(s)){for(var u=0;u<s.length;++u){j(s[u].x>=0&&s[u].x<=1);j(s[u].y>=0&&s[u].y<=1);}}else{if(!s.type)s.type='css';j(s.x>=0&&s.x<=1);j(s.y>=0&&s.y<=1);j(g(['center','css'],s.type));}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var p=this.props.src,q=this.state.srcDimensions[p];if(q)return q;k(p,function(r,s){var t={};t[p]={width:r,height:s};this.setState({srcDimensions:t});}.bind(this));return null;},getCropSrcDimensions:function(){var p=this.getSrcDimensions();return {width:p.width*this.props.cropRect.width,height:p.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var p=this.getCropSrcDimensions(),q=p.width/p.height,r=this.props.width/this.props.height;if(this.props.width&&this.props.height&&this.props.resizeMode==='stretch')return {width:this.props.width,height:this.props.height};if((!this.props.width&&this.props.height)||((this.props.resizeMode==='contain')!==(q>=r)))return {width:this.props.height*q,height:this.props.height};if(this.props.width)return {width:this.props.width,height:this.props.width/q};return p;},getCropDimensions:function(){var p=this.getUpscaleCropDimensions(),q=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(p.width,q.width),height:Math.min(p.height,q.height)};return p;},getCropAspectRatio:function(){var p=this.getCropDimensions();return p.width/p.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var p=this.getContainerDimensions();return p.width/p.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var p=this.props.focus;if(!Array.isArray(p)&&p.type==='css')return {x:p.x,y:p.y};var q=this.getContainerAspectRatio(),r=this.getCropAspectRatio(),s=n.getVisible(q,r),t=n.focusHorizontally(q,r),u;if(!Array.isArray(p)){u=n.convertFromCenterToCSS(t?p.x:p.y,s);}else{var v=p.map(function(y){return t?y.x:y.y;});v.sort();var w=n.findBiggestSets(v,s),x=n.getBestSet(v,w,s);u=n.getFocusFromSet(v,x);}return {x:t?u:.5,y:t?.5:u};},getCropPosition:function(){var p=this.getCropDimensions(),q=this.getContainerDimensions(),r=this.getFocus();return {left:r.x*(q.width-p.width),top:r.y*(q.height-p.height)};},getScaleDimensions:function(){var p=this.getCropDimensions();return {width:p.width/this.props.cropRect.width,height:p.height/this.props.cropRect.height};},getScalePosition:function(){var p=this.getScaleDimensions();return {left:-p.width*this.props.cropRect.left,top:-p.height*this.props.cropRect.top};},getClipCropRectangle:function(){var p=this.getContainerDimensions(),q=this.getCropDimensions(),r=this.getContainerPosition(),s=this.getCropPosition(),t=Math.max(r.left,s.left),u=Math.max(r.top,s.top),v=Math.min(r.top+p.height,s.top+q.height),w=Math.min(r.left+p.width,s.left+q.width);return {left:t,top:u,width:w-t,height:v-u};},getClipCropPosition:function(){var p=this.getClipCropRectangle();return {left:p.left,top:p.top};},getClipCropDimensions:function(){var p=this.getClipCropRectangle();return {width:p.width,height:p.height};},getClipScalePosition:function(){var p=this.getScalePosition(),q=this.getClipCropPosition(),r=this.getCropPosition();return {left:p.left+(r.left-q.left),top:p.top+(r.top-q.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(p,q){return p.width===q.width&&p.height===q.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var p=this.getContainerDimensions(),q=this.getClipCropDimensions(),r=this.getClipScaleDimensions();if(this.areDimensionsEqual(p,q)||this.areDimensionsEqual(q,r))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var p=this.getContainerDimensions(),q=this.getClipScaleDimensions();if(this.areDimensionsEqual(p,q))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(p,q){if(this.shouldAddAllNodesAndStyles()||q.left)p.left=Math.round(q.left);if(this.shouldAddAllNodesAndStyles()||q.top)p.top=Math.round(q.top);},applyDimensionsStyle:function(p,q){p.width=Math.round(q.width);p.height=Math.round(q.height);},applyBorderRadiusStyle:function(p){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)p.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var p={},q=this.getClipCropDimensions(),r=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(q,r)){this.applyPositionStyle(p,this.getClipScalePosition());}else this.applyPositionStyle(p,this.getClipCropPosition());this.applyDimensionsStyle(p,this.getClipScaleDimensions());this.applyBorderRadiusStyle(p);return p;},getCropStyle:function(){var p={};this.applyPositionStyle(p,this.getClipCropPosition());this.applyDimensionsStyle(p,this.getClipCropDimensions());this.applyBorderRadiusStyle(p);return p;},getInsetBorderStyle:function(){var p={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(p,this.getClipCropPosition());this.applyDimensionsStyle(p,this.getClipCropDimensions());this.applyBorderRadiusStyle(p);return p;},getContainerStyle:function(){var p={};this.applyDimensionsStyle(p,this.getContainerDimensions());this.applyBorderRadiusStyle(p);return p;},getScale:function(){var p=this.getScaleStyle(),q=p.width,r=p.height;p=h({},p);delete p.width;delete p.height;return this.transferPropsTo(l.DOM.img({alt:this.props.alt,className:(("_56wb")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),src:this.props.src,style:p,width:q,height:r}));},getCrop:function(){var p=this.getScale();if(!this.hasCrop())return p;return (l.DOM.div({className:(("_56ma")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getCropStyle()},p));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (l.DOM.div({className:(("_56lv")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getInsetBorderStyle()}));},getContainer:function(){var p=this.getCrop();if(!this.hasContainer())return p;var q=this.getInsetBorder();return (l.DOM.div({className:(("_56jj")+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),style:this.getContainerStyle()},p,q));},render:function(){var p=this.getSrcDimensions();if(!p)return l.DOM.span(null);return this.getContainer();}});e.exports=o;});
__d("ReactLayer",["React","ReactComponent","ReactEventEmitter","ReactMount","emptyFunction","getObjectValues","invariant","merge","mixInto"],function(a,b,c,d,e,f){"use strict";var g=b('React'),h=b('ReactComponent'),i=b('ReactEventEmitter'),j=b('ReactMount'),k=b('emptyFunction'),l=b('getObjectValues'),m=b('invariant'),n=b('merge'),o=b('mixInto'),p={immutableProps:{},getDefaultEnabledBehaviors:function(){return {};},createLayer:null,receiveProps:null,mountComponent:function(t,u,v){h.Mixin.mountComponent.call(this,t,u,v);this.reactContent=this.wrapReactContent(this.props.children);return this.reactContent.mountComponent(t,u,v);},unmountComponent:function(){h.Mixin.unmountComponent.call(this);this.reactContent.unmountComponent();this.reactContent=null;},mountLayer:function(){if(this.constructor.propTypes)this._assertValidProps(this.props);this.container=document.createElement('div');j.renderComponent(this,this.container);this.layer=this.createLayer(this.container);m(this.layer);this.layerSubscriptions=[];this.layerSubscribe(['show','hide'],function(t){this.props.onToggle&&this.props.onToggle(t==='show');}.bind(this));},setProps:function(t){this.replaceProps(n(this.props,t));},replaceProps:function(t){if(this.constructor.propTypes)this._assertValidProps(t);var u;for(u in this.immutableProps)m(this.props[u]===t[u]);var v=this.reactContent,w=this.wrapReactContent(t.children);v.replaceProps(w.props);this.receiveProps(t);this.props=t;},enumerateBehaviors:function(t){t=this.getEffectiveBehaviors(t);return l(t).filter(k.thatReturnsArgument);},updateBehaviors:function(t){var u=this.getEffectiveBehaviors(this.props.behaviors),v=this.getEffectiveBehaviors(t),w;for(w in u)if(!v[w])this.layer.disableBehavior(u[w]);for(w in v){var x=u[w],y=v[w];if(x&&y){m(x===y);continue;}x&&this.layer.disableBehavior(x);y&&this.layer.enableBehavior(y);}},getEffectiveBehaviors:function(t){return n(this.getDefaultEnabledBehaviors(),t);},unmountLayer:function(){this.unmountComponent();this.layer.destroy();this.layer=null;this.container.innerHTML='';while(this.layerSubscriptions.length)this.layerSubscriptions.pop().unsubscribe();},layerSubscribe:function(t,u){this.layerSubscriptions.push(this.layer.subscribe(t,function(v,w){i.isEnabled()&&u(v,w);}));},getNodeForOwnerRef:function(t){var u=this.getSiblingByRef(t);return u&&u.getDOMNode();},wrapReactContent:function(t){return g.DOM.div(null,t);},_assertValidProps:function(t){var u=this.constructor.displayName,v=this.constructor.propTypes;for(var w in v){var x=v[w];if(x)x(t,w,u);}}},q={displayName:function(t,u){t.displayName=u;},mixins:function(t,u){if(u)for(var v=0;v<u.length;v++)r(t,u[v]);},propTypes:function(t,u){t.propTypes=u;}};function r(t,u){var v=t.prototype;for(var w in u)if(u.hasOwnProperty(w)){var x=u[w];if(q.hasOwnProperty(w)){q[w](t,x);}else v[w]=x;}}var s={createClass:function(t){var u=function(){};o(u,h.Mixin);o(u,p);r(u,t);var v=function(w,x){var y=new u();y.construct.apply(y,arguments);return y;};v.componentConstructor=u;v.originalSpec=t;return v;}};e.exports=s;});
__d("Spotlight.react",["LayerHideOnBlur","LayerHideOnEscape","ReactLayer","Spotlight"],function(a,b,c,d,e,f){var g=b('LayerHideOnBlur'),h=b('LayerHideOnEscape'),i=b('ReactLayer'),j=b('Spotlight'),k=i.createClass({getDefaultEnabledBehaviors:function(){return {hideOnBlur:g,hideOnEscape:h};},createLayer:function(l){var m=this.enumerateBehaviors(this.props.behaviors),n={addedBehaviors:m},o=new j(n,l);o.conditionShow(this.props.shown);if(this.props.onHide)o.subscribe('hide',this.props.onHide);return o;},receiveProps:function(l){this.layer.conditionShow(l.shown);}});e.exports=k;});
__d("MessagesEmoticons.react",["Grid.react","React","cx","fbt"],function(a,b,c,d,e,f){var g=b('Grid.react'),h=b('React'),i=b('cx'),j=b('fbt'),k=g.GridItem,l={smile:"smile",frown:"frown",tongue:"tongue",grin:"grin",gasp:"gasp",wink:"wink",pacman:"pacman",grumpy:"grumpy",unsure:"unsure",cry:"cry",kiki:"kiki",glasses:"glasses",sunglasses:"sunglasses",heart:"heart",devil:"devil",angel:"angel",squint:"squint",confused:"confused",upset:"upset",colonthree:"colonthree",like:"like"},m=h.createClass({displayName:'MessagesEmoticons',getEmoticons:function(){var n=Object.keys(l).map(function(o){return (k(null,h.DOM.div({className:"panelCell"},h.DOM.a({'aria-label':l.emoticon,className:'emoticon emoticon_'+o}))));});return n;},render:function(){return (h.DOM.div({className:"emoticonsTable"},g({cols:7,alignv:"middle",alignh:"center",spacing:"pam"},this.getEmoticons())));}});e.exports=m;});
__d("DialogFitHeight",["CSS","DOM","Event","Style","SubscriptionsHandler","Vector","csx","cx","throttle"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('Style'),k=b('SubscriptionsHandler'),l=b('Vector'),m=b('csx'),n=b('cx'),o=b('throttle'),p=450,q=100,r=67,s=67;function t(u){"use strict";this.$DialogFitHeight0=u;}t.prototype.enable=function(){"use strict";this.$DialogFitHeight1=new k();this.$DialogFitHeight1.addSubscriptions(this.$DialogFitHeight0.subscribe('beforeshow',this.$DialogFitHeight2.bind(this)),i.listen(window,'resize',o(this.$DialogFitHeight2.bind(this))));this.$DialogFitHeight3=h.find(this.$DialogFitHeight0.getRoot(),"._4-i2");g.addClass(this.$DialogFitHeight3,"_5pfh");this.$DialogFitHeight4=q;if(h.scry(this.$DialogFitHeight0.getRoot(),"._4-i0").length)this.$DialogFitHeight4+=r;if(h.scry(this.$DialogFitHeight0.getRoot(),"._5a8u").length)this.$DialogFitHeight4+=s;};t.prototype.disable=function(){"use strict";this.$DialogFitHeight1.release();this.$DialogFitHeight1=null;g.removeClass(this.$DialogFitHeight3,"_5pfh");};t.prototype.$DialogFitHeight2=function(){"use strict";var u=l.getViewportDimensions().y,v=u-this.$DialogFitHeight4;j.set(this.$DialogFitHeight3,'height',Math.max(p,v)+'px');this.$DialogFitHeight0.updatePosition();};e.exports=t;});
__d("ReactLayeredComponentMixin",["ReactCurrentOwner"],function(a,b,c,d,e,f){"use strict";var g=b('ReactCurrentOwner'),h={componentWillMount:function(){this._renderedLayers={};},componentDidMount:function(){this._updateLayers();},componentDidUpdate:function(){this._updateLayers();},componentWillUnmount:function(){var i=this._renderedLayers;for(var j in i)if(i.hasOwnProperty(j)){i[j]&&i[j].unmountLayer();delete this._renderedLayers[j];}delete this._renderedLayers;},_updateLayers:function(){var i=this._renderedLayers;g.current=this;var j=this.renderLayers()||{};g.current=null;var k;for(k in j){var l=j[k];if(l&&j.hasOwnProperty(k)){var m=i.hasOwnProperty(k)?i[k]:null;if(m&&m.constructor===l.constructor){m.replaceProps(l.props);}else{if(m)m.unmountLayer();l.mountLayer();this._renderedLayers[k]=l;}}}for(k in i)if(i.hasOwnProperty(k)&&(!j.hasOwnProperty(k)||!j[k])){i[k]&&i[k].unmountLayer();delete this._renderedLayers[k];}}};e.exports=h;});
__d("XUIText.react",["React","cx"],function(a,b,c,d,e,f){var g=b('React'),h=g.PropTypes,i=b('cx'),j=g.createClass({displayName:'XUIText',propTypes:{size:h.oneOf(['small','medium','large','xlarge','inherit']),weight:h.oneOf(['bold','inherit','normal']),display:h.oneOf(['inline','block'])},getDefaultProps:function(){return {size:'inherit',weight:'inherit',display:'inline'};},render:function(){var k=this.props.size,l=this.props.weight,m=((k==='small'?"_50f3":'')+(k==='medium'?' '+"_50f4":'')+(k==='large'?' '+"_50f5":'')+(k==='xlarge'?' '+"_50f6":'')+(l==='bold'?' '+"_50f7":'')+(l==='normal'?' '+"_5kx5":''));if(this.props.display==='block')return this.transferPropsTo(g.DOM.div({className:m},this.props.children));return this.transferPropsTo(g.DOM.span({className:m},this.props.children));}});e.exports=j;});
__d("StickerStoreHeader.react",["InlineBlock.react","React","Image.react","XUICloseButton.react","XUIText.react","cx","fbt","ix"],function(a,b,c,d,e,f){var g=b('InlineBlock.react'),h=b('React'),i=b('Image.react'),j=b('XUICloseButton.react'),k=b('XUIText.react'),l=b('cx'),m=b('fbt'),n=b('ix'),o=h.createClass({displayName:'StickerStoreHeader',render:function(){return (h.DOM.div({className:"_5r5i"},h.DOM.div({className:"_5r5f"},i({className:"_5r5j",src:n('/images/messaging/stickers/store/characters.png')}),g({alignv:"middle",height:192},h.DOM.div({className:"_5r5l ellipsis"},i({className:"_5r5n",src:n('/images/messaging/stickers/store/basket.png')}),"Sticker Store"),k({className:"_5r5m",size:"large"},"Find new stickers to send to friends."))),this.renderCloseButton()));},renderCloseButton:function(){if(this.props.isPermalink)return null;return (j({className:"layerCancel _5r5k"}));}});e.exports=o;});
__d("XStickerStateInitialDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/state\/",{});});
__d("XStickerStatePackDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});});
__d("XStickerStateStoreDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/state\/store\/",{});});
__d("StickerState",["Arbiter","AsyncRequest","deferred","XStickerStateInitialDataControllerURIBuilder","XStickerStatePackDataControllerURIBuilder","XStickerStateStoreDataControllerURIBuilder","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('deferred').Deferred,j=b('XStickerStateInitialDataControllerURIBuilder'),k=b('XStickerStatePackDataControllerURIBuilder'),l=b('XStickerStateStoreDataControllerURIBuilder'),m=b('copyProperties'),n={},o,p,q={},r=[],s=[],t={onTrayDataReady:function(z){!p&&u();p.addCallback(z);},onStoreDataReady:function(z){!o&&v();o.addCallback(z);},onPackDataReady:function(z,aa){!n[z]&&w(z);n[z].addCallback(aa);},getPacksInTray:function(){return r;},getPackIDsInTray:function(){return r.map(function(z){return z.id;});},getPacksInStore:function(){return s;},getPack:function(z){return q[z];},addPack:function(z){y(z);q[z.id].isPurchased=true;q[z.id].isInTray=true;r.unshift(q[z.id]);g.inform(this.PACKS_CHANGED);},removePack:function(z){r=r.filter(function(aa){return aa.id!==z;});q[z].isInTray=false;g.inform(this.PACKS_CHANGED);}};t.PACKS_CHANGED='StickerState/packsChanged';function u(){p=x(new j().getURI(),function(z){r=z.packs.map(function(aa){return y(aa);});});}function v(){o=x(new l().getURI(),function(z){s=z.packs.map(function(aa){return y(aa);});});}function w(z){n[z]=x(new k().setInt('pack_id',z).getURI(),function(aa){y(aa);});}function x(z,aa){var ba=new i();new h(z).setHandler(function(ca){aa(ca.payload);ba.succeed();}).send();return ba;}function y(z){var aa=z.id;if(!q[aa]){return (q[aa]=z);}else return m(q[aa],z);}e.exports=t;});
__d("XStickersRemovePackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/removepack\/",{size:{type:"String"},pack_id:{type:"Int",required:true},react:{type:"Bool"}});});
__d("StickerStorePurchaseButton.react",["Arbiter","React","ReactPropTypes","StickerState","XUIButton.react","XStickersAddPackControllerURIBuilder","XStickersRemovePackControllerURIBuilder","cx","fbt"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('React'),i=b('ReactPropTypes'),j=b('StickerState'),k=b('XUIButton.react'),l=b('XStickersAddPackControllerURIBuilder'),m=b('XStickersRemovePackControllerURIBuilder'),n=b('cx'),o=b('fbt'),p=h.createClass({displayName:'StickerStorePurchaseButton',propTypes:{size:i.string,stickerPack:i.object.isRequired},getDefaultProps:function(){return {size:'medium'};},getInitialState:function(){return this.calculateState();},componentDidMount:function(){this.subscription=g.subscribe(j.PACKS_CHANGED,function(){this.isMounted()&&this.setState(this.calculateState());}.bind(this));},componentWillUnmount:function(){this.subscription&&g.unsubscribe(this.subscription);},render:function(){return (k({ajaxify:this.state.ajaxify.toString(),className:"_5r5d",href:"#",label:this.state.label,tooltip:this.state.tooltip,size:this.props.size,rel:"async-post",use:this.state.use}));},calculateState:function(){return {ajaxify:this.getAjaxify(),label:this.getLabel(),tooltip:this.getTooltip(),use:this.getUse()};},getAjaxify:function(){var q=this.props.stickerPack.isInTray?new m():new l();return (q.setInt('pack_id',this.props.stickerPack.id).setString('size',this.props.size).setBool('react',true).getURI());},getLabel:function(){if(this.props.stickerPack.isInTray){return ("Remove");}else if(this.props.stickerPack.isPurchased){return ("Add");}else return ("Free");},getTooltip:function(){if(!this.props.stickerPack.isInTray)return null;return ("Remove from your sticker packs.");},getUse:function(){return this.props.stickerPack.isInTray?'default':'special';}});e.exports=p;});
__d("BoundingDimensions",["PooledClass"],function(a,b,c,d,e,f){"use strict";var g=b('PooledClass'),h=g.twoArgumentPooler;function i(j,k){this.width=j;this.height=k;}i.getPooledFromElement=function(j){return i.getPooled(j.offsetWidth,j.offsetHeight);};g.addPoolingTo(i,h);e.exports=i;});
__d("Position",["PooledClass"],function(a,b,c,d,e,f){"use strict";var g=b('PooledClass'),h=g.twoArgumentPooler;function i(j,k){this.left=j;this.top=k;}g.addPoolingTo(i,h);e.exports=i;});
__d("TouchEventUtils",[],function(a,b,c,d,e,f){var g={extractSingleTouch:function(h){var i=h.touches,j=h.changedTouches,k=i&&i.length>0,l=j&&j.length>0;return !k&&l?j[0]:k?i[0]:h;}};e.exports=g;});
__d("Touchable",["BoundingDimensions","Position","TouchEventUtils","invariant","keyMirror"],function(a,b,c,d,e,f){"use strict";var g=b('BoundingDimensions'),h=b('Position'),i=b('TouchEventUtils'),j=b('invariant'),k=b('keyMirror'),l=k({NOT_RESPONDER:null,RESPONDER_INACTIVE_PRESS_IN:null,RESPONDER_INACTIVE_PRESS_OUT:null,RESPONDER_ACTIVE_PRESS_IN:null,RESPONDER_ACTIVE_PRESS_OUT:null,ERROR:null}),m={RESPONDER_ACTIVE_PRESS_OUT:true,RESPONDER_ACTIVE_PRESS_IN:true},n={RESPONDER_INACTIVE_PRESS_IN:true,RESPONDER_ACTIVE_PRESS_IN:true},o=k({DELAY:null,RESPONDER_GRANT:null,RESPONDER_RELEASE:null,RESPONDER_TERMINATED:null,ENTER_PRESS_RECT:null,LEAVE_PRESS_RECT:null}),p={NOT_RESPONDER:{DELAY:l.ERROR,RESPONDER_GRANT:l.RESPONDER_INACTIVE_PRESS_IN,RESPONDER_RELEASE:l.ERROR,RESPONDER_TERMINATED:l.ERROR,ENTER_PRESS_RECT:l.ERROR,LEAVE_PRESS_RECT:l.ERROR},RESPONDER_INACTIVE_PRESS_IN:{DELAY:l.RESPONDER_ACTIVE_PRESS_IN,RESPONDER_GRANT:l.ERROR,RESPONDER_RELEASE:l.NOT_RESPONDER,RESPONDER_TERMINATED:l.NOT_RESPONDER,ENTER_PRESS_RECT:l.RESPONDER_INACTIVE_PRESS_IN,LEAVE_PRESS_RECT:l.RESPONDER_INACTIVE_PRESS_OUT},RESPONDER_INACTIVE_PRESS_OUT:{DELAY:l.RESPONDER_ACTIVE_PRESS_OUT,RESPONDER_GRANT:l.ERROR,RESPONDER_RELEASE:l.NOT_RESPONDER,RESPONDER_TERMINATED:l.NOT_RESPONDER,ENTER_PRESS_RECT:l.RESPONDER_INACTIVE_PRESS_IN,LEAVE_PRESS_RECT:l.RESPONDER_INACTIVE_PRESS_OUT},RESPONDER_ACTIVE_PRESS_IN:{DELAY:l.ERROR,RESPONDER_GRANT:l.ERROR,RESPONDER_RELEASE:l.NOT_RESPONDER,RESPONDER_TERMINATED:l.NOT_RESPONDER,ENTER_PRESS_RECT:l.RESPONDER_ACTIVE_PRESS_IN,LEAVE_PRESS_RECT:l.RESPONDER_ACTIVE_PRESS_OUT},RESPONDER_ACTIVE_PRESS_OUT:{DELAY:l.ERROR,RESPONDER_GRANT:l.ERROR,RESPONDER_RELEASE:l.NOT_RESPONDER,RESPONDER_TERMINATED:l.NOT_RESPONDER,ENTER_PRESS_RECT:l.RESPONDER_ACTIVE_PRESS_IN,LEAVE_PRESS_RECT:l.RESPONDER_ACTIVE_PRESS_OUT},error:{DELAY:l.NOT_RESPONDER,RESPONDER_GRANT:l.RESPONDER_INACTIVE_PRESS_IN,RESPONDER_RELEASE:l.NOT_RESPONDER,RESPONDER_TERMINATED:l.NOT_RESPONDER,ENTER_PRESS_RECT:l.NOT_RESPONDER,LEAVE_PRESS_RECT:l.NOT_RESPONDER}},q=130,r=20,s={touchableResponderDidGrant:function(){if(!this.state)this.state={};this.state.touchState=l.NOT_RESPONDER;this._receiveSignal(o.RESPONDER_GRANT);this.timeout=window.setTimeout(this._onDelay,q);},touchableResponderDidRelease:function(){this._receiveSignal(o.RESPONDER_RELEASE);},touchableResponderDidTerminate:function(){this._receiveSignal(o.RESPONDER_TERMINATED);},touchableResponderDidMove:function(u){if(this.state.touchState===l.RESPONDER_INACTIVE_PRESS_IN)return;var v=this.state.globalPositionOnActivate,w=this.state.dimensionsOnActivate,x=this.props.pressExpandLeft||r,y=this.props.pressExpandRight||r,z=this.props.pressExpandTop||r,aa=this.props.pressExpandBottom||r,ba=i.extractSingleTouch(u),ca=ba&&ba.pageX,da=ba&&ba.pageY,ea=ca>v.left-x&&da>v.top-z&&ca<v.left+w.width+y&&da<v.top+w.height+aa;if(ea){this._receiveSignal(o.ENTER_PRESS_RECT);}else this._receiveSignal(o.LEAVE_PRESS_RECT);},_remeasureMetricsOnActivation:function(){var u=this.getHitRectNode?this.getHitRectNode():this.getDOMNode(),v=u.getBoundingClientRect(),w=window.pageXOffset,x=window.pageYOffset,y=v.left+w,z=v.top+x;this.state.globalPositionOnActivate&&h.release(this.state.globalPositionOnActivate);this.state.globalPositionOnActivate=h.getPooled(y,z);this.state.dimensionsOnActivate&&g.release(this.state.dimensionsOnActivate);this.state.dimensionsOnActivate=g.getPooled(v.width,v.height);},_onDelay:function(){this._receiveSignal(o.DELAY);},_receiveSignal:function(u){var v=this.state.touchState;j(p[v]&&p[v][u]);var w=p[v][u];j(w!==l.ERROR);if(v!==w){this._performSideEffectsForTransition(v,w,u);this.state.touchState=w;}},_performSideEffectsForTransition:function(u,v,w){var x=u===l.RESPONDER_ACTIVE_PRESS_IN,y=v===l.RESPONDER_ACTIVE_PRESS_IN;if(!m[u]&&m[v])this._remeasureMetricsOnActivation();if(y&&!x){this.activePressInTouchable&&this.activePressInTouchable();}else if(!y&&x)this.activePressOutTouchable&&this.activePressOutTouchable();if(n[u]&&w===o.RESPONDER_RELEASE)this.selectTouchable&&this.selectTouchable();this.timeout&&window.clearTimeout(this.timeout);this.timeout=null;}},t={mixin:s};e.exports=t;});
__d("XUIBlock",["ReactPropTypes","cx"],function(a,b,c,d,e,f){var g=b('ReactPropTypes'),h=b('cx'),i={propTypes:{background:g.oneOf(['base-wash','light-wash','white','highlight','transparent'])},getDefaultProps:function(){return {background:'transparent'};},getBackgroundClass:function(j){var k=((j.background==='base-wash'?"_4-u5":'')+(j.background==='light-wash'?' '+"_57d8":'')+(j.background==='white'?' '+"_4-u8":'')+(j.background==='highlight'?' '+"_4-u7":''));return k;}};e.exports=i;});
__d("XUICard.react",["React","Touchable","XUIBlock","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f){var g=b('React'),h=b('Touchable'),i=b('XUIBlock'),j=b('cx'),k=b('emptyFunction'),l=b('joinClasses'),m=g.createClass({displayName:'XUICard',propTypes:i.propTypes,getDefaultProps:i.getDefaultProps,render:function(){var p=l("_4-u2",i.getBackgroundClass(this.props));return this.transferPropsTo(g.DOM.div({className:p},this.props.children));}});m.Section=g.createClass({propTypes:i.propTypes,getDefaultProps:i.getDefaultProps,render:function(){var p=l("_4-u3",i.getBackgroundClass(this.props));return this.transferPropsTo(g.DOM.div({className:p},this.props.children));}});var n=m.Section;m.FullBleedSection=g.createClass({propTypes:i.propTypes,getDefaultProps:i.getDefaultProps,render:function(){return this.transferPropsTo(n({className:"_57u_"},this.props.children));}});var o=m.FullBleedSection;m.TouchSection=g.createClass({mixins:[h.mixin],propTypes:i.propTypes,getDefaultProps:i.getDefaultProps,getInitialState:function(){return {isHighlighted:false};},activePressInTouchable:function(){this.setState({isHighlighted:true});},activePressOutTouchable:function(){this.setState({isHighlighted:false});},selectTouchable:function(){this.activePressInTouchable();setTimeout(this.activePressOutTouchable,120);this.props.onTap&&this.props.onTap();},render:function(){var p=this.state.isHighlighted?this.props.highlightClassName:'',q=this.state.isHighlighted?this.props.highlightBackground:this.props.baseBackground;return this.transferPropsTo(n({className:p,background:q,onResponderGrant:this.touchableResponderDidGrant,onResponderMove:this.touchableResponderDidMove,onResponderRelease:this.touchableResponderDidRelease,onResponderTerminate:this.touchableResponderDidTerminate,onStartShouldSetResponder:k.thatReturnsTrue},this.props.children));}});m.PhotoSection=g.createClass({propTypes:i.propTypes,getDefaultProps:i.getDefaultProps,render:function(){return this.transferPropsTo(o({className:"_4-u4"},this.props.children));}});e.exports=m;});
__d("XUIGrayText.react",["React","XUIText.react","cx"],function(a,b,c,d,e,f){var g=b('React'),h=g.PropTypes,i=b('XUIText.react'),j=b('cx'),k=g.createClass({displayName:'XUIGrayText',propTypes:{shade:h.oneOf(['light','dark'])},getDefaultProps:function(){return {shade:'light'};},render:function(){var l=((this.props.shade==='light'?"_50f8":'')+(this.props.shade==='dark'?' '+"_50f9":''));return this.transferPropsTo(i({className:l},this.props.children));}});e.exports=k;});
__d("StickerStorePackDetail.react",["BanzaiLogger","ImageBlock.react","React","Image.react","ReactPropTypes","StickerState","StickerStorePurchaseButton.react","XUICard.react","XUIGrayText.react","XUISpinner.react","XUIText.react","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('BanzaiLogger'),h=b('ImageBlock.react'),i=b('React'),j=b('Image.react'),k=b('ReactPropTypes'),l=b('StickerState'),m=b('StickerStorePurchaseButton.react'),n=b('XUICard.react'),o=b('XUIGrayText.react'),p=b('XUISpinner.react'),q=b('XUIText.react'),r=b('cx'),s=b('emptyFunction'),t=i.createClass({displayName:'StickerStorePackDetail',propTypes:{packID:k.number.isRequired},getDefaultProps:function(){return {onDataReady:s};},getInitialState:function(){return {stickerPack:null};},componentDidMount:function(){l.onPackDataReady(this.props.packID,function(){this.isMounted()&&this.setState({stickerPack:l.getPack(this.props.packID)});this.props.onDataReady();}.bind(this));g.log('StickersLoggerConfig',{event:'open_pack_details',packid:this.props.packID});},render:function(){if(!this.state.stickerPack)return (i.DOM.div({className:"_5r5e"},p({size:"large"})));return (i.DOM.div({className:"pvm"},h({className:"_5ra6",spacing:"none"},j({className:"_5ra5 _5r5s",src:this.state.stickerPack.profileImage}),this.renderMetadata()),n({className:"pam _5ra7"},j({className:"_5ra8",src:this.state.stickerPack.previewImage}),this.renderCopyright())));},renderMetadata:function(){return (i.DOM.div({className:"mtm"},q({className:"_5raa",display:"block",weight:"bold"},this.state.stickerPack.name),i.DOM.div({className:"_5rac"},this.state.stickerPack.artist),i.DOM.div({className:"_5rab"},this.state.stickerPack.description),m({size:"large",stickerPack:this.state.stickerPack})));},renderCopyright:function(){return (i.DOM.div(null,this.state.stickerPack.copyrightLines.map(function(u){return (o({key:u,className:"_5ra9",display:"block"},u));})));}});e.exports=t;});
__d("XStickerPackPermalinkControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/{pack_id}\/",{pack_id:{type:"Int",required:true}});});
__d("StickerStorePack.react",["FlexibleBlock.react","LeftRight.react","Link.react","React","Image.react","ReactPropTypes","StickerStorePurchaseButton.react","XUIButton.react","XUICard.react","XUIText.react","XStickerPackPermalinkControllerURIBuilder","cx","fbt"],function(a,b,c,d,e,f){var g=b('FlexibleBlock.react'),h=b('LeftRight.react'),i=b('Link.react'),j=b('React'),k=b('Image.react'),l=b('ReactPropTypes'),m=b('StickerStorePurchaseButton.react'),n=b('XUIButton.react'),o=b('XUICard.react'),p=b('XUIText.react'),q=b('XStickerPackPermalinkControllerURIBuilder'),r=b('cx'),s=b('fbt'),t="Preview",u=j.createClass({displayName:'StickerStorePack',propTypes:{stickerPack:l.object.isRequired,onPackSelect:l.func},render:function(){return (o({className:"_5r9y"},i({className:"_5r5d",href:this.getPreviewURI(),onClick:this.onPreviewLinkClicked},this.renderPreviews()),g({className:"_5rah",flex:"left"},this.renderTitleAndArtist(),this.renderActionButtons())));},renderPreviews:function(){return (h(null,j.DOM.div({className:"_5rad"},k({className:"_5r5s",src:this.props.stickerPack.thumbnail||''})),j.DOM.div({className:"_5rae"},this.renderSmallPreviews())));},renderSmallPreviews:function(){return this.props.stickerPack.previews.map(function(v){return (j.DOM.div({key:v,className:"_5raf"},k({className:"_5rag",src:v})));});},renderTitleAndArtist:function(){return (j.DOM.div(null,p({className:"_5rai ellipsis",display:"block",weight:"bold"},this.props.stickerPack.name),j.DOM.div({className:"_5raj ellipsis"},this.props.stickerPack.artist,"  ")));},renderActionButtons:function(){return (j.DOM.div({className:"_5rr1"},n({className:"_5r5d",href:this.getPreviewURI(),label:t,onClick:this.onPreviewLinkClicked}),m({stickerPack:this.props.stickerPack})));},getPreviewURI:function(){return !!this.props.onPackSelect?'#':new q().setInt('pack_id',this.props.stickerPack.id).getURI();},onPreviewLinkClicked:function(){this.props.onPackSelect&&this.props.onPackSelect(this.props.stickerPack.id);}});e.exports=u;});
__d("StickerStorePackList.react",["React","StickerState","StickerStorePack.react","XUISpinner.react","cx","emptyFunction"],function(a,b,c,d,e,f){var g=b('React'),h=b('StickerState'),i=b('StickerStorePack.react'),j=b('XUISpinner.react'),k=b('cx'),l=b('emptyFunction'),m=g.createClass({displayName:'StickerStorePackList',getDefaultProps:function(){return {onDataReady:l};},getInitialState:function(){return {dataReady:false};},componentDidMount:function(){h.onStoreDataReady(function(){this.isMounted()&&this.setState({dataReady:true});this.props.onDataReady();}.bind(this));},render:function(){return (g.DOM.div({className:"clearfix _5r5r"},this.renderPacks()));},renderPacks:function(){if(!this.state.dataReady)return (g.DOM.div({className:"_5r5e"},j({size:"large"})));return h.getPacksInStore().map(function(n){return (i({key:n.id,stickerPack:n,onPackSelect:this.props.onPackSelect}));}.bind(this));}});e.exports=m;});
__d("XUIDialogBody.react",["ReactPropTypes","React","cx"],function(a,b,c,d,e,f){var g=b('ReactPropTypes'),h=b('React'),i=b('cx'),j=h.createClass({displayName:'XUIDialogBody',propTypes:{useCustomPadding:g.bool},render:function(){var k=(("_4-i2")+(!this.props.useCustomPadding?' '+"_57_a":''));return this.transferPropsTo(h.DOM.div({className:k},h.DOM.div({className:"_50f4"},this.props.children)));}});e.exports=j;});
__d("sliceChildren",["flattenChildren"],function(a,b,c,d,e,f){"use strict";var g=b('flattenChildren');function h(i,j,k){if(i==null)return i;var l={},m=g(i),n=0;for(var o in m){if(!m.hasOwnProperty(o))continue;var p=m[o];if(p!==null){if(n>=j)l[o]=p;n++;if(k!=null&&n>=k)break;}}return l;}e.exports=h;});
__d("XUIDialogTitle.react",["LeftRight.react","React","ReactPropTypes","XUICloseButton.react","cx","tx","sliceChildren"],function(a,b,c,d,e,f){var g=b('LeftRight.react'),h=b('React'),i=b('ReactPropTypes'),j=b('XUICloseButton.react'),k=b('cx'),l=b('tx'),m=b('sliceChildren'),n=h.createClass({displayName:'XUIDialogTitle',props:{closeButtonText:i.string,showCloseButton:i.bool},getDefaultProps:function(){return {closeButtonText:"Close",showCloseButton:true};},render:function(){var o=null;if(this.props.showCloseButton)o=j({label:this.props.closeButtonText,className:"layerCancel _51-t"});return this.transferPropsTo(h.DOM.div({className:"_4-i0"},g(null,h.DOM.div({className:"_52c9"},m(this.props.children,0,1)),h.DOM.div({className:"_51-u"},m(this.props.children,1),o))));}});e.exports=n;});
__d("StickerStore.react",["BanzaiLogger","LegacyScrollableArea.react","Link.react","React","Image.react","StickerStoreHeader.react","StickerStorePackDetail.react","StickerStorePackList.react","XUIDialogBody.react","XUIDialogTitle.react","XUIText.react","cx","fbt","ix"],function(a,b,c,d,e,f){var g=b('BanzaiLogger'),h=b('LegacyScrollableArea.react'),i=b('Link.react'),j=b('React'),k=b('Image.react'),l=b('StickerStoreHeader.react'),m=b('StickerStorePackDetail.react'),n=b('StickerStorePackList.react'),o=b('XUIDialogBody.react'),p=b('XUIDialogTitle.react'),q=b('XUIText.react'),r=b('cx'),s=b('fbt'),t=b('ix'),u=j.createClass({displayName:'StickerStore',getInitialState:function(){return {currentPackID:null};},componentDidMount:function(){this.props.shown&&this.logOpen();},componentWillReceiveProps:function(v){if(!this.props.shown&&v.shown)this.logOpen();if(this.props.shown&&!v.shown)this.logClose();},shouldComponentUpdate:function(v){return v.shown;},componentDidUpdate:function(){this.pokeScrollbar();},render:function(){return (o({className:"_5rq-"},this.renderHeader(),j.DOM.div({className:this.getContentClass()},h({fade:false,persistent:true,ref:"scrollableArea",shadow:true,width:688},this.renderContent()))));},renderHeader:function(){if(!this.state.currentPackID)return l(null);return (j.DOM.div({className:"_5r5i"},p({className:"_5r5g"},i({className:"_5r5c",onClick:this.packSelected.curry(null)},k({className:"_5r5t",src:t('/images/messaging/stickers/store/backarrow.png')}),q({className:"_5rq_",weight:"normal"},"Sticker Store")))));},renderContent:function(){if(!this.props.shown)return null;if(this.state.currentPackID)return (m({packID:this.state.currentPackID,onDataReady:this.pokeScrollbar}));return (n({onPackSelect:this.packSelected,onDataReady:this.pokeScrollbar}));},getContentClass:function(){return ((!this.state.currentPackID?"_5rzk":'')+(!!this.state.currentPackID?' '+"_5rzl":''));},packSelected:function(v){this.setState({currentPackID:v});},logOpen:function(){g.log('StickersLoggerConfig',{event:'open_store'});},logClose:function(){g.log('StickersLoggerConfig',{event:'close_store'});},pokeScrollbar:function(){this.refs.scrollableArea.getArea().poke();}});e.exports=u;});
__d("XUIDialog.react",["AbstractDialog.react","LayerFadeOnShow","ReactLayer"],function(a,b,c,d,e,f){var g=b('AbstractDialog.react'),h=b('LayerFadeOnShow'),i=b('ReactLayer'),j=i.createClass(g.createSpec({displayName:'XUIDialog',addedBehaviors:{LayerFadeOnShow:h}}));e.exports=j;});
__d("StickersFlyoutStoreButton.react",["DialogFitHeight","LayerFadeOnHide","React","Image.react","ReactLayeredComponentMixin","StickerStore.react","XUIDialog.react","requestAnimationFrame","cx","fbt","ix"],function(a,b,c,d,e,f){var g=b('DialogFitHeight'),h=b('LayerFadeOnHide'),i=b('React'),j=b('Image.react'),k=b('ReactLayeredComponentMixin'),l=b('StickerStore.react'),m=b('XUIDialog.react'),n=b('requestAnimationFrame'),o=b('cx'),p=b('fbt'),q=b('ix'),r=688,s="Sticker Store",t=i.createClass({displayName:'StickersFlyoutStoreButton',mixins:[k],getInitialState:function(){return {dialogShown:false};},renderLayers:function(){return {dialog:m({causalElementRef:"button",behaviors:{LayerFadeOnHide:h,DialogFitHeight:g},onToggle:this._onToggle,shown:this.state.dialogShown,width:r},l({shown:this.state.dialogShown}))};},_onToggle:function(u){n(this.setState.bind(this,{dialogShown:u},null));},_openStore:function(){this.setState({dialogShown:true});},render:function(){return (i.DOM.a({'aria-label':s,className:"_5r86 rfloat",'data-hover':"tooltip",onClick:this._openStore,ref:"button"},j({className:"_5r87",src:q('/images/messaging/stickers/selector/store.png')})));}});e.exports=t;});
__d("StickersFlyoutPackSelector.react",["Animation","React","Image.react","StickersFlyoutStoreButton.react","cx","ix"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('React'),i=b('Image.react'),j=b('StickersFlyoutStoreButton.react'),k=b('cx'),l=b('ix'),m=5,n=h.createClass({displayName:'StickersFlyoutPackSelector',_calculateNumPages:function(p){return Math.max(1,Math.ceil((p.length-1)/m));},getInitialState:function(){return {animating:false,selectedId:null,page:0,numPages:this._calculateNumPages(this.props.packs)};},componentWillReceiveProps:function(p){this.setState({numPages:this._calculateNumPages(p.packs),selectedId:p.selectedPackID||this.props.selectedId});},shouldComponentUpdate:function(p,q){return !q.animating;},_canGoPrev:function(){return this.state.page>0;},_canGoNext:function(){return this.state.page+1<this.state.numPages;},_setPage:function(p){if(this.state.animating)return;this.setState({animating:true,page:p});var q=this.refs.positioner.getDOMNode();new g(q).to('marginLeft',-q.childNodes[p].offsetLeft+'px').ondone(function(){this.setState({animating:false});}.bind(this)).duration(200).go();},_back:function(){this._canGoPrev()&&this._setPage(this.state.page-1);},_next:function(){this._canGoNext()&&this._setPage(this.state.page+1);},render:function(){var p=this.props.packs,q=this.props.onPackClick,r=[];p.forEach(function(x,y){r.push(o({key:x.id,onClick:function(){q&&q(x.id);this.setState({selectedId:x.id});}.bind(this),pack:x,selected:this.state.selectedId===x.id}));}.bind(this));var s=[],t=[];r.forEach(function(x,y){t.push(x);if(y>0&&(y%m===0||y===r.length-1)){s.push(h.DOM.div({className:"_5r81"},t));t=[];}});var u=(("_5r82")+(' '+"lfloat")+(!this._canGoPrev()?' '+"hidden_elem":'')),v=(("_5r83")+(' '+"rfloat")+(!this._canGoNext()?' '+"hidden_elem":'')),w;if(s.length>1)w=h.DOM.a({className:v,onClick:this._next},i({className:"_5r84",src:l('/images/messaging/stickers/selector/rightarrow.png')}));return (h.DOM.div({className:"_5r85"},j({ref:"store"}),h.DOM.a({className:u,onClick:this._back},i({className:"_5r84",src:l('/images/messaging/stickers/selector/leftarrow.png')})),w,h.DOM.div({className:"_5r88"},h.DOM.div({className:"_5r89",ref:"positioner"},s))));}}),o=h.createClass({displayName:'PackIcon',render:function(){var p=this.props.pack,q=(("_5r8a")+(this.props.selected?' '+"_5r8b":''));return (h.DOM.a({'aria-label':p.name,className:q,'data-id':p.id,'data-hover':"tooltip",onClick:function(){this.props.onClick&&this.props.onClick(p.id);}.bind(this),tabIndex:"0"},h.DOM.img({className:"_5r8c",src:p.icon}),h.DOM.img({className:"_5r8d",src:p.selectedIcon})));}});e.exports=n;});
__d("XStickerPackImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true}});});
__d("StickersFlyoutStickerSelector.react",["AsyncRequest","Grid.react","LegacyScrollableArea.react","ReactPropTypes","React","Sticker.react","XUISpinner.react","XStickerPackImagesControllerURIBuilder","cx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Grid.react'),i=b('LegacyScrollableArea.react'),j=b('ReactPropTypes'),k=b('React'),l=b('Sticker.react'),m=b('XUISpinner.react'),n=b('XStickerPackImagesControllerURIBuilder'),o=b('cx'),p=h.GridItem,q=148,r=256,s=52,t={},u=k.createClass({displayName:'StickersFlyoutStickerSelector',propTypes:{packID:j.number},getInitialState:function(){return {loading:false,stickers:[]};},componentDidMount:function(){this.requestStickers(this.props.packID);},componentWillReceiveProps:function(v){if(v.packID!==this.props.packID)this.requestStickers(v.packID);},getScaledDimensions:function(v,w){var x,y,z;if(w>v){z=s/w;x=v*z;y=w*z;}else{z=s/v;x=v*z;y=w*z;}return {height:Math.round(x),width:Math.round(y)};},requestStickers:function(v){if(!v)return;if(v in t){this.setState({stickers:t[v]});return;}new g().setURI(new n().setInt('pack_id',v).getURI()).setMethod("POST").setHandler(function(w){t[v]=w.payload;this.setState({loading:false,stickers:w.payload});}.bind(this)).send();this.setState({loading:true});},renderStickers:function(){var v=this.state.stickers.map(function(w){var x=this.getScaledDimensions(w.height,w.width);return (p({key:w.id},k.DOM.div({className:"_5r8h",'data-id':w.id},l({animationTrigger:"hover",className:"_5r8i",frameCount:w.frameCount,frameRate:w.frameRate||83,framesPerCol:w.framesPerCol,framesPerRow:w.framesPerRow,sourceHeight:x.height,sourceURI:w.sourceURI,sourceWidth:x.width,spriteURI:w.spriteURI,style:{cursor:'pointer'}}))));}.bind(this));return v;},render:function(){if(this.state.loading)return (m({className:"_5r8j"}));return (i({height:q,width:r,fade:true},k.DOM.div({className:"_5r8k"},h({cols:4,fixed:true},this.renderStickers()))));}});e.exports=u;});
__d("StickersFlyout.react",["Arbiter","BanzaiLogger","MessagesEmoticons.react","Parent","React","ReactPropTypes","StickersFlyoutPackSelector.react","StickersFlyoutStickerSelector.react","StickerState","SubscriptionsHandler","Toggler","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('BanzaiLogger'),i=b('MessagesEmoticons.react'),j=b('Parent'),k=b('React'),l=b('ReactPropTypes'),m=b('StickersFlyoutPackSelector.react'),n=b('StickersFlyoutStickerSelector.react'),o=b('StickerState'),p=b('SubscriptionsHandler'),q=b('Toggler'),r=b('cx'),s=k.createClass({displayName:'StickersFlyout',propTypes:{onStickerSelect:l.func.isRequired},getInitialState:function(){return {currentPackID:null,dataReady:false,showFlyout:false};},componentDidMount:function(){var t=j.byClass(this.getDOMNode(),'uiToggle');if(t){q.listen('show',t,function(){h.log('StickersLoggerConfig',{event:'open_tray'});this.setState({showFlyout:true});}.bind(this));}else this.setState({showFlyout:true});this.subscriptions=new p();this.subscriptions.addSubscriptions(g.subscribe(o.PACKS_CHANGED,this.packsUpdated));},componentDidUpdate:function(){if(!this.state.dataReady&&this.state.showFlyout)o.onTrayDataReady(function(){this.setState({currentPackID:this.state.currentPackID||o.getPacksInTray()[0].id,dataReady:true});}.bind(this));},componentWillUnmount:function(){this.subscriptions.release();},selectPack:function(t){this.setState({currentPackID:t});},loadPack:function(){if(this.state.currentPackID==='emoticons')return (k.DOM.div({className:"_5r8l",'data-id':this.state.currentPackID},i(null)));h.log('StickersLoggerConfig',{event:'select_pack',packid:this.state.currentPackID});return (k.DOM.div({className:"_5r8l",'data-id':this.state.currentPackID},n({packID:this.state.currentPackID})));},packsUpdated:function(){var t=o.getPackIDsInTray();if(t.indexOf(this.state.currentPackID)<0){this.setState({currentPackID:t[0]});return;}this.forceUpdate(null);},selectedSticker:function(event){var t=j.byClass(event.target,"_5r8h");if(t){this.props.onStickerSelect(t.getAttribute('data-id'));var u=j.byClass(this.getDOMNode(),'uiToggle');u&&q.hide(u);}},render:function(){if(!this.state.showFlyout)return k.DOM.div(null);return (k.DOM.div(null,k.DOM.div({className:"_5r8e"},m({onPackClick:this.selectPack,selectedPackID:this.state.currentPackID,packs:o.getPacksInTray()})),k.DOM.div({className:"_5r8m",onClick:this.selectedSticker},this.loadPack())));}});e.exports=s;});
__d("FileForm",["ArbiterMixin","AsyncRequest","AsyncResponse","AsyncUploadRequest","BehaviorsMixin","DataStore","DOMQuery","Env","Event","Form","JSONPTransport","Parent","URI","copyProperties","mixin","shield"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('AsyncUploadRequest'),k=b('BehaviorsMixin'),l=b('DataStore'),m=b('DOMQuery'),n=b('Env'),o=b('Event'),p=b('Form'),q=b('JSONPTransport'),r=b('Parent'),s=b('URI'),t=b('copyProperties'),u=b('mixin'),v=b('shield');function w(ca){var da={},ea=m.scry(ca,'input[type="file"]');ea.forEach(function(fa){da[fa.name]=fa.files;});return da;}function x(ca){var da=m.scry(ca,'input[type="file"]');da.forEach(function(ea){ea.files=null;});}var y=u(g,k);for(var z in y)if(y.hasOwnProperty(z))ba[z]=y[z];var aa=y===null?null:y.prototype;ba.prototype=Object.create(aa);ba.prototype.constructor=ba;ba.__superConstructor__=y;function ba(ca,da,ea){"use strict";if(ca.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(ca.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=ca;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding='multipart/form-data';this._files=null;da&&this.enableBehaviors(da);this._options=ea||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setUploadInParallel(this._options.uploadInParallel);this._listeners=[o.listen(this._form,'submit',this._submit.bind(this)),o.listen(this._form,'click',this._click.bind(this))];l.set(this._form,'FileForm',this);}ba.prototype.getRoot=function(){"use strict";return this._form;};ba.prototype.setAllowCrossOrigin=function(ca){"use strict";this._allowCrossOrigin=!!ca;return this;};ba.prototype.setUploadInParallel=function(ca){"use strict";this._uploadInParallel=!!ca;return this;};ba.prototype.setFiles=function(ca){"use strict";this._files=ca;return this;};ba.prototype._submit=function(event){"use strict";if(this.inform('submit')===false){event.prevent();return;}var ca='FormData' in window;if(ca)if(!s(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)ca=false;return ca?this._sendViaXHR(event):this._sendViaFrame(event);};ba.prototype._click=function(event){"use strict";var ca=event.getTarget();while(m.isElementNode(ca)){if(ca.type==='submit'){this._clickTarget=ca;this._unclick.bind(this).defer();break;}ca=ca.parentNode;}};ba.prototype._unclick=function(){"use strict";this._clickTarget=null;};ba.prototype._sendViaFrame=function(event){"use strict";var ca=this._request=new h();ca.setStatusElement(this._getStatusElement());ca.addStatusIndicator();ca.setOption('useIframeTransport',true);var da=ca.handleResponse.bind(ca),ea=new q('iframe',this._form.action,da),fa=ea.getTransportFrame(),ga=ea.getRequestURI().addQueryData({__iframe:true,__user:n.user});this._form.setAttribute('action',ga.toString());this._form.setAttribute('target',fa.name);ca.setJSONPTransport(ea);ca.setURI(ga);ca.setHandler(this.success.bind(this,null));ca.setErrorHandler(this.failure.bind(this,null));ca.setInitialHandler(v(this.initial,this,null));};ba.prototype._sendViaXHR=function(event){"use strict";var ca;if(this._uploadInParallel&&j.isSupported()){ca=new j().setData(p.serialize(this._form,this._clickTarget));if(this._files){ca.setFiles(this._files);}else ca.setFiles(w(this._form));var da=[ca.subscribe('progress',function(ea,fa){this.progress(fa,fa.getProgressEvent());}.bind(this)),ca.subscribe('initial',function(ea,fa){this.initial(fa,fa.getResponse());}.bind(this)),ca.subscribe('success',function(ea,fa){this.success(fa,fa.getResponse());}.bind(this)),ca.subscribe('start',function(ea,fa){this.inform('start',{upload:fa});}.bind(this)),ca.subscribe('failure',function(ea,fa){this.failure(fa,fa.getResponse());return false;}.bind(this)),ca.subscribe('complete',function(){while(da.length)da.pop().unsubscribe();})];}else ca=new h().setRawData(p.createFormData(this._form,this._clickTarget)).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(v(this.initial,this,null));ca.setAllowCrossOrigin(this._allowCrossOrigin).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=ca;event.prevent();};ba.prototype.initial=function(ca){"use strict";return this.inform('initial',{upload:ca});};ba.prototype.success=function(ca,da){"use strict";var ea={response:da,upload:ca};if(this.inform('success',ea)!==false)o.fire(this._form,'success',ea);this._cleanup();};ba.prototype.failure=function(ca,da){"use strict";var ea={response:da,upload:ca};if(this.inform('failure',ea)!==false)if(o.fire(this._form,'error',ea)!==false)i.defaultErrorHandler(da);this._cleanup();};ba.prototype.progress=function(ca,event){"use strict";this.inform('progress',{event:event,upload:ca});};ba.prototype.abort=function(){"use strict";if(this._request){this._request.abort();this._cleanup();}};ba.prototype.clear=function(){"use strict";x(this._form);};ba.prototype.destroy=function(){"use strict";this._cleanup();while(this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;l.remove(this._form,'FileForm');};ba.prototype._cleanup=function(){"use strict";this._request=null;};ba.prototype._getStatusElement=function(){"use strict";return r.byClass(this._form,'stat_elem')||this._form;};ba.getInstance=function(ca){"use strict";return l.get(ca,'FileForm');};t(ba,{EVENTS:['start','submit','initial','progress','success','failure']});e.exports=ba;});
__d("submitForm",["DOM"],function(a,b,c,d,e,f){var g=b('DOM'),h=function(i){var j=g.scry(i,'input[type="submit"]')[0];if(j){j.click();}else{j=g.create('input',{type:'submit',className:'hidden_elem'});g.appendContent(i,j);j.click();g.remove(j);}};e.exports=h;});
__d("FileInputUploader",["ArbiterMixin","DOM","DTSG","FileForm","Form","copyProperties","mixin","submitForm"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DOM'),i=b('DTSG'),j=b('FileForm'),k=b('Form'),l=b('copyProperties'),m=b('mixin'),n=b('submitForm'),o=m(g);for(var p in o)if(o.hasOwnProperty(p))r[p]=o[p];var q=o===null?null:o.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=o;function r(s){"use strict";this._inputElem=s;this._data={};}r.prototype.setInput=function(s){"use strict";this._inputElem=s;return this;};r.prototype.setURI=function(s){"use strict";this._uri=s;return this;};r.prototype.setData=function(s){"use strict";this._data=s;return this;};r.prototype.setFiles=function(s){"use strict";this._files=s;return this;};r.prototype.setAllowCrossOrigin=function(s){"use strict";this._allowCrossOrigin=!!s;return this;};r.prototype.setUploadInParallel=function(s){"use strict";this._uploadInParallel=!!s;return this;};r.prototype.send=function(){"use strict";this._createForm();var s=this._inputElem.cloneNode(false);h.replace(this._inputElem,s);h.appendContent(this._formElem,this._inputElem);h.appendContent(document.body,this._formElem);n(this._formElem);h.replace(s,this._inputElem);this._cleanup();};r.prototype._onFileFormEvent=function(s,t){"use strict";this.inform(s,t);};r.prototype._createForm=function(){"use strict";this._formElem=h.create('form',{action:this._uri,method:'post'});this._fileForm=new j(this._formElem,null,{allowCrossOrigin:this._allowCrossOrigin,uploadInParallel:this._uploadInParallel});if(this._files)this._fileForm.setFiles(this._files);this._fileForm.subscribe(j.EVENTS,this._onFileFormEvent.bind(this));k.createHiddenInputs(l({fb_dtsg:i.getToken()},this._data),this._formElem);};r.prototype._cleanup=function(){"use strict";this._fileForm.destroy();this._fileForm=null;h.remove(this._formElem);this._formElem=null;};l(r.prototype,{_formElem:null,_fileForm:null,_uri:null,_files:null,_allowCrossOrigin:false,_uploadInParallel:false});e.exports=r;});
__d("PhotosUploadID",[],function(a,b,c,d,e,f){var g=1024,h={getNewID:function(){return (g++).toString();}};e.exports=h;});
__d("PhotosUploadWaterfallXMixin",["AsyncSignal","PhotosUploadWaterfallXConfig","copyProperties","invariant"],function(a,b,c,d,e,f){var g=b('AsyncSignal'),h=b('PhotosUploadWaterfallXConfig'),i=b('copyProperties'),j=b('invariant');function k(l,m){new g(h.loggingEndpoint,{data:JSON.stringify(l)}).setHandler(m).send();}e.exports={logStep:function(l,m,n){var o=this.getWaterfallID&&this.getWaterfallID(),p=this.getWaterfallAppName&&this.getWaterfallAppName();if(!o||!p)return;k(i({step:l,qn:o,uploader:p,ref:this.getWaterfallSource&&this.getWaterfallSource()},m),n);}};});
__d("str2rstr",[],function(a,b,c,d,e,f){function g(h){var i="",j,k;for(var l=0;l<h.length;l++){j=h.charCodeAt(l);k=l+1<h.length?h.charCodeAt(l+1):0;if(55296<=j&&j<=56319&&56320<=k&&k<=57343){j=65536+((j&1023)<<10)+(k&1023);l++;}if(j<=127){i+=String.fromCharCode(j);}else if(j<=2047){i+=String.fromCharCode(192|((j>>>6)&31),128|(j&63));}else if(j<=65535){i+=String.fromCharCode(224|((j>>>12)&15),128|((j>>>6)&63),128|(j&63));}else if(j<=2097151)i+=String.fromCharCode(240|((j>>>18)&7),128|((j>>>12)&63),128|((j>>>6)&63),128|(j&63));}return i;}e.exports=g;});
__d("md5",["str2rstr"],function(a,b,c,d,e,f){var g=b('str2rstr');function h(u,v){var w=u[0],x=u[1],y=u[2],z=u[3];w=j(w,x,y,z,v[0],7,-680876936);z=j(z,w,x,y,v[1],12,-389564586);y=j(y,z,w,x,v[2],17,606105819);x=j(x,y,z,w,v[3],22,-1044525330);w=j(w,x,y,z,v[4],7,-176418897);z=j(z,w,x,y,v[5],12,1200080426);y=j(y,z,w,x,v[6],17,-1473231341);x=j(x,y,z,w,v[7],22,-45705983);w=j(w,x,y,z,v[8],7,1770035416);z=j(z,w,x,y,v[9],12,-1958414417);y=j(y,z,w,x,v[10],17,-42063);x=j(x,y,z,w,v[11],22,-1990404162);w=j(w,x,y,z,v[12],7,1804603682);z=j(z,w,x,y,v[13],12,-40341101);y=j(y,z,w,x,v[14],17,-1502002290);x=j(x,y,z,w,v[15],22,1236535329);w=k(w,x,y,z,v[1],5,-165796510);z=k(z,w,x,y,v[6],9,-1069501632);y=k(y,z,w,x,v[11],14,643717713);x=k(x,y,z,w,v[0],20,-373897302);w=k(w,x,y,z,v[5],5,-701558691);z=k(z,w,x,y,v[10],9,38016083);y=k(y,z,w,x,v[15],14,-660478335);x=k(x,y,z,w,v[4],20,-405537848);w=k(w,x,y,z,v[9],5,568446438);z=k(z,w,x,y,v[14],9,-1019803690);y=k(y,z,w,x,v[3],14,-187363961);x=k(x,y,z,w,v[8],20,1163531501);w=k(w,x,y,z,v[13],5,-1444681467);z=k(z,w,x,y,v[2],9,-51403784);y=k(y,z,w,x,v[7],14,1735328473);x=k(x,y,z,w,v[12],20,-1926607734);w=l(w,x,y,z,v[5],4,-378558);z=l(z,w,x,y,v[8],11,-2022574463);y=l(y,z,w,x,v[11],16,1839030562);x=l(x,y,z,w,v[14],23,-35309556);w=l(w,x,y,z,v[1],4,-1530992060);z=l(z,w,x,y,v[4],11,1272893353);y=l(y,z,w,x,v[7],16,-155497632);x=l(x,y,z,w,v[10],23,-1094730640);w=l(w,x,y,z,v[13],4,681279174);z=l(z,w,x,y,v[0],11,-358537222);y=l(y,z,w,x,v[3],16,-722521979);x=l(x,y,z,w,v[6],23,76029189);w=l(w,x,y,z,v[9],4,-640364487);z=l(z,w,x,y,v[12],11,-421815835);y=l(y,z,w,x,v[15],16,530742520);x=l(x,y,z,w,v[2],23,-995338651);w=m(w,x,y,z,v[0],6,-198630844);z=m(z,w,x,y,v[7],10,1126891415);y=m(y,z,w,x,v[14],15,-1416354905);x=m(x,y,z,w,v[5],21,-57434055);w=m(w,x,y,z,v[12],6,1700485571);z=m(z,w,x,y,v[3],10,-1894986606);y=m(y,z,w,x,v[10],15,-1051523);x=m(x,y,z,w,v[1],21,-2054922799);w=m(w,x,y,z,v[8],6,1873313359);z=m(z,w,x,y,v[15],10,-30611744);y=m(y,z,w,x,v[6],15,-1560198380);x=m(x,y,z,w,v[13],21,1309151649);w=m(w,x,y,z,v[4],6,-145523070);z=m(z,w,x,y,v[11],10,-1120210379);y=m(y,z,w,x,v[2],15,718787259);x=m(x,y,z,w,v[9],21,-343485551);u[0]=s(w,u[0]);u[1]=s(x,u[1]);u[2]=s(y,u[2]);u[3]=s(z,u[3]);}function i(u,v,w,x,y,z){v=s(s(v,u),s(x,z));return s((v<<y)|(v>>>(32-y)),w);}function j(u,v,w,x,y,z,aa){return i((v&w)|((~v)&x),u,v,y,z,aa);}function k(u,v,w,x,y,z,aa){return i((v&x)|(w&(~x)),u,v,y,z,aa);}function l(u,v,w,x,y,z,aa){return i(v^w^x,u,v,y,z,aa);}function m(u,v,w,x,y,z,aa){return i(w^(v|(~x)),u,v,y,z,aa);}function n(u){var v=u.length,w=[1732584193,-271733879,-1732584194,271733878],x;for(x=64;x<=u.length;x+=64)h(w,o(u.substring(x-64,x)));u=u.substring(x-64);var y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(x=0;x<u.length;x++)y[x>>2]|=u.charCodeAt(x)<<((x&3)<<3);y[x>>2]|=128<<((x&3)<<3);if(x>55){h(w,y);for(x=0;x<16;x++)y[x]=0;}y[14]=v*8;h(w,y);return w;}function o(u){var v=[],w=0;while(w<64)v[w>>2]=u.charCodeAt(w++)|(u.charCodeAt(w++)<<8)|(u.charCodeAt(w++)<<16)|(u.charCodeAt(w++)<<24);return v;}var p='0123456789abcdef'.split('');function q(u){var v='',w=0;for(;w<4;w++)v+=p[(u>>((w<<3)+4))&15]+p[(u>>(w<<3))&15];return v;}function r(u){for(var v=0;v<u.length;v++)u[v]=q(u[v]);return u.join('');}var s=function(u,v){return (u+v)&4294967295;};function t(u){if(null===u||undefined===u){return null;}else{for(var v=0;v<u.length;v++)if(u[v]>"\u007F"){u=g(u);break;}return r(n(u));}}if(t('hello')!='5d41402abc4b2a76b9719d911017c592')s=function(u,v){var w=(u&65535)+(v&65535),x=(u>>16)+(v>>16)+(w>>16);return (x<<16)|(w&65535);};e.exports=t;});
__d("WaterfallIDGenerator",["Env","md5"],function(a,b,c,d,e,f){var g=b('Env'),h=b('md5');function i(){var l=2147483647;return Math.random()*l;}function j(){return Math.floor(Date.now()/1000);}var k={generate:function(){return h([g.user,j(),i()].join(':'));}};e.exports=k;});
__d("BanzaiScribe",["Banzai"],function(a,b,c,d,e,f){var g=b('Banzai');function h(j){return {log:function(k,l,m){var n=[l];if(m!=null)n.push(m);g.post('scribe:'+k,n,j);}};}var i=h({});i.create=h;e.exports=i;});
__d("SamplingPolicyBase",[],function(a,b,c,d,e,f){function g(){"use strict";throw 'Tried to instantiate SamplingPolicyBase';}g.prototype.getName=function(){"use strict";return this.name;};g.prototype.isSampled=function(){"use strict";if(typeof(this.sampled)=='undefined')this.sampled=this.decideIfSampled();return this.sampled;};e.exports=g;});
/**
 * @generated SignedSource<<091461a353d9b40c12f5a66d653a6b62>>
 * 
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 * !! This file is a check-in of a static_upstream project!      !!
 * !!                                                            !!
 * !! You should not modify this file directly. Instead:         !!
 * !! 1) Use `fjs use-upstream` to temporarily replace this with !!
 * !!    the latest version from upstream.                       !!
 * !! 2) Make your changes, test them, etc.                      !!
 * !! 3) Use `fjs push-upstream` to copy your changes back to    !!
 * !!    static_upstream.                                        !!
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 * 
 * Copyright (C) 2010 by Johannes Baagoe <baagoe@baagoe.org>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @providesModule Alea
 * @preserve-header
 */__d("Alea",[],function(a,b,c,d,e,f){function g(){var i=4022871197,j=function(k){k=k.toString();for(var l=0;l<k.length;l++){i+=k.charCodeAt(l);var m=.02519603282416938*i;i=m>>>0;m-=i;m*=i;i=m>>>0;m-=i;i+=m*4294967296;}return (i>>>0)*2.3283064365386963e-10;};j.version='Mash 0.9';return j;}function h(){return (function(i){var j=0,k=0,l=0,m=1;if(i.length===0)i=[new Date()];var n=new g();j=n(' ');k=n(' ');l=n(' ');for(var o=0;o<i.length;o++){j-=n(i[o]);if(j<0)j+=1;k-=n(i[o]);if(k<0)k+=1;l-=n(i[o]);if(l<0)l+=1;}n=null;var p=function(){var q=2091639*j+m*2.3283064365386963e-10;j=k;k=l;l=q-(m=q|0);return l;};p.version='Alea 0.9';p.args=i;return p;}(Array.prototype.slice.call(arguments)));}e.exports=h;});
__d("Random",["Alea","ServerNonce"],function(a,b,c,d,e,f){'use strict';var g=b('Alea'),h=b('ServerNonce').ServerNonce,i=g(h),j={random:i,uint32:function(){return Math.floor(i()*4294967296);}};e.exports=j;});
__d("guardFunction",[],function(a,b,c,d,e,f){function g(h,i,j){return function(){if(h.apply(j||this,arguments))i.apply(j||this,arguments);};}e.exports=g;});
__d("Fbtrace",["BanzaiScribe","copyProperties","FbtraceForcedByServerPolicy","FbtraceForcedByServer","Env","Random","ErrorUtils","Arbiter","guardFunction"],function(a,b,c,d,e,f){'use strict';var g=b('BanzaiScribe'),h=b('copyProperties'),i=b('FbtraceForcedByServerPolicy'),j=b('FbtraceForcedByServer'),k=b('Env'),l=b('Random'),m=b('ErrorUtils'),n=b('Arbiter'),o=b('guardFunction'),p='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',q='AAAAAAAAAAA';for(var r in Error)if(Error.hasOwnProperty(r))t[r]=Error[r];var s=Error===null?null:Error.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=Error;function t(ia){Error.call(this,ia);}function u(ia){m.reportError(new t(ia));}function v(){var ia=function(){var la=0,ma=0,na='';for(var oa=10;oa>=0;oa--){if(la<6){ma=l.uint32();la=32;}if(oa===0)ma=ma&7;na=p.charAt(ma&63)+na;ma>>=6;la-=6;}return na;},ja,ka;for(ja=3;ja>0;ja--){ka=ia();if(ka!=q)return ka;}u('failed to generate valid Fbtrace id');return q;}function w(){h(this,w);}h(w,{isOn:function(){return false;},replySend:function(ia,ja){},requestSend:function(ia,ja,ka){ca(ia,ja);return {metadata:function(){return undefined;},replyReceive:function(la){}};}});var x=new w();function y(ia,ja,ka){if(!ia)throw {name:'ArgumentError',message:'no valid service name specified'};if(!ja)throw {name:'ArgumentError',message:'no valid version specified'};var la=g,ma=0,na=v(),oa=v(),pa=ba(na),qa={service:ia,version:ja},ra=function(wa){if(typeof(wa)=='undefined')return 'undefined';if(typeof(wa)!='string')wa=ra(JSON.stringify(wa));return wa;},sa=function(wa){var xa='';for(var ya in wa){if(xa.length>0)xa+='\x02';xa+=ra(ya)+'\x03'+ra(wa[ya]);}return xa;},ta=function(wa,xa,event,ya,za){ma++;return [za,ma,na,wa,xa,ra(event),sa(ya)].join('\x01');},ua=function(wa,xa,event,ya,za){if(!za&&typeof(za)=='undefined')za=Date.now()*1000;var ab=ta(wa,xa,event,ya,za);la.log('fbtrace',ab,pa);},va=function(){return oa;};ua(q,oa,'#rqrecv',h(ka,qa));h(this,y);h(this,{replySend:function(wa,xa){xa=h(xa,qa,{success:wa?'true':'false'});ua(q,oa,'#rpsend',xa);},requestSend:function(wa,xa,ya){ca(wa,xa);var za=va(),ab=v();ya=h(ya,qa,{op:wa,'remote:service':xa});ua(za,ab,'#rqsend',ya);return {metadata:function(){return na+ab;},replyReceive:function(bb){ua(za,ab,'#rprecv',h(bb,qa));},parentNode:this};}});}h(y,{isOn:function(){return true;}});function z(){return x;}function aa(ia,ja,ka){ka=ka||{};ka.init=true;var la=i.get();if(la.isSampled()){return new y(ia,ja,ka);}else return new w();}function ba(ia){var ja=ia.charAt(ia.length-1);return p.indexOf(ja)%32;}function ca(ia,ja){if(!ia)throw {name:'ArgumentError',message:'no valid operation specified'};if(!ja)throw {name:'ArgumentError',message:'no valid remote:service specified'};}function da(ia,ja){var ka=x,la;x=ia;try{la=ja();}finally{x=ka;}return la;}var ea=function(ia,ja){var ka=z(),la=ja.request;if(!ka.isOn()&&j.forced&&/\/upload\/(?:composer|photos)\/|\/ajax\/composerx\/attachment\/media\//.test(la.uri.toString()))ka=aa('photo_upload_kludge',String(k.svn_rev||'dev'),{policy:'PhotoUpload'});if(ka.isOn()){var ma={policy:'PhotoUpload'};if(la.userActionId)ma.user_action_id=la.userActionId;var na=ka.requestSend(la.uri.toString(),'www',ma);la.fbtraceRemoteNode=na;la.transport.setRequestHeader('X-Fbtrace-Meta',na.metadata());}},fa=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:true});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(true,{});},0);},ga=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:false,error_code:ja.response.error,error_summary:ja.response.errorSummary,error_description:ja.response.errorDescription});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(false,{});},0);},ha=function(ia,ja){return ja.request.fbtraceRemoteNode;};n.subscribe('AsyncRequest/send',ea);n.subscribe('AsyncRequest/response',o(ha,fa));n.subscribe('AsyncRequest/error',o(ha,ga));e.exports={defaultNode:z,requestReceive:aa,withDefaultNode:da};});
__d("PhotosMultiUploadInput",["Arbiter","Animation","AsyncUploadRequest","ComposerXController","ComposerXDragDrop","CSS","Dialog","DOM","DOMQuery","DragDropTarget","Event","FileForm","FileInputUploader","JSLogger","Parent","PhotosUploadID","PhotosUploadWaterfallXMixin","PUWApplications","PUWMethods","PUWSteps","ProgressBar","WaterfallIDGenerator","$","copyProperties","createArrayFrom","csx","cx","mixin","tx","Fbtrace"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Animation'),i=b('AsyncUploadRequest'),j=b('ComposerXController'),k=b('ComposerXDragDrop'),l=b('CSS'),m=b('Dialog'),n=b('DOM'),o=b('DOMQuery'),p=b('DragDropTarget'),q=b('Event'),r=b('FileForm'),s=b('FileInputUploader'),t=b('JSLogger'),u=b('Parent'),v=b('PhotosUploadID'),w=b('PhotosUploadWaterfallXMixin'),x=b('PUWApplications'),y=b('PUWMethods'),z=b('PUWSteps'),aa=b('ProgressBar'),ba=b('WaterfallIDGenerator'),ca=b('$'),da=b('copyProperties'),ea=b('createArrayFrom'),fa=b('csx'),ga=b('cx'),ha=t.create('composer'),ia=b('mixin'),ja=b('tx');b("Fbtrace");function ka(ta,ua,va,wa){"use strict";this._grid=qa.getInstance(wa.gridID);this._grid.setProgressBarMarkup(ta).setVideoIconMarkup(ua).setConfig(wa);va.getInput().multiple=(wa.maxselect!=1)&&i.isSupported();va.subscribe('change',function(xa,event){if(event.getTarget().value)this._grid.doFileUpload(va);}.bind(this));if(!this._grid.sessionStarted){this._grid.sessionStarted=true;this._grid.logStep(z.CLIENT_FLOW_BEGIN);}this._grid.logStep(z.CLIENT_SELECT_BEGIN);g.inform('PhotosMultiUploadInput/loaded/'+wa.gridID,g.BEHAVIOR_PERSISTENT);}ka.prototype.getGrid=function(){"use strict";return this._grid;};da(ka,{imageUploadDone:function(ta,ua,va,wa){la[ta].imageUploadDone(ua,va,wa);},initDragDrop:function(ta,ua){g.inform('PhotosMultiUploadInput/initDragDrop/'+ta,{dragDropArea:ua},g.BEHAVIOR_PERSISTENT);},imageUploadFail:function(ta,ua){la[ta].removeLoadingIndicator(ua.getFile().uploadID);},doFileUpload:function(ta,ua){la[ta].doFileUpload(ua);},onFilesDrop:function(ta,ua){la[ta].onFilesDrop(ua);},getWaterfallID:function(ta){return qa.getInstance(ta).getWaterfallID();},clearSession:function(ta){la[ta].clearSession();},getConfig:function(ta){return la[ta].getConfig();},updateProgressBar:function(ta,ua){if(ua.loaded==ua.total){ta.setPosition(50);ta.setTarget(100,2000);}else ta.setPosition(50*ua.loaded/ua.total);}});var la={},ma=0,na=ia(w);for(var oa in na)if(na.hasOwnProperty(oa))qa[oa]=na[oa];var pa=na===null?null:na.prototype;qa.prototype=Object.create(pa);qa.prototype.constructor=qa;qa.__superConstructor__=na;function qa(ta){"use strict";this._loadingIndicators={};this._numRemainingFiles=0;this._progressBarMarkup=null;this._videoIconMarkup=null;this._gridID=ta;this._dragDropTarget=null;this._submitListener=null;this._fileInputInstances=[];this._videoFileInput=null;this._videoFileInputContainer=null;this._videoUploadSubscriptions=[];this._uploadTimers={};this._sessionsStarted=false;this._waterfallID=null;g.subscribe('multi-upload/video-removed/'+this._gridID,function(){n.remove(this._videoIconMarkup);this._submitListener&&this._submitListener.remove();this._submitListener=null;this._videoFileInput=null;this._videoFileInputContainer=null;this._videoUploadSubscriptions.forEach(function(ua){ua.unsubscribe();}.bind(this));this._videoUploadSubscriptions=[];this._fileInputInstances.forEach(function(ua){ua.clear();});}.bind(this));g.subscribe('PhotosMultiUploadInput/initDragDrop/'+ta,function(ua,va){this.initDragDrop(va.dragDropArea);}.bind(this));g.subscribe('AttachmentsPhotoEditor/newImage'+ta,this._onEditedImage.bind(this));}qa.prototype.getWaterfallID=function(){"use strict";if(!this._waterfallID)this._waterfallID=ba.generate();return this._waterfallID;};qa.prototype.getWaterfallAppName=function(){"use strict";return x.WEB_COMPOSER;};qa.prototype.getLoadingIndicator=function(ta){"use strict";var ua=this._loadingIndicators[ta];return ua;};qa.prototype.initDragDrop=function(ta){"use strict";this._dragDropTarget&&this._dragDropTarget.disable();this._dragDropTarget=new p(ta).setOnFilesDropCallback(this.onFilesDrop.bind(this)).setFileFilter(k.filterImages).enable();};qa.prototype.setConfig=function(ta){"use strict";this._config=ta;if(!this._waterfallID)this._waterfallID=ta.waterfallID;return this;};qa.prototype.setProgressBarMarkup=function(ta){"use strict";this._progressBarMarkup=ta;return this;};qa.prototype.setVideoIconMarkup=function(ta){"use strict";this._videoIconMarkup=ta;var ua=n.find(ta,"._3ev");q.listen(ua,'click',this._onVideoRemoved.bind(this));return this;};qa.prototype.imageUploadDone=function(ta,ua,va){"use strict";var wa=this.getLoadingIndicator(ua);if(!wa)return;if(n.contains(document.body,wa.getRoot()))n.replace(wa.getRoot(),ta);g.inform(['multi-upload/images-added/'+this._gridID,'multi-upload/images-added'],{fbids:[va],tagInfo:{}});this._numRemainingFiles--;if(this._numRemainingFiles===0)g.inform('multi-upload/images-upload-completed/'+this._gridID);this._loadingIndicators[ua]=null;};qa.prototype._generateLoadingIndicator=function(ta){"use strict";this._numRemainingFiles++;var ua=this._progressBarMarkup.cloneNode(true);this.insertIntoGrid(ua);this._loadingIndicators[ta]=new aa(ua);};qa.prototype._generateUploadIDsAndLoadingIndicators=function(ta){"use strict";for(var ua=0;ua<ta.length;ua++){if(!ta[ua].uploadID)ta[ua].uploadID=v.getNewID();this._generateLoadingIndicator(ta[ua].uploadID);}};qa.prototype.fileUploadFailure=function(ta,ua){"use strict";var va=Date.now()-this._uploadTimers[ta];this.logStep(z.CLIENT_TRANSFER_FAIL,{dt:va,error_code:ua.response?ua.response.getError():undefined,bytes:ua.upload.getFile().size});this._showUploadFailedMessage(ta);this._fadeOutFileUpload(ta);};qa.prototype._fadeOutFileUpload=function(ta){"use strict";new h(this.getLoadingIndicator(ta).getRoot()).duration(2000).checkpoint().from('opacity',1).to('opacity',0).duration(1000).ondone(this.removeFileUpload.bind(this,ta)).go();};qa.prototype._showUploadFailedMessage=function(ta){"use strict";l.hide(o.find(this.getLoadingIndicator(ta).getRoot(),"._5l83"));l.show(o.find(this.getLoadingIndicator(ta).getRoot(),"._5l82"));};qa.prototype.fileUploadCanceled=function(ta,ua){"use strict";var va=Date.now()-this._uploadTimers[ta];this.logStep(z.CLIENT_TRANSFER_CANCEL,{dt:va,bytes:ua.upload.getFile().size});this.removeFileUpload(ta);};qa.prototype.removeFileUpload=function(ta){"use strict";this._numRemainingFiles=Math.max(0,this._numRemainingFiles-1);this.removeLoadingIndicator(ta);if(this._numRemainingFiles===0)g.inform('multi-upload/images-upload-completed/'+this._gridID);};qa.prototype.doFileUpload=function(ta){"use strict";var ua=false,va=false;switch(this._config.supportedFileTypes){case 'photos':va=true;break;case 'videos':ua=true;break;case 'both':ua=va=true;break;}var wa=ua&&this._config.videoUploader.isVideoFile(ta.getInput());this._submitListener&&this._submitListener.remove();if(wa){this._videoSelected(ta);}else if(va){this._photosSelected(ta);}else new m().setBody("Sorry, you can only select video files.").setTitle("Unsupported File").setModal(true).setButtons(m.OK).show();};qa.prototype.getConfig=function(){"use strict";return this._config;};qa.prototype._photosSelected=function(ta){"use strict";var ua=ta.getInput(),va=ra(ua);if(this._config.maxselect>1&&va>this._config.maxselect){new m().setTitle("Too Many Photos").setBody(ja._("Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages.",{maxselect:this._config.maxselect})).setButtons(m.OK).setModal(true).show();return;}this._onBeforeAddUploadedImages();var wa=this._config.uploadData,xa=null;if(!sa(ua)){ua.uploadID=v.getNewID();this._generateLoadingIndicator(ua.uploadID);wa.upload_id=ua.uploadID;}else{xa=ea(ua.files);this._generateUploadIDsAndLoadingIndicators(xa);}g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:va});if(this._config.waterfallID)wa.qn=this._config.waterfallID;var ya=new s(ua).setURI(this._config.photoEndpoint).setData(wa).setAllowCrossOrigin(true).setUploadInParallel(true);if(xa)ya.setFiles(xa);ya.subscribe('progress',this._onProgress.bind(this));ya.subscribe('failure',function(ab,bb){this.fileUploadFailure(bb.upload.getFile().uploadID,bb);}.bind(this));ya.subscribe('start',this._onFileUploadStart.bind(this));ya.subscribe('success',function(ab,bb){var cb;if(bb.upload){cb=bb.upload.getFile().uploadID;}else cb=ua.uploadID;this._onFileUploadSuccess(cb,bb);}.bind(this));try{ya.send();ta.clear();}catch(za){ha.error('error_send_unpublished_files',za);throw za;}this.logStep(z.CLIENT_SELECT_SUCCESS,{times_selected:ma++,volume:va,method:'file_selector'});};qa.prototype._videoSelected=function(ta){"use strict";var ua=ta.getInput();if(ua.files&&ua.files.length>1){new m().setTitle("Too many files").setBody("Please select only one video file at a time.").setButtons(m.OK).show();return;}g.inform('multi-upload/composer-reset/'+this._gridID);this._dragDropTarget&&this._dragDropTarget.disable();this.insertIntoGrid(this._videoIconMarkup);g.inform('multi-upload/video-added/'+this._gridID);this._fileInputInstances.push(ta);this._videoUploadSubscriptions=[this._config.videoUploader.subscribe('upload-succeeded',this._onVideoUploadFinished.bind(this)),this._config.videoUploader.subscribe('upload-failed',this._onVideoUploadFinished.bind(this)),this._config.videoUploader.subscribe('file-invalidated',this._onVideoUploadFinished.bind(this))];var va=u.byTag(ca(this._gridID),'form');this._submitListener=q.listen(n.find(va,"._11b"),'click',this._onVideoSubmitted.bind(this,va,ua));};qa.prototype._onVideoRemoved=function(){"use strict";this._dragDropTarget&&this._dragDropTarget.enable();g.inform('multi-upload/video-removed/'+this._gridID);};qa.prototype._onVideoSubmitted=function(ta,ua){"use strict";ta.action=this._config.videoEndpoint;ua.name='video';this._videoFileInput=ua;this._videoFileInputContainer=ua.parentNode;l.hide(ua);n.appendContent(ta,ua);l.addClass(ta,"_4_8");this._config.videoUploader.upload(r.getInstance(ta),ua);return false;};qa.prototype._onVideoUploadFinished=function(ta,ua){"use strict";n.appendContent(this._videoFileInputContainer,this._videoFileInput);l.show(this._videoFileInput);this._onVideoRemoved();var va=u.byTag(ca(this._gridID),'form');l.removeClass(va,"_4_8");j.reset(va);};qa.prototype.removeLoadingIndicator=function(ta){"use strict";var ua=this.getLoadingIndicator(ta);ua&&n.remove(ua.getRoot());delete this._loadingIndicators[ta];};qa.prototype._onFileUploadStart=function(ta,ua){"use strict";var va=ua.upload.getFile().uploadID,wa=n.find(this.getLoadingIndicator(va).getRoot(),"._639");l.show(wa);q.listen(wa,'click',function(){ua.upload.abort();this.fileUploadCanceled(va,ua);}.bind(this));this._uploadTimers[va]=Date.now();this.logStep(z.CLIENT_TRANSFER_BEGIN,{bytes:ua.upload.getFile().size});};qa.prototype._onProgress=function(ta,ua){"use strict";var va=this.getLoadingIndicator(ua.upload.getFile().uploadID);if(!va)return;l.hide(n.find(va.getRoot(),"._2om"));l.show(n.find(va.getRoot(),"._5e4h"));ka.updateProgressBar(va,ua.event);};qa.prototype._onFileUploadSuccess=function(ta,ua){"use strict";var va=Date.now()-this._uploadTimers[ta],wa={dt:va};if(ua.upload)wa.bytes=ua.upload.getFile().size;this.logStep(z.CLIENT_TRANSFER_SUCCESS,wa);};qa.prototype._onEditedImage=function(ta,ua){"use strict";this._onBeforeAddUploadedImages();this.logStep(z.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators([ua]);g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:1,method:y.EDITOR});var va=new i().setData(this._config.uploadData).setFiles([ua]).setAllowCrossOrigin(true).setURI(this._config.photoEndpoint);va.subscribe('failure',function(wa,xa){this.fileUploadFailure(xa.getFile().uploadID,{upload:xa});}.bind(this));va.subscribe('progress',function(wa,xa){this._onProgress(wa,{upload:xa,event:xa.getProgressEvent()});}.bind(this));va.subscribe('start',function(wa,xa){this._onFileUploadStart(wa,{upload:xa});}.bind(this));va.subscribe('success',function(wa,xa){this._onFileUploadSuccess(xa.getFile().uploadID,{upload:xa});}.bind(this));va.send();this.logStep(z.CLIENT_SELECT_SUCCESS,{volume:1,method:y.EDITOR});};qa.prototype.onFilesDrop=function(ta){"use strict";this._onBeforeAddUploadedImages();this.logStep(z.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators(ta);g.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:ta.length,method:y.DRAGDROP||'dragdrop'});var ua=new i().setData(this._config.uploadData).setFiles(ta).setAllowCrossOrigin(true).setURI(this._config.photoEndpoint);ua.subscribe('failure',function(va,wa){this.fileUploadFailure(wa.getFile().uploadID,{upload:wa});}.bind(this));ua.subscribe('progress',function(va,wa){this._onProgress(va,{upload:wa,event:wa.getProgressEvent()});}.bind(this));ua.subscribe('start',function(va,wa){this._onFileUploadStart(va,{upload:wa});}.bind(this));ua.subscribe('success',function(va,wa){this._onFileUploadSuccess(wa.getFile().uploadID,{upload:wa});}.bind(this));ua.send();this.logStep(z.CLIENT_SELECT_SUCCESS,{volume:ta.length,method:'drag_drop'});};qa.prototype._onBeforeAddUploadedImages=function(){"use strict";if(!this.sessionStarted)this.logStep(z.CLIENT_FLOW_BEGIN);if(this._config.maxselect==1)g.inform('multi-upload/composer-reset/'+this._gridID);this.sessionStarted=true;};qa.prototype.clearSession=function(){"use strict";this.sessionStarted=false;};qa.prototype.insertIntoGrid=function(ta){"use strict";var ua=n.scry(ca(this._gridID),"._577")[0];if(ua){n.insertBefore(ua,ta);}else n.prependContent(ca(this._gridID),ta);};qa.getInstance=function(ta){"use strict";la[ta]=la[ta]||new qa(ta);return la[ta];};function ra(ta){if(!sa(ta))return 1;return ta.files.length;}function sa(ta){return !!ta.files;}e.exports=ka;});
__d("EventValidator",["copyProperties"],function(a,b,c,d,e,f){'use strict';var g=b('copyProperties'),h={addValidation:function(k,l){var m=Object.keys(l),n=Object.create(k);g(n,{emit:function o(p,q,r,s,t,u,v){i(p,m);return k.emit.call(this,p,q,r,s,t,u,v);}});return n;}};function i(k,l){if(l.indexOf(k)===-1)throw new TypeError(j(k,l));}function j(k,l){var m='Unknown event type "'+k+'". ';m+='Known event types: '+l.join(', ')+'.';return m;}e.exports=h;});
__d("mixInEventEmitter",["EventEmitter","EventEmitterWithHolding","EventHolder","EventValidator","copyProperties","invariant","keyOf"],function(a,b,c,d,e,f){var g=b('EventEmitter'),h=b('EventEmitterWithHolding'),i=b('EventHolder'),j=b('EventValidator'),k=b('copyProperties'),l=b('invariant'),m=b('keyOf'),n=m({__types:true});function o(q,r){l(r);l(!this.__eventEmitter);var s=q.prototype||q,t=q.constructor;if(t)l(t===Object||t===Function);if(s.hasOwnProperty(n)){k(s.__types,r);}else if(s.__types){s.__types=k({},s.__types,r);}else s.__types=r;k(s,p);}var p={emit:function(q,r,s,t,u,v,w){return this.__getEventEmitter().emit(q,r,s,t,u,v,w);},emitAndHold:function(q,r,s,t,u,v,w){return this.__getEventEmitter().emitAndHold(q,r,s,t,u,v,w);},addListener:function(q,r,s){return this.__getEventEmitter().addListener(q,r,s);},once:function(q,r,s){return this.__getEventEmitter().once(q,r,s);},addRetroactiveListener:function(q,r,s){return this.__getEventEmitter().addRetroactiveListener(q,r,s);},addListenerMap:function(q,r){return this.__getEventEmitter().addListenerMap(q,r);},addRetroactiveListenerMap:function(q,r){return this.__getEventEmitter().addListenerMap(q,r);},removeAllListeners:function(){this.__getEventEmitter().removeAllListeners();},removeCurrentListener:function(){this.__getEventEmitter().removeCurrentListener();},releaseHeldEventType:function(q){this.__getEventEmitter().releaseHeldEventType(q);},__getEventEmitter:function(){if(!this.__eventEmitter){var q=new g();q=j.addValidation(q,this.__types);var r=new i();this.__eventEmitter=new h(q,r);}return this.__eventEmitter;}};e.exports=o;});
__d("GraphQLQuery",["createObjectFrom"],function(a,b,c,d,e,f){var g=b("createObjectFrom");function h(){"use strict";}h.prototype.addField=function(l){"use strict";if(this.fieldSet){this.fieldSet.fields.push(l);}else this.fieldSet=new k.FieldSet([l]);};h.prototype.addFields=function(l){"use strict";l.forEach(this.addField,this);};for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";this.rootCall=l;this.fieldSet=m;}k.prototype.toString=function(){"use strict";return (this.rootCall||'')+(this.fieldSet||'');};k.Call=(function(){function l(m,n){"use strict";this.name=m;this.args=n||[];}l.prototype.toString=function(){"use strict";return this.name+'('+this.args.join(',')+')';};return l;})();k.CallValue=(function(){function l(m){"use strict";this.callValue=m;}l.prototype.toString=function(){"use strict";return this.callValue.replace(/[)(}{><,.\\]/g,'\\$&');};return l;})();k.CallVariable=(function(){function l(m){"use strict";this.callVariableName=m;}l.prototype.toString=function(){"use strict";return '<'+this.callVariableName+'>';};return l;})();k.Field=(function(){for(i in h)if(h.hasOwnProperty(i))l[i]=h[i];l.prototype=Object.create(j);l.prototype.constructor=l;l.__superConstructor__=h;function l(m,n,o,p,q){"use strict";this.name=p||m;this.fieldName=m;this.calls=n||[];this.fieldSet=o;this.alias=p;this.condition=q;}l.prototype.toString=function(){"use strict";var m='';if(this.condition)m+=this.condition+'?';m+=this.fieldName;if(this.calls.length!==0)m+='.'+this.calls.join('.');if(this.alias)m+=' as '+this.alias;if(this.fieldSet)m+=this.fieldSet;return m;};l.prototype.addCall=function(m){"use strict";this.calls.push(m);};l.prototype.removeCalls=function(m){"use strict";var n=g(m),o=[];for(var p=0;p<this.calls.length;p++)if(!n[this.calls[p].name])o.push(this.calls[p]);this.calls=o;};return l;})();k.FieldSet=(function(){function l(m){"use strict";this.fields=m||[];}l.prototype.toString=function(){"use strict";return '{'+this.fields.join(',')+'}';};return l;})();e.exports=k;});
__d("GraphQLParser",["GraphQLQuery"],function(a,b,c,d,e,f){var g=b("GraphQLQuery");function h(k){"use strict";this.queryString=k;this.queryLength=k.length;this.index=-1;this.character=null;this.next();}h.prototype.error=function(k){"use strict";throw new h.SyntaxError(this.queryString,this.index,k);};h.prototype.next=function(k){"use strict";if(k&&k!==this.character)this.error('Expected "'+k+'" instead of "'+this.character+'".');this.index++;if(this.index>this.queryLength){this.error('Expected another character, but at end of string.');}else this.character=this.index===this.queryLength?null:this.queryString[this.index];};h.prototype.end=function(){"use strict";if(this.character)this.error('Expected end of string instead of '+this.character+'.');};h.prototype.whitespace=function(){"use strict";while(this.character===' '||this.character==='\t'||this.character==='\r'||this.character==='\n')this.next();};h.prototype.query=function(k){"use strict";var l=null;if(k){l=new g.Call(this.name(),this.callArguments());this.whitespace();}var m=null;if(this.character==='{')m=this.fieldSet();return new g(l,m);};h.prototype.name=function(){"use strict";var k=this.index;if(this.character===':')this.error('Name cannot begin with :');while(i(this.character))this.next();if(this.index===k)this.error('Expected name.');return this.queryString.substr(k,this.index-k);};h.prototype.fieldSet=function(){"use strict";var k=[];this.next('{');this.whitespace();k.push(this.field());this.whitespace();while(this.character===','){this.next(',');this.whitespace();k.push(this.field());this.whitespace();}this.next('}');return new g.FieldSet(k);};h.prototype.field=function(){"use strict";var k,l,m=this.name();this.whitespace();if(this.character==='?'){this.next('?');this.whitespace();k=this.name();l=m;}else k=m;this.whitespace();var n=this.calls(),o;if(this.character==='a'){this.next('a');this.next('s');this.whitespace();o=this.name();}this.whitespace();var p;if(this.character==='{')p=this.fieldSet();return new g.Field(k,n,p,o,l);};h.prototype.calls=function(){"use strict";var k=[];while(this.character==='.'){this.next('.');this.whitespace();k.push(new g.Call(this.name(),this.callArguments()));this.whitespace();}return k;};h.prototype.callArguments=function(){"use strict";this.next('(');this.whitespace();var k=[];if(this.character!==')'){k.push(this.callArgument());while(this.character===','){this.next(',');this.whitespace();k.push(this.callArgument());}}this.next(')');return k;};h.prototype.callArgument=function(){"use strict";return this.character==='<'?this.callVariable():this.callValue();};h.prototype.callVariable=function(){"use strict";this.next('<');var k=this.name();this.next('>');return new g.CallVariable(k);};h.prototype.callValue=function(){"use strict";var k=this.index,l=false;while(j(this.character)){if(this.character==='\\'){this.next();l=true;}this.next();}if(this.index===k)this.error('Expected call value.');var m=this.index-k,n=this.queryString.substr(k,m);n=n.replace(/\s+$/,'');if(l)for(var o=0;o<m;++o)if(n[o]==='\\'){n=n.substr(0,o)+n.substr(o+1);--m;}return new g.CallValue(n);};h.SyntaxError=(function(){for(var k in Error)if(Error.hasOwnProperty(k))m[k]=Error[k];var l=Error===null?null:Error.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=Error;function m(n,o,p){"use strict";this.queryString=n;this.character=o;this.parserError=p;this.message='Syntax error "'+p+'" at character '+o+' in query: '+n;}return m;})();function i(k){if(k===null)return false;return k==='_'||k===':'||k==='-'||(k>='0'&&k<='9')||(k>='A'&&k<='Z')||(k>='a'&&k<='z');}function j(k){if(k===null)return false;return k!='('&&k!=')'&&k!='{'&&k!='}'&&k!='<'&&k!='>'&&k!='.'&&k!=',';}h.parseQuery=function(k){var l=new h(k);l.whitespace();var m=l.query(true);l.whitespace();l.end();return m;};h.parseRootlessQuery=function(k){var l=new h(k);l.whitespace();var m=l.query(false);l.whitespace();l.end();return m;};e.exports=h;});
__d("PagedQuery",["GraphQLParser","GraphQLQuery","keyOf","isEmpty"],function(a,b,c,d,e,f){var g=b("GraphQLParser"),h=b("GraphQLQuery"),i=b("keyOf"),j=b("isEmpty");function k(l,m){"use strict";this.$PagedQuery0=l;this.$PagedQuery1=m;}k.prototype.$PagedQuery2=function(){"use strict";var l=this.findFieldByPath(this.$PagedQuery0);l.removeCalls(['find','after','before','first','last']);return l;};k.prototype.$PagedQuery3=function(l,m,n){"use strict";var o=this.$PagedQuery2(),p=n?'after':'before';o.addCall(new h.Call(p,[l]));var q=n?'first':'last';o.addCall(new h.Call(q,[m]));return this.$PagedQuery0.toString();};k.prototype.$PagedQuery4=function(l){"use strict";var m=this.$PagedQuery1[l];if(typeof m=='object'&&!j(m))return i(m);return null;};k.prototype.$PagedQuery5=function(l){"use strict";var m=this.$PagedQuery4(l);if(m)return m;return this.$PagedQuery1[l];};k.prototype.$PagedQuery6=function(l){"use strict";var m=this.$PagedQuery4(l);if(m)return this.$PagedQuery1[l][m];return this.$PagedQuery1[l];};k.prototype.pageAfterQueryString=function(l,m){"use strict";return this.$PagedQuery3(l,m,true);};k.prototype.pageBeforeQueryString=function(l,m){"use strict";return this.$PagedQuery3(l,m,false);};k.prototype.pageFirstQueryString=function(l){"use strict";var m=this.$PagedQuery2();m.addCall(new h.Call('first',[l]));return this.$PagedQuery0.toString();};k.prototype.pageLastQueryString=function(l){"use strict";var m=this.$PagedQuery2();m.addCall(new h.Call('last',[l]));return this.$PagedQuery0.toString();};k.prototype.findFieldByPath=function(l){"use strict";var m=l,n=this.$PagedQuery5(0);if(l.rootCall.name!=n)throw new Error("Query path does not match root query at top node, "+"expected "+n+", "+"found "+l.name+" instead.");for(var o=1;o<this.$PagedQuery1.length;o++){var p=m.fieldSet.fields,q=false,r=this.$PagedQuery5(o);for(var s=0;s<p.length;s++)if(p[s].fieldName==r){m=p[s];q=true;break;}if(!q)throw new Error("Query path does not match query structure at location "+o+", "+"expected "+r+", "+"not located in "+p);}return m;};k.prototype.findDataByPath=function(l){"use strict";var m=l;for(var n=0;n<this.$PagedQuery1.length;n++){var o=this.$PagedQuery6(n);if(!m||!m[o])throw new Error("Query path does not match payload at location "+n+", "+"expected "+o);m=m[o];}return m;};k.constructFromPath=function(l,m){return new k(g.parseQuery(l),m);};e.exports=k;});
__d("PagedQueryCacheCore",["KeyedCallbackManager","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b("KeyedCallbackManager"),h=b("copyProperties"),i=b("emptyFunction");function j(k,l,m,n){"use strict";this.$PagedQueryCacheCore0=k;this.$PagedQueryCacheCore1=l;this.$PagedQueryCacheCore2=h({enableLooping:false},n);var o=this.$PagedQueryCacheCore1.findDataByPath(m),p=o.edges;this.$PagedQueryCacheCore3=o.page_info;this.$PagedQueryCacheCore4=new g();this.$PagedQueryCacheCore5={};this.$PagedQueryCacheCore6={};this.$PagedQueryCacheCore7={};this.$PagedQueryCacheCore8=0;this.$PagedQueryCacheCore9=0;this.$PagedQueryCacheCorea={};this.$PagedQueryCacheCoreb(p,0);if(this.$PagedQueryCacheCore2.allDataLoaded)this.$PagedQueryCacheCorec();}j.prototype.$PagedQueryCacheCoreb=function(k,l){"use strict";var m={},n=false;for(var o=0;o<k.length;o++){if(this.hasLooped())break;var p=l+o,q=k[o].cursor,r=k[o].node,s=this.$PagedQueryCacheCore5[q];if(this.$PagedQueryCacheCore2.enableLooping&&s!==undefined){n=true;continue;}var t=this.$PagedQueryCacheCore4.getResource(p);if(t!==undefined&&t!=q)throw new Error('Attempting to add cursor '+q+' at location '+p+' which already contains cursor '+t);this.$PagedQueryCacheCore7[r.id]=q;this.$PagedQueryCacheCore6[q]=r;m[p]=q;this.$PagedQueryCacheCore5[q]=p;this.$PagedQueryCacheCore8=Math.min(p,this.$PagedQueryCacheCore8);this.$PagedQueryCacheCore9=Math.max(p,this.$PagedQueryCacheCore9);}if(n)this.$PagedQueryCacheCorec();this.$PagedQueryCacheCore4.addResourcesAndExecute(m);};j.prototype.getItemsAfterCursor=function(k,l,m){"use strict";return this.$PagedQueryCacheCored(k,l,true,m);};j.prototype.getItemsBeforeCursor=function(k,l,m){"use strict";return this.$PagedQueryCacheCored(k,l,false,m);};j.prototype.$PagedQueryCacheCoree=function(k){"use strict";if(!this.hasLooped())return k;var l=this.$PagedQueryCacheCoref.end-this.$PagedQueryCacheCoref.start+1;while(k<this.$PagedQueryCacheCoref.start||k>this.$PagedQueryCacheCoref.end)if(k<this.$PagedQueryCacheCoref.start){k+=l;}else k-=l;return k;};j.prototype.$PagedQueryCacheCored=function(k,l,m,n){"use strict";var o=this.$PagedQueryCacheCoreg(k);if(!m)o=o-l-1;var p=[];for(var q=1;q<=l;q++)p.push(this.$PagedQueryCacheCoree(o+q));var r=this.$PagedQueryCacheCore4.getUnavailableResourcesFromRequest(p);if(r.length){r=this.$PagedQueryCacheCoreh(r);if(!r.length)return;var s;if(m){if(this.$PagedQueryCacheCore2.enableLooping&&!this.hasNextPage(k)){s=this.$PagedQueryCacheCore1.pageFirstQueryString(l);}else s=this.$PagedQueryCacheCore1.pageAfterQueryString(k,l);}else if(this.$PagedQueryCacheCore2.enableLooping&&!this.hasPreviousPage(k)){s=this.$PagedQueryCacheCore1.pageLastQueryString(l);}else s=this.$PagedQueryCacheCore1.pageBeforeQueryString(k,l);for(var t=0;t<r.length;++t)this.$PagedQueryCacheCorea[r[t]]=true;this.$PagedQueryCacheCorei&&this.$PagedQueryCacheCorei();this.$PagedQueryCacheCore0(s,this.$PagedQueryCacheCore1,r,m?this.$PagedQueryCacheCore2.first_query:this.$PagedQueryCacheCore2.last_query,this.$PagedQueryCacheCore2.persistent_params,this.$PagedQueryCacheCorej.bind(this));}var u=function(v){var w=[];for(var x=0;x<l;x++)w.push(this.$PagedQueryCacheCore6[v[p[x]]]);return w;}.bind(this);return this.$PagedQueryCacheCore4.deferredExecuteOrEnqueue(p).then(u).addCallback(n,this);};j.prototype.$PagedQueryCacheCorej=function(){"use strict";this.$PagedQueryCacheCorek.apply(this,arguments);};j.prototype.$PagedQueryCacheCoreg=function(k){"use strict";var l=this.$PagedQueryCacheCore5[k];if(l===undefined)throw new Error("Cursor not found: the request can still be made but the result "+"would not link to the existing data");return l;};j.prototype.setPayloadCallback=function(k){"use strict";this.$PagedQueryCacheCorek=k;};j.prototype.updateData=function(k){"use strict";var l=this.$PagedQueryCacheCore1.findDataByPath(k.query_results),m=l&&l.edges;if(!m)return;for(var n=0;n<m.length;++n)this.$PagedQueryCacheCore6[m[n].cursor]=m[n].node;};j.prototype.addData=function(k){"use strict";var l=false,m=null,n=0;for(var o in k.query_params){if(o=='after'||o=='before')m=k.query_params[o];if(o=='first'||o=='last'){l=(o=='first');n=k.query_params[o];}}if(this.$PagedQueryCacheCore2.enableLooping&&!m)m=l?this.$PagedQueryCacheCore3.end_cursor:this.$PagedQueryCacheCore3.start_cursor;if(!m||this.$PagedQueryCacheCore5[m]===undefined)return;var p=this.$PagedQueryCacheCore5[m],q=this.$PagedQueryCacheCore1.findDataByPath(k.query_results);if(!q.edges.length){this.$PagedQueryCacheCorel(k.requested_indices);if(l){this.$PagedQueryCacheCore3.has_next_page=false;this.$PagedQueryCacheCore2.enableLooping&&this.getItemsAfterCursor(m,n,i);}else{this.$PagedQueryCacheCore3.has_previous_page=false;this.$PagedQueryCacheCore2.enableLooping&&this.getItemsBeforeCursor(m,n,i);}return;}var r;if(l){r=p+1;this.$PagedQueryCacheCore3.end_cursor=q.page_info.end_cursor;this.$PagedQueryCacheCore3.has_next_page=q.page_info.has_next_page;}else{r=p-q.edges.length;this.$PagedQueryCacheCore3.start_cursor=q.page_info.start_cursor;this.$PagedQueryCacheCore3.has_previous_page=q.page_info.has_previous_page;}this.$PagedQueryCacheCoreb(q.edges,r);this.$PagedQueryCacheCorel(k.requested_indices);};j.prototype.hasNextPage=function(k){"use strict";var l=this.$PagedQueryCacheCoreg(k);if(this.$PagedQueryCacheCore4.getResource(l+1)){return true;}else if(k==this.$PagedQueryCacheCore3.end_cursor){return this.$PagedQueryCacheCore3.has_next_page;}else throw new Error('hasNextPage called on unknown cursor');};j.prototype.hasPreviousPage=function(k){"use strict";var l=this.$PagedQueryCacheCoreg(k);if(this.$PagedQueryCacheCore4.getResource(l-1)){return true;}else if(k==this.$PagedQueryCacheCore3.start_cursor){return this.$PagedQueryCacheCore3.has_previous_page;}else throw new Error('hasPreviousPage called on unknown cursor');};j.prototype.hasLooped=function(){"use strict";return this.$PagedQueryCacheCore2.enableLooping&&this.$PagedQueryCacheCoref;};j.prototype.getItemAtIndex=function(k,l){"use strict";k=this.$PagedQueryCacheCoree(k);var m=function(n){l(this.$PagedQueryCacheCore6[n[k]]);}.bind(this);this.$PagedQueryCacheCore4.deferredExecuteOrEnqueue([k]).addCallback(m,this);};j.prototype.getItemAtIndexImmediate=function(k){"use strict";k=this.$PagedQueryCacheCoree(k);var l=this.$PagedQueryCacheCore4.getResource(k),m;if(l)m=this.$PagedQueryCacheCore6[l];return m;};j.prototype.getAvailableRange=function(){"use strict";var k=this.$PagedQueryCacheCoreg(this.$PagedQueryCacheCore3.start_cursor),l=this.$PagedQueryCacheCoreg(this.$PagedQueryCacheCore3.end_cursor);return {offset:k,length:l-k+1};};j.prototype.getCursorForID=function(k){"use strict";return this.$PagedQueryCacheCore7[k];};j.prototype.getIndexForID=function(k){"use strict";var l=this.getCursorForID(k);return (l!==undefined)?this.$PagedQueryCacheCore5[l]:undefined;};j.prototype.$PagedQueryCacheCorel=function(k){"use strict";if(k)for(var l=0;l<k.length;++l)delete(this.$PagedQueryCacheCorea[k[l]]);};j.prototype.$PagedQueryCacheCoreh=function(k){"use strict";if(!this.$PagedQueryCacheCorea)return k;var l=[];for(var m=0;m<k.length;++m)if(!this.$PagedQueryCacheCorea[k[m]])l.push(k[m]);return l;};j.prototype.$PagedQueryCacheCorec=function(){"use strict";this.$PagedQueryCacheCoref={start:this.$PagedQueryCacheCore8,end:this.$PagedQueryCacheCore9};};j.prototype.setPreFetchCallback=function(k){"use strict";this.$PagedQueryCacheCorei=k;};e.exports=j;});
__d("isRTL",[],function(a,b,c,d,e,f){var g='A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF'+'\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF',h='\u0591-\u07FF\u200F\uFB1D-\uFDFF\uFE70-\uFEFC',i=new RegExp('^[^'+g+']*['+h+']'),j=new RegExp('['+g+']');function k(l){var m=0,n=0;l.split(/\s+/,20).forEach(function(o){if(/^https?:\/\//.test(o))return;if(i.test(o)){n++;m++;}else if(j.test(o))m++;});return !!(m&&(n/m>.4));}e.exports=k;});
__d("FileFormResetOnSubmit",["DOMQuery"],function(a,b,c,d,e,f){var g=b('DOMQuery');function h(i){"use strict";this._form=i;}h.prototype.enable=function(){"use strict";this._subscription=this._form.subscribe('submit',Function.prototype.defer.bind(this._reset.bind(this)));};h.prototype.disable=function(){"use strict";this._subscription.unsubscribe();this._subscription=null;};h.prototype._reset=function(){"use strict";var i=g.scry(this._form.getRoot(),'input[type="file"]');i.forEach(function(j){j.value='';});};e.exports=h;});
__d("FormSubmitOnChange",["Event","copyProperties","submitForm"],function(a,b,c,d,e,f){var g=b('Event'),h=b('copyProperties'),i=b('submitForm');function j(k){"use strict";this._form=k;}j.prototype.enable=function(){"use strict";this._listener=g.listen(this._form.getRoot(),'change',this._submit.bind(this));};j.prototype.disable=function(){"use strict";this._listener.remove();this._listener=null;};j.prototype._submit=function(){"use strict";i(this._form.getRoot());};h(j.prototype,{_listener:null});e.exports=j;});
__d("MercuryFileUploader",["ArbiterMixin","CSS","Dialog","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","MercuryAttachment","MercuryAttachmentTemplates","MercuryConstants","PhotosUploadID","SubscriptionsHandler","csx","fbt","getObjectValues","mixin","shield","startsWith","tx"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('Event'),l=b('FileForm'),m=b('FileFormResetOnSubmit'),n=b('FileInput'),o=b('FormSubmitOnChange'),p=b('MercuryAttachment'),q=b('MercuryAttachmentTemplates'),r=b('MercuryConstants'),s=b('PhotosUploadID'),t=b('SubscriptionsHandler'),u=b('csx'),v=b('fbt'),w=b('getObjectValues'),x=b('mixin'),y=b('shield'),z=b('startsWith'),aa=b('tx'),ba=x(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(ga,ha,ia,ja){"use strict";this.$MercuryFileUploader0=ga;this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader6=new t();this.$MercuryFileUploader7=new l(ha,[o,m]);this.$MercuryFileUploader7.setAllowCrossOrigin(true);this.$MercuryFileUploader7.setUploadInParallel(true);var ka=j.find(ha,"._4q60"),la=j.find(ka,"._4q61");new n(ka,la,ia);h.hide(this.$MercuryFileUploader0);this.$MercuryFileUploader6.addSubscriptions(this.$MercuryFileUploader7.subscribe('submit',function(){var ma={count:0,file_sizes:[]};if(ia.files){for(var na=0;na<ia.files.length;na++)if(ia.files[na].size>r.AttachmentMaxSize){this.$MercuryFileUploader7.abort();this.$MercuryFileUploader7.clear();new i().setTitle("The file you have selected is too large").setBody("The file you have selected is too large. The maximum size is 25MB.").setButtons(i.OK).setSemiModal(true).show();return false;}var oa={};for(var pa=0;pa<ia.files.length;pa++){var qa=this.$MercuryFileUploader8();this.$MercuryFileUploader9(qa,ia.files[pa].name);ma.count++;ma.file_sizes.push(ia.files[pa].size);oa[qa]=ia.files[pa];}this.$MercuryFileUploader7.setFiles(oa);}else{ja.value=this.$MercuryFileUploader8();this.$MercuryFileUploader9(ja.value,ia.value);ma.count=1;}this.inform('submit',ma);}.bind(this)),this.$MercuryFileUploader7.subscribe('success',this.$MercuryFileUploadera.bind(this)),this.$MercuryFileUploader7.subscribe('failure',this.$MercuryFileUploaderb.bind(this)),k.listen(la,'click',y(this.inform,this,'open')));}ea.prototype.isUploading=function(){"use strict";return !!Object.keys(this.$MercuryFileUploader3).length;};ea.prototype.addCachedAttachments=function(ga){"use strict";ga.forEach(function(ha){var ia=this.$MercuryFileUploader8();this.$MercuryFileUploader9(ia,ha.filename);this.$MercuryFileUploaderc(ia,ha);}.bind(this));};ea.prototype.addCachedImageFiles=function(ga){"use strict";var ha="Photo";ga.forEach(function(ia){var ja=this.$MercuryFileUploader8();this.$MercuryFileUploader9(ja,ha);this.$MercuryFileUploaderc(ja,{filename:ia,image_id:ia,filetype:'image/jpeg'});}.bind(this));};ea.prototype.getAttachments=function(){"use strict";return w(this.$MercuryFileUploader1);};ea.prototype.getImageFiles=function(){"use strict";return w(this.$MercuryFileUploader2);};ea.prototype.removeAttachments=function(){"use strict";w(this.$MercuryFileUploader4).forEach(function(ga){if(ga)j.remove(ga.getRoot());});this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader4={};this.$MercuryFileUploader3={};this.$MercuryFileUploader5={};h.hide(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.destroy=function(){"use strict";this.$MercuryFileUploader6&&this.$MercuryFileUploader6.release();this.$MercuryFileUploader7&&this.$MercuryFileUploader7.destroy();this.removeAttachments();};ea.prototype.$MercuryFileUploader9=function(ga,ha){"use strict";var ia=q[':fb:mercury:upload-file-row'].build();this.$MercuryFileUploader4[ga]=ia;this.$MercuryFileUploader3[ga]=true;this.$MercuryFileUploader5[ga]=Date.now();j.appendContent(ia.getNode('iconText'),fa(ha));k.listen(ia.getNode('closeFileUpload'),'click',this.$MercuryFileUploaderd.bind(this,ga));j.appendContent(this.$MercuryFileUploader0,ia.getRoot());h.show(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.$MercuryFileUploaderd=function(ga,event){"use strict";if(this.$MercuryFileUploader3[ga]){this.inform('upload-canceled-during-upload');}else if(this.$MercuryFileUploader1[ga]||this.$MercuryFileUploader2[ga])this.inform('upload-canceled-after-uploaded');delete this.$MercuryFileUploader1[ga];delete this.$MercuryFileUploader2[ga];delete this.$MercuryFileUploader3[ga];delete this.$MercuryFileUploader5[ga];var ha=this.$MercuryFileUploader4[ga];delete this.$MercuryFileUploader4[ga];if(ha){j.remove(ha.getRoot());this.inform('dom-updated');}this.inform('upload-canceled');return false;};ea.prototype.$MercuryFileUploadere=function(ga,ha){"use strict";var ia=this.$MercuryFileUploader4[ga],ja=p.getAttachIconClassByMime(ha);h.addClass(ia.getNode('iconText'),ja);h.addClass(ia.getRoot(),'done');};ea.prototype.$MercuryFileUploaderc=function(ga,ha){"use strict";if(this.$MercuryFileUploader3[ga]){delete this.$MercuryFileUploader3[ga];if(ha.image_id){this.$MercuryFileUploader2[ga]=ha.image_id;}else this.$MercuryFileUploader1[ga]=ha;this.$MercuryFileUploadere(ga,ha.filetype);this.inform('one-upload-completed',{upload_time_ms:Date.now()-this.$MercuryFileUploader5[ga]});}if(!this.isUploading())this.inform('all-uploads-completed',{count:this.getAttachments().length});};ea.prototype.$MercuryFileUploadera=function(event,ga){"use strict";var ha=ga.response.getPayload(),ia;if(ga.upload){ia=ga.upload.getName();}else ia=ha.uploadID;this.$MercuryFileUploaderc(ia,ha.metadata[0]);};ea.prototype.$MercuryFileUploaderb=function(event,ga){"use strict";this.inform('one-upload-failed');};ea.prototype.$MercuryFileUploader8=function(){"use strict";return 'upload_'+s.getNewID();};function fa(ga){if(ga&&z(ga,'C:\\fakepath\\'))return ga.substring(12);return ga;}e.exports=ea;});
__d("URLScraper",["ArbiterMixin","DataStore","Event","URLMatcher","copyProperties","mixin"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DataStore'),i=b('Event'),j=b('URLMatcher'),k=b('copyProperties'),l='scraperLastPermissiveMatch',m=b("mixin"),n=m(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(r){"use strict";this.input=r;this.enable();}q.prototype.reset=function(){"use strict";h.set(this.input,l,null);};q.prototype.enable=function(){"use strict";if(this.events)return;var r=function(s){setTimeout(this.check.bind(this,s),30);};this.events=i.listen(this.input,{paste:r.bind(this,false),keydown:r.bind(this,true)});};q.prototype.disable=function(){"use strict";if(!this.events)return;for(var event in this.events)this.events[event].remove();this.events=null;};q.prototype.check=function(r){"use strict";var s=this.input.value;if(r&&q.trigger(s))return;var t=q.match(s),u=j.permissiveMatch(s);if(u&&(u!=h.get(this.input,l))){h.set(this.input,l,u);this.inform('match',{url:t||u,alt_url:u});}};k(q,j);e.exports=q;});
__d("MercuryShareLinkUploader",["ArbiterMixin","AsyncRequest","CSS","DOM","Form","URLScraper","WebMessengerEvents","mixin","Event"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('Form'),l=b('URLScraper'),m=b('WebMessengerEvents'),n=b('mixin'),o=b('Event'),p=n(g);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t,u,v,w,x){"use strict";this.$MercuryShareLinkUploader0=t;this.$MercuryShareLinkUploader1=u;this.$MercuryShareLinkUploader2=v;this.$MercuryShareLinkUploader3=x;this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;o.listen(w,'click',this.close.bind(this));o.listen(x,'keyup',function(){!x.value.length&&this.$MercuryShareLinkUploader7.enable();}.bind(this));this.$MercuryShareLinkUploader7=new l(x);this.$MercuryShareLinkUploader7.subscribe('match',function(y,z){this.loadShare(z&&z.url);}.bind(this));}s.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$MercuryShareLinkUploader4,this.$MercuryShareLinkUploader0,this.$MercuryShareLinkUploader3);};s.prototype.loadAttachData=function(t,u,v){"use strict";if(t){var w=k.serialize(u),x=w.attachment&&w.attachment.params,y=w.link_metrics?w.link_metrics.no_image:true;if(!x||!x.url)return null;if(v.value.indexOf(x.url)===-1)return w;if(!x.summary&&!x.favicon&&y){var z=x.url.substr(0,x.title.length);if(!x.title||x.title===z)return null;}return w;}return null;};s.prototype.check=function(){"use strict";this.$MercuryShareLinkUploader7.check();};s.prototype.close=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.disable();this.inform('closed');};s.prototype.clear=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.enable();};s.prototype.enable=function(){"use strict";this.$MercuryShareLinkUploader7.enable();};s.prototype.disable=function(){"use strict";this.$MercuryShareLinkUploader7.disable();};s.prototype.loadShare=function(t){"use strict";this.$MercuryShareLinkUploader5=t;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=new h().setMethod('POST').setURI('/ajax/share_scrape.php').setData({u:t}).setHandler(this.$MercuryShareLinkUploader9.bind(this).curry(t)).setStatusElement(this.$MercuryShareLinkUploader2);this.$MercuryShareLinkUploader6.send();this.inform('link-detected');};s.prototype.$MercuryShareLinkUploader9=function(t,u){"use strict";if(this.$MercuryShareLinkUploader5!==t)return;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;i.show(this.$MercuryShareLinkUploader0);j.empty(this.$MercuryShareLinkUploader1);j.setContent(this.$MercuryShareLinkUploader1,u.payload);this.$MercuryShareLinkUploader4=true;if(!this.getAttachData()){this.close();return;}m.detailDOMChanged();};s.prototype.$MercuryShareLinkUploader8=function(){"use strict";i.hide(this.$MercuryShareLinkUploader0);this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=null;this.$MercuryShareLinkUploader7.reset();m.detailDOMChanged();};e.exports=s;});
__d("JoinableConversationMessageFilter",["MercuryLogMessageType","MercuryThreads","MercuryParticipants"],function(a,b,c,d,e,f){var g=b('MercuryLogMessageType'),h=b('MercuryThreads').get(),i=b('MercuryParticipants'),j={_isFilterable:function(k){var l=k.log_message_type;if(!l)return false;if(l==g.JOINABLE_JOINED)return k.log_message_data.joined_participant!==i.user;if(l==g.UNSUBSCRIBE||l==g.SUBSCRIBE){var m=h.getThreadMetaNow(k.thread_id);if(m&&m.is_joinable)return k.author!==i.user;return false;}return false;},filterMessages:function(k,l,m){var n=[];for(var o=0;o<l.length;o++){var p=l[o];if(j._isFilterable(p)){if(m)k(p);}else n.push(p);}return n;}};e.exports=j;});
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatConfig","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areObjectsEqual","copyProperties","csx","shield"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('ChatConfig'),j=b('ChatTabModel'),k=b('Dock'),l=b('DOM'),m=b('DOMDimensions'),n=b('Event'),o=b('Parent'),p=b('Vector'),q=b('ViewportBounds'),r=b('areObjectsEqual'),s=b('copyProperties'),t=b('csx'),u=b('shield'),v=164,w=264,x=175,y=269;function z(){if(i.get('litestand')||i.get('litestand_classic_sidebar'))return x;return v;}function aa(){if(i.get('litestand')||i.get('litestand_classic_sidebar'))return y;return w;}function ba(ca){this._root=ca;var da=this._recalculateWidth.bind(this);n.listen(window,'resize',da);k.subscribe('resize',da);g.subscribe(['LitestandSidebar/expand','LitestandSidebar/collapse'],da);g.subscribeOnce(['sidebar/initialized','LitestandSidebar/initialized'],da,g.SUBSCRIBE_NEW);j.subscribe('chat/tabs-changed',u(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}s(ba.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var ca=ba._getAvailableDockWidth(this._root),da=Math.max(1,Math.floor(ca/aa())),ea=da!=this._maxShown;if(!this._viewState||ea||ca<=this._viewState.usedWidth||ca>this._viewState.widthToShowNext){this._availableWidth=ca;this._maxShown=da;this._viewState=null;this._recalculateTabs(ea);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(ca){var da=ba._getTabsToShow(j.get(),this._availableWidth);if(ca||!r(this._viewState,da)){this._viewState=da;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>aa();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var ca=j.get(),da=this._viewState.tabsToShow;return ca.tabs.filter(function(ea){return da[ea.id];});},getRightmostHiddenTab:function(){var ca=j.get(),da=this._viewState.tabsToShow,ea=ca.tabs.filter(function(ga){return !da[ga.id];}),fa=ea.shift();return fa?fa.id:null;},getLeftmostVisibleTab:function(){var ca=this.getShowingTabsOrder(),da=ca.pop();return da?da.id:null;},shouldPromoteOnRaise:function(ca){if(!this._viewState.tabsToShow[ca])return true;if(this._viewState.nextToHide!=ca)return false;var da=j.getTab(ca),ea=da&&da.raised;return !ea&&(this._availableWidth-this._viewState.usedWidth<aa()-z());}});s(ba,{_getAvailableDockWidth:function(ca){var da=m.getViewportWithoutScrollbarDimensions().width;da-=q.getLeft()+q.getRight();da-=50;var ea=o.byClass(ca,'fbDock'),fa=l.find(ea,"._56ox"),ga=p.getElementDimensions(fa).x;da-=ga;var ha=l.find(ea,"._56oy");ga+=p.getElementDimensions(ha).x;var ia=p.getElementDimensions(ea),ja=ia.x-ga;da-=ja;da-=15;return Math.max(da,0);},_getTabsToShow:function(ca,da){da=Math.max(da,aa()+1);function ea(ua,va){if(i.get('chat_tabs_management')){return (ua.raised||!va)?aa():z();}else return ua.raised?aa():z();}var fa=JSON.parse(JSON.stringify(ca.tabs)),ga=-1,ha=null;if(ca.promoted)fa.forEach(function(ua,va){if(ua.id===ca.promoted){ga=va;ha=ua;}});var ia=0,ja=false,ka=0,la=!ha;fa.forEach(function(ua,va){var wa=ea(ua,ja);ja=ja||!ua.raised;var xa=i.get('chat_tabs_management')?wa:aa();ua.leftmostOffset=ia+xa;ia+=wa;if(ua.leftmostOffset<da)ka++;la|=va==ga;ua.alreadyPlacedPromoted=la;});function ma(ua,va,wa){var xa={};for(var ya=0;ya<va;ya++){var za=ua[ya];if(!za.alreadyPlacedPromoted&&ya==va-1){xa[wa]=true;}else xa[za.id]=true;}return xa;}var na=ma(fa,ka,ca.promoted),oa=ma(fa,ka-1,ca.promoted),pa=null;for(var qa in na)if(!oa[qa])pa=qa;var ra=fa[ka-1],sa=ra?ra.leftmostOffset:0,ta=Infinity;if(ka<fa.length)ta=fa[ka].leftmostOffset;return {nextToHide:pa,tabsToShow:na,usedWidth:sa,widthToShowNext:ta};}});e.exports=ba;});
__d("MercuryThreadMuter",["AsyncDialog","AsyncRequest","DOM","Env","MercuryThreads"],function(a,b,c,d,e,f){var g=b('AsyncDialog'),h=b('AsyncRequest'),i=b('DOM'),j=b('Env'),k=b('MercuryThreads').get(),l={getUserIDEmail:function(){return j.user+'@facebook.com';},getThreadMuteSettingForUser:function(m){return m.mute_settings&&m.mute_settings[l.getUserIDEmail()];},isThreadMuted:function(m){return l.getThreadMuteSettingForUser(m)!==undefined;},showMuteChangeDialog:function(m){g.send(new h('/ajax/mercury/mute_thread_dialog.php'),function(n){n.subscribe('confirm',function(){this.hide();var o;i.scry(this.getRoot(),'input[type="radio"]').forEach(function(r){if(r.checked)o=r.value;});switch(o){case 'always':o=-1;break;case '1hour':o=3600;break;case '8am':var p=new Date(),q=new Date();q.setHours(8);q.setMinutes(0);q.setSeconds(0);if(q>p){o=q-p;}else o=q-p+(24*3600);o/=1000;break;default:o=0;}k.updateThreadMuteSetting(m,o);}.bind(n));});}};e.exports=l;});
__d("JoinStatusTabSheet",["copyProperties","DOM","MercuryLogMessageType","MercuryParticipants"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('DOM'),i=b('MercuryLogMessageType'),j=b('MercuryParticipants');function k(l,m){this._rootElement=l;this._messageQueue=[];this._sheetView=m;}g(k.prototype,{_setMessage:function(l,m){var n=l.author,o=l.log_message_type;if(o==i.JOINABLE_JOINED){var p=l.log_message_data.joined_participant;if(p!==j.user)j.get(p,function(s){h.setContent(m,h.tx._("{actor} joined the chat.",{actor:s.name}));});}else if(o==i.UNSUBSCRIBE){if(n!==j.user)j.get(n,function(s){h.setContent(m,h.tx._("{actor} left the conversation.",{actor:s.name}));});}else if(o==i.SUBSCRIBE)if(n!==j.user){var q=l.log_message_data.added_participants;if(q&&q.length>0){var r=[n,q[0]];j.getMulti(r,function(s){h.setContent(m,h.tx._("{actor} added {subscriber1}.",{actor:s[n].name,subscriber1:s[q[0]].name}));});}}},isPermanent:function(){return false;},getCloseTimeout:function(){return 3000;},getType:function(){return 'join_status_type';},addToQueue:function(l){this._messageQueue.push(l);if(this._messageQueue.length===1)this._open();},render:function(){var l=this._messageQueue[0],m=this._getTemplate().build();this._setMessage(l,m.getNode('text'));h.setContent(this._rootElement,m.getRoot());},_open:function(){this._sheetView.open(this);},autoCloseCallback:function(){this._messageQueue.shift();if(this._messageQueue.length>0)this._open();},couldNotReplace:function(){this._open.bind(this).defer(this.getCloseTimeout(),false);}});e.exports=k;});
__d("TextInputControl",["function-extensions","DOMControl","Event","Input","copyProperties","debounce"],function(a,b,c,d,e,f){b('function-extensions');var g=b('DOMControl'),h=b('Event'),i=b('Input'),j=b('copyProperties'),k=b('debounce');for(var l in g)if(g.hasOwnProperty(l))n[l]=g[l];var m=g===null?null:g.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=g;function n(o){"use strict";g.call(this,o);var p=this.getRoot(),q=k(this.update.bind(this),0);h.listen(p,{input:q,keydown:q,paste:q});}n.prototype.setMaxLength=function(o){"use strict";i.setMaxLength(this.getRoot(),o);return this;};n.prototype.getValue=function(){"use strict";return i.getValue(this.getRoot());};n.prototype.isEmpty=function(){"use strict";return i.isEmpty(this.getRoot());};n.prototype.setValue=function(o){"use strict";i.setValue(this.getRoot(),o);this.update();return this;};n.prototype.clear=function(){"use strict";return this.setValue('');};n.prototype.setPlaceholderText=function(o){"use strict";i.setPlaceholder(this.getRoot(),o);return this;};e.exports=n;});
__d("TextAreaControl",["Arbiter","ArbiterMixin","CSS","DOMControl","Event","Style","TextInputControl","TextMetrics","classWithMixins","mixin"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('CSS'),j=b('DOMControl'),k=b('Event'),l=b('Style'),m=b('TextInputControl'),n=b('TextMetrics'),o=b('classWithMixins'),p=b('mixin');function q(v,w){return l.getFloat(v,w)||0;}var r=o(m,p(h));for(var s in r)if(r.hasOwnProperty(s))u[s]=r[s];var t=r===null?null:r.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=r;function u(v){"use strict";this.autogrow=i.hasClass(v,'uiTextareaAutogrow');r.call(this,v);this.width=null;k.listen(v,'focus',this._handleFocus.bind(this));}u.prototype.setAutogrow=function(v){"use strict";this.autogrow=v;return this;};u.prototype.onupdate=function(){"use strict";t.onupdate.call(this);if(this.autogrow){var v=this.getRoot();if(!this.metrics)this.metrics=new n(v);if(typeof this.initialHeight==='undefined'){this.isBorderBox=l.get(v,'box-sizing')==='border-box'||l.get(v,'-moz-box-sizing')==='border-box'||l.get(v,'-webkit-box-sizing')==='border-box';this.borderBoxOffset=q(v,'padding-top')+q(v,'padding-bottom')+q(v,'border-top-width')+q(v,'border-bottom-width');this.initialHeight=v.offsetHeight-this.borderBoxOffset;}var w=this.metrics.measure(),x=Math.max(this.initialHeight,w.height);if(this.isBorderBox)x+=this.borderBoxOffset;if(x!==this.height){this.height=x;l.set(v,'height',x+'px');g.inform('reflow');this.inform('resize');}}else if(this.metrics){this.metrics.destroy();this.metrics=null;}};u.prototype.resetHeight=function(){"use strict";this.height=-1;this.update();};u.prototype._handleFocus=function(){"use strict";this.width=null;};u.getInstance=function(v){"use strict";return j.getInstance(v)||new u(v);};e.exports=u;});
__d("MessagesEmoticonView",["DOM","EmoticonsList","Event","Focus","InputSelection","Keys","Parent","SubscriptionsHandler","TextAreaControl","Toggler","copyProperties","endsWith","startsWith"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('EmoticonsList'),i=b('Event'),j=b('Focus'),k=b('InputSelection'),l=b('Keys'),m=b('Parent'),n=b('SubscriptionsHandler'),o=b('TextAreaControl'),p=b('Toggler'),q=b('copyProperties'),r=b('endsWith'),s=b('startsWith'),t=h.symbols;function u(w,x,y){var z=m.byClass(w,'emoticon');if(!z)return;var aa='emoticon_',ba=null;z.className.split(' ').forEach(function(ia){if(s(ia,aa))ba=ia.substring(aa.length);});if(!t[ba])return;var ca=o.getInstance(x),da=ca.getValue(),ea=t[ba],fa=da.substring(0,y.start),ga=da.substring(y.end);if(y.start>0&&!r(fa,' '))ea=' '+ea;if(!s(ga,' '))ea+=' ';var ha=fa+ea+ga;y.start+=ea.length;y.end=y.start;ca.setValue(ha);k.set(x,y.start,y.end);return true;}function v(w,x){var y={start:0,end:0};function z(){y=k.get(x);}var aa=g.find(w,'.uiToggleFlyout');this._subscriptions=new n();this._subscriptions.addSubscriptions(p.subscribe('show',function(ba,ca){if(ca.active&&g.contains(w,ca.active)){k.set(x,y.start,y.end);var da=g.scry(aa,'a.emoticon')[0];da&&j.setWithoutOutline(da);}}),i.listen(aa,'click',function(event){var ba=u(event.getTarget(),x,y);ba&&p.hide(w);}),i.listen(aa,'keyup',function(event){if(event.keyCode===l.ESC){p.hide(w);k.set(x,y.start,y.end);}}),i.listen(x,'keyup',z),i.listen(x,'click',z));}q(v.prototype,{destroy:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;}});q(v,{create:function(w,x){return new v(w,x);}});e.exports=v;});
__d("MercuryRoger",["ArbiterMixin","MercuryActionStatus","MercuryServerRequests","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('MercuryActionStatus'),i=b('MercuryServerRequests').get(),j=b('copyProperties'),k={},l={getSeenBy:function(m,n){if(!m)return [];var o=[],p=k[m.thread_id],q=h.SUCCESS;for(var r in p)if(p[r]>m.timestamp&&(m.status===undefined||m.status===q)&&(!n||r!=m.author))o.push(r);return o;},getSeenTimestamp:function(m,n){var o=k[m];return o?o[n]:null;}};j(l,g);i.subscribe('update-roger',function(m,n){for(var o in n){if(!k[o])k[o]={};for(var p in n[o]){var q=k[o][p],r=n[o][p];if(!q||r>q)k[o][p]=r;}}if(n)l.inform('state-changed',n);});e.exports=l;});
__d("MercuryDelayedRoger",["ArbiterMixin","LiveTimer","MercuryActionStatus","MercuryConfig","MercuryMessages","MercuryRoger","MercuryThreadInformer","MercuryThreads","copyProperties","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('LiveTimer'),i=b('MercuryActionStatus'),j=b('MercuryConfig'),k=b('MercuryMessages').get(),l=b('MercuryRoger'),m=b('MercuryThreadInformer').get(),n=b('MercuryThreads').get(),o=b('copyProperties'),p=b('setTimeoutAcrossTransitions'),q={},r={},s=j['roger.seen_delay'],t=o({getSeenBy:function(x,y){if(r[x])return [];if(!q[x]){var z=n.getThreadMetaNow(x);if(z)q[x]={thread_id:x,author:z.participants[0],timestamp:z.timestamp};}return l.getSeenBy(q[x],y);}},g);function u(x){var y=false;k.getThreadMessagesRange(x,0,1,function(z){var aa=z[0];if(!aa)return;var ba=aa.timestamp;if(aa.action_id||aa.status==i.SUCCESS)ba-=h.getServerTimeOffset();var ca=t.getSeenBy(x);if(r[x]){clearTimeout(r[x]);delete r[x];}var da=ba+s,ea=da-Date.now();if(ea>0)r[x]=p(function(){delete r[x];v(x);},ea);q[x]=aa;var fa=t.getSeenBy(x);if(ca.length||fa.length)y=true;});return y;}function v(x){var y={};y[x]=true;t.inform('state-changed',y);}function w(event,x){var y={};for(var z in x)if(u(z))y[z]=true;for(var aa in y){t.inform('state-changed',y);break;}}l.subscribe('state-changed',function(x,y){for(var z in y)!r[z]&&v(z);});m.subscribe('messages-received',w);m.subscribe('messages-reordered',w);m.subscribe('messages-updated',w);e.exports=t;});
__d("MercuryTypingReceiver",["Arbiter","ChannelConstants","MercuryActionTypeConstants","MercuryParticipants","MercuryPayloadSource","MercuryServerRequests","MercuryThreads","TypingDetector","mixInEventEmitter","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('MercuryActionTypeConstants'),j=b('MercuryParticipants'),k=b('MercuryPayloadSource'),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get(),n=b('TypingDetector'),o=b('mixInEventEmitter'),p=b('setTimeoutAcrossTransitions'),q,r={},s=30000,t={};o(t,{'state-changed':true});function u(aa){var ba=r[aa]||{},ca=Object.keys(ba);ca.sort(function(da,ea){return ba[da]-ba[ea];});return ca;}function v(){q=null;var aa=Date.now(),ba={},ca=false;for(var da in r){var ea=false;for(var fa in r[da]||{})if(r[da][fa]<aa-s){delete r[da][fa];ea=true;}else ca=true;if(ea)ba[da]=u(da);}for(var ga in ba){x(ba);break;}if(ca)q=p(v,3000);}function w(aa,ba){if(aa in r)if(ba in r[aa]){delete r[aa][ba];y(aa);}}function x(aa){t.releaseHeldEventType('state-changed');t.emitAndHold('state-changed',aa);}function y(aa){var ba={};ba[aa]=u(aa);x(ba);}function z(aa){if(aa.thread)return l.getClientThreadIDNow(aa.thread);if(aa.type==='typ')return m.getThreadIdForUser(aa.from);return null;}g.subscribe([h.getArbiterType('typ'),h.getArbiterType('ttyp')],function(aa,ba){var ca=ba.obj,da=z(ca);if(da){var ea=j.getIDForUser(ca.from);if(ca.st==n.TYPING){r[da]=r[da]||{};var fa=r[da][ea];r[da][ea]=Date.now();if(!q)q=p(v,3000);!fa&&y(da);}else if(ca.st==n.INACTIVE)w(da,ea);}});l.subscribe('update-typing-state',function(aa,ba){var ca=ba.payload_source;if(ca!=k.CLIENT_CHANNEL_MESSAGE)return;var da=ba.actions;if(!da||!da.length)return;var ea=i.USER_GENERATED_MESSAGE;da.forEach(function(fa){if(fa.action_type==ea&&fa.author!=j.user)w(fa.thread_id,fa.author);});});e.exports=t;});
__d("MercuryIndicatorController",["ArbiterMixin","DOM","MercuryActionTypeConstants","MercuryConfig","MercuryDelayedRoger","MercuryMessageSourceTags","MercuryParticipants","MercuryRoger","MercuryThreads","MercuryTypingReceiver","arrayContains","copyProperties","formatDate","removeFromArray","tx"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DOM'),i=b('MercuryActionTypeConstants'),j=b('MercuryConfig'),k=b('MercuryDelayedRoger'),l=b('MercuryMessageSourceTags'),m=b('MercuryParticipants'),n=b('MercuryRoger'),o=b('MercuryThreads').get(),p=b('MercuryTypingReceiver'),q=b('arrayContains'),r=b('copyProperties'),s=b('formatDate'),t=b('removeFromArray'),u=b('tx'),v=[];function w(x){this._threadID=x;this._canonicalUser=o.getCanonicalUserInThread(x);v.push(this);}r(w.prototype,g,{destroy:function(){t(v,this);},setLastMessage:function(x){this._lastMsg=x;this._handleStateChange();},_informStateChanged:function(x){if(x.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&m.isAuthor(this._lastMsg.author))x.self_authored=true;this._currentActivity=x.activity;this.inform('state-changed',x);},_notifySentFrom:function(){var x,y,z=this._lastMsg.location_text,aa=this._lastMsg.source_tags||[];if(z){x=u._("Sent from {location}",{location:z});y='sentFromMobile';}else if(q(aa,l.MESSENGER)){x=h.create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},"Sent from Messenger");y='sentFromMobile';}else if(q(aa,l.MOBILE)){x=h.create('a',{href:'/mobile','class':'fcg',target:'_blank'},"Sent from Mobile");y='sentFromMobile';}else if(q(aa,l.EMAIL)){x="Sent from email";y='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:y,text:x});},_notifySeenTimestamp:function(x){var y=n.getSeenTimestamp(this._threadID,x[0])*.001,z=Date.now()*.001,aa;if(y<z-518400){aa='M j';}else if(y<z-86400){aa='D g:ia';}else aa='g:ia';this._informStateChanged({activity:'seen-timestamp',text:u._("Seen {timestamp}",{timestamp:s(y,aa)})});},_checkNamesForCollision:function(x,y){var z=false;m.getMulti(x,function(aa){function ba(ea){if(typeof aa[ea]!=="undefined"){return aa[ea].short_name.toLowerCase();}else return ea;}var ca=y.map(ba),da=x.map(ba);z=ca.some(function(ea){return da.indexOf(ea)!==da.lastIndexOf(ea);});});return z;},_notifySeenBy:function(x){var y=this._lastMsg,z=true;m.getMulti(x,function(aa){z=false;if(this._lastMsg!=y)return;var ba=o.getThreadMetaNow(this._threadID),ca=ba?ba.participants.length:0,da=x.length+(y.author!=m.user),ea,fa=false,ga=false,ha=ca>2&&da>=ca-1;if(!(ha)&&ca>0)ga=this._checkNamesForCollision(ba.participants,x);if(ha){ea="Seen by everyone";}else if(x.length==1){ea=u._("Seen by {user}",{user:aa[x[0]].short_name});}else if(x.length==2){ea=u._("Seen by {user1}, {user2}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name});}else if(x.length==3){ea=u._("Seen by {user1}, {user2}, {user3}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,user3:aa[x[2]].short_name});}else if(x.length>3){var ia=Object.keys(aa).length-2,ja=u._("{num} more",{num:ia}),ka=h.create('span',{className:'more'},ja);ea=h.tx._("Seen by {user1}, {user2}, {=num more link}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,'=num more link':ka});fa=true;}fa=fa||ga;this._informStateChanged({activity:'seen-by',text:ea,seenBy:x,hasNameCollision:ga,tooltip:fa});}.bind(this));z&&this._informStateChanged({activity:'none'});},_notifyTyping:function(x){var y=this._lastMsg,z=true;m.getMulti(x,function(aa){z=false;if(this._lastMsg!=y)return;if(this._canonicalUser||j.ChatMultiTypGK){var ba=o.getThreadMetaNow(this._threadID),ca=ba?ba.participants.length:0,da,ea=false;if(ca>2&&x.length>=ca-1){da="Everyone is typing...";}else if(x.length==1){da=u._("{name} is typing...",{name:aa[x[0]].short_name});}else if(x.length==2){da=u._("{user1} and {user2} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name});}else if(x.length==3){da=u._("{user1}, {user2}, and {user3} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,user3:aa[x[2]].short_name});}else if(x.length>3){var fa=Object.keys(aa).length-2,ga=u._("{num} more",{num:fa}),ha=h.create('a',{href:'#'},ga);da=h.tx._("{user1}, {user2}, and {=num more link} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,'=num more link':ha});ea=true;}this._informStateChanged({activity:'typing',text:da,typing:x,tooltip:ea});}}.bind(this));z&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var x=i.LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==x){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=m.user){this._notifySentFrom();return;}var y=k.getSeenBy(this._threadID,true);if(y.length)if(this._canonicalUser){this._notifySeenTimestamp(y);return;}else{this._notifySeenBy(y);return;}this._informStateChanged({activity:'none'});}});p.addRetroactiveListener('state-changed',function(x){v.forEach(function(y){var z=x[y._threadID];if(z!==undefined){y._typing=z;y._handleStateChange();}});});k.subscribe('state-changed',function(x,y){v.forEach(function(z){y[z._threadID]&&z._handleStateChange();});});e.exports=w;});
__d("MercuryLastMessageIndicator",["CSS","MercuryIndicatorController","DOM","MercuryParticipants","Tooltip","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('MercuryIndicatorController'),i=b('DOM'),j=b('MercuryParticipants'),k=b('Tooltip'),l=b('copyProperties'),m=b('csx'),n=b('cx');function o(p,q,r,s){this._lastMessageIndicator=q;this._hideTyping=r||false;this._messagesView=s;this._controller=new h(p);this._subscription=this._controller.subscribe('state-changed',this._handleStateChanged.bind(this));}l(o.prototype,{destroy:function(){this._setClass(null);this._subscription.unsubscribe();this._controller.destroy();},setLastMessage:function(p){this._controller.setLastMessage(p);},_handleStateChanged:function(p,q){var r=this._messagesView.isScrolledToBottom();this._rerender(q);r&&this._messagesView.scrollToBottom();},_rerender:function(p){if(p.activity=='none'){this._setClass(null);return;}if(this._hideTyping&&p.activity=='typing'){this._setClass(null);return;}g.conditionClass(this._lastMessageIndicator,"_510e",p.self_authored);var q=i.find(this._lastMessageIndicator,"._510f");if(p.text){i.setContent(q,p.text);}else i.empty(q);if(p.activity.substring(0,4)=='seen'){this._setClass('seen');if(p.activity=='seen-by'&&p.tooltip){j.getMulti(p.seenBy,function(r){var s=i.create('div');for(var t in r){var u=i.create('div');i.setContent(u,r[t].name);i.appendContent(s,u);}var v=p.hasNameCollision,w;if(v){w=this._lastMessageIndicator;}else w=i.find(this._lastMessageIndicator,'span.more');k.set(w,s,'above','center');}.bind(this));}else k.remove(this._lastMessageIndicator);}else this._setClass(p.activity);},_setClass:function(p){if(this._lastClass===p)return;this._lastClass&&g.removeClass(this._lastMessageIndicator,this._lastClass);p&&g.addClass(this._lastMessageIndicator,p);this._lastClass=p;}});e.exports=o;});
__d("MercuryChannelHandler",["Arbiter","ChannelConstants","MercuryActionTypeConstants","MercuryGlobalActionType","MercuryMessages","MercuryPayloadSource","MercurySendLogger","MessagingReliabilityLogger","MessagingEvent","MessagingTag","MercuryParticipants","PresenceUtil","MercuryServerRequests","MercuryThreadInformer","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('MercuryActionTypeConstants'),j=b('MercuryGlobalActionType'),k=b('MercuryMessages').get(),l=b('MercuryPayloadSource'),m=b('MercurySendLogger'),n=b('MessagingReliabilityLogger'),o=b('MessagingEvent'),p=b('MessagingTag'),q=b('MercuryParticipants'),r=b('PresenceUtil'),s=b('MercuryServerRequests').get(),t=b('MercuryThreadInformer').get(),u=b('copyProperties');function v(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||!la.obj.message){n.addEntry('channel_receive','invalid_data');return;}var ma=la.obj.message,na={author:ma.mercury_author_id,author_email:ma.mercury_author_email,body:ma.body,subject:ma.subject,has_attachment:ma.has_attachment,attachments:ma.attachments,html_body:ma.html_body,thread_id:ma.tid,message_id:ma.mid,coordinates:ma.mercury_coordinates,is_spoof_warning:ma.is_spoof_warning,source:ma.mercury_source,source_tags:ma.mercury_source_tags,threading_id:ma.threading_id,timestamp:ma.timestamp,timestamp_absolute:ma.timestamp_absolute,timestamp_relative:ma.timestamp_relative,timestamp_time_passed:ma.timestamp_time_passed,action_type:i.USER_GENERATED_MESSAGE,is_unread:ma.is_unread,action_id:ma.action_id,is_forward:false,forward_count:ma.forward_count||ma.forward,forward_message_ids:ma.forward_msg_ids,location_text:ma.location_text,folder:la.obj.folder},oa=[u({},na)];oa=oa.concat(ma.forward_actions||[]);var pa=l.CLIENT_CHANNEL_MESSAGE;s.handleUpdateWaitForThread({actions:oa,payload_source:pa},ma.tid);if(!ma.is_unread&&ma.mercury_author_id===q.user){var qa={};qa[ma.tid]=la.obj.folder;w(h.getArbiterType('messaging'),{obj:{event:o.READ,tids:[ma.tid],folder_info:qa,timestamp:ma.timestamp}});}if(ma.mercury_author_id===q.user)if(k.getMessagesFromIDs([ma.threading_id]).length)m.log(m.CLIENT_CHANNEL_ECHO,ma.threading_id,{canonical:!ma.group_thread_info});n.addEntry('channel_receive','success',[na.thread_id,na.message_id,r.getSessionID()]);}function w(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||!la.obj.tids)return;var ma=[],na=la.obj.event==o.READ;la.obj.tids.forEach(function(oa){ma.push({action_type:i.CHANGE_READ_STATUS,action_id:null,thread_id:oa,mark_as_read:na,timestamp:la.obj.timestamp||0,folder:la.obj.folder_info[oa]});});s.handleUpdate({actions:ma,payload_source:l.CLIENT_CHANNEL_MESSAGE});}function x(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||!la.obj.tids)return;var ma=[];la.obj.tids.forEach(function(na){ma.push({action_type:i.DELETE_THREAD,action_id:null,thread_id:na});});s.handleUpdate({actions:ma,payload_source:l.CLIENT_CHANNEL_MESSAGE});}function y(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||!la.obj.tids||!la.obj.mids)return;var ma=la.obj.tids[0],na={action_type:i.DELETE_MESSAGES,action_id:null,thread_id:ma,message_ids:la.obj.mids};s.handleUpdate({actions:[na],threads:[la.obj.updated_thread],payload_source:l.CLIENT_CHANNEL_MESSAGE});}function z(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||!la.obj.folder)return;var ma={action_type:j.MARK_ALL_READ,action_id:la.obj.action_id,folder:la.obj.folder};s.handleUpdate({global_actions:[ma]});}function aa(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj.tids)return;var ma=l.CLIENT_CHANNEL_MESSAGE;la.obj.tids.forEach(function(na){var oa={action_type:i.CHANGE_ARCHIVED_STATUS,action_id:null,thread_id:na,archived:la.obj.state};s.handleUpdateWaitForThread({actions:[u({},oa)],payload_source:ma},na);});}function ba(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj.tids)return;var ma=l.CLIENT_CHANNEL_MESSAGE,na;la.obj.tids.forEach(function(oa){if(la.obj.event==o.TAG){na=la.obj.tag;}else na=la.obj.marked_as_spam?p.SPAM:p.INBOX;var pa={action_type:i.CHANGE_FOLDER,action_id:null,thread_id:oa,new_folder:na};s.handleUpdateWaitForThread({actions:[u({},pa)],payload_source:ma},oa);});}function ca(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj.tag)return;switch(la.obj.tag){case p.ACTION_ARCHIVED:aa(ka,la);break;case p.INBOX:case p.OTHER:ba(ka,la);break;}}function da(ka,la){if(ka!=h.getArbiterType('inbox')||!la.obj||!la.obj.seen_timestamp)return;s.handleUpdate({message_counts:[{seen_timestamp:la.obj.seen_timestamp,folder:p.INBOX}],unseen_thread_ids:[{thread_ids:[],folder:p.INBOX}],payload_source:l.CLIENT_CHANNEL_MESSAGE});}function ea(ka,la){if(ka!=h.getArbiterType('mercury')||!la.obj)return;t.synchronizeInforms(function(){var ma=la.obj,na=[];(ma.actions||[]).forEach(function(oa){var pa=i.USER_GENERATED_MESSAGE;if(oa.action_type==i.LOG_MESSAGE){var qa=l.CLIENT_CHANNEL_MESSAGE;s.handleUpdateWaitForThread({actions:[u({},oa)],payload_source:qa},oa.thread_id);}else if(oa.action_type!=pa)na.push(oa);});ma.actions=na;ma.payload_source=l.CLIENT_CHANNEL_MESSAGE;s.handleUpdate(ma);});}function fa(ka,la){s.handleRoger(la.obj);}function ga(ka,la){if(ka!=h.getArbiterType('messaging')||!la.obj||la.obj.mute_settings===undefined||!la.obj.thread_id)return;var ma=i.CHANGE_MUTE_SETTINGS,na=[{action_type:ma,action_id:null,thread_id:la.obj.thread_id,mute_settings:la.obj.mute_settings}];s.handleUpdate({actions:na,payload_source:l.CLIENT_CHANNEL_MESSAGE});}function ha(ka,la){switch(la.obj.event){case o.DELIVER:v(ka,la);break;case o.READ:case o.UNREAD:w(ka,la);break;case o.READ_ALL:z(ka,la);break;case o.DELETE:x(ka,la);break;case o.DELETE_MESSAGES:y(ka,la);break;case o.TAG:ca(ka,la);break;case o.REPORT_SPAM:ba(ka,la);break;case o.READ_RECEIPT:fa(ka,la);break;case o.CHANGE_MUTE_SETTINGS:ga(ka,la);break;}}var ia=[],ja={turnOn:function(){if(!ia.length){var ka={mercury:ea,messaging:ha,inbox:da};for(var la in ka)ia.push(g.subscribe(h.getArbiterType(la),ka[la]));}},turnOff:function(){if(ia.length){ia.forEach(g.unsubscribe);ia=[];}}};ja.turnOn();e.exports=ja;});
__d("MercuryStateCheck",["Arbiter","ChannelConstants","MercuryFolders","MessagingTag","MercuryServerRequests","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('MercuryFolders'),j=b('MessagingTag'),k=b('MercuryServerRequests').get(),l=b('URI'),m=b('copyProperties'),n=m(new g(),{initialize:function(){g.subscribe(h.ON_INVALID_HISTORY,o);d(['ChannelConnection'],function(p){p.subscribe(p.CONNECTED,function(q,r){if(!r.init)o();});});}});function o(){var p;if(l.getRequestURI().getPath().search(/messages/)!==-1){p=i.getSupportedFolders();}else p=[j.INBOX];k.fetchMissedMessages(p);}n.initialize();e.exports=n;});
__d("MercuryUnseenState",["TimestampConverter","KeyedCallbackManager","LogHistory","MercuryActionTypeConstants","MercurySingletonMixin","MercuryThreadlistConstants","MessagingTag","MercuryServerRequests","ReportState","MercuryThreadInformer","copyProperties","createObjectFrom"],function(a,b,c,d,e,f){var g=b('TimestampConverter'),h=b('KeyedCallbackManager'),i=b('LogHistory'),j=b('MercuryActionTypeConstants'),k=b('MercurySingletonMixin'),l=b('MercuryThreadlistConstants'),m=b('MessagingTag'),n=b('MercuryServerRequests'),o=b('ReportState'),p=b('MercuryThreadInformer'),q=b('copyProperties'),r=b('createObjectFrom'),s=l.MAX_UNSEEN_COUNT,t='unseen_thread_hash',u='unseen_thread_list',v=i.getInstance('mercury_unseen_state');function w(ja){this._fbid=ja;this._serverRequests=n.getForFBID(this._fbid);this._threadInformer=p.getForFBID(this._fbid);this._initialUnseenCount=0;this._lastSeenTimestamp=0;this._maxCount=false;this._unseenResources=new h();this._serverRequests.subscribe('update-unseen',function(ka,la){ba(this,la);}.bind(this));this._serverRequests.subscribe('update-thread-ids',function(ka,la){ha(this,la);}.bind(this));}q(w.prototype,{getUnseenCount:function(){if(this.exceedsMaxCount()){v.error('unguarded_unseen_count_fetch',{});return 0;}return aa(this);},exceedsMaxCount:function(){return this._maxCount||(aa(this)>s);},markAsSeen:function(){if(aa(this)>0||this._maxCount){this._serverRequests.markSeen();ca(this,g.convertActionIDToTimestamp(this._serverRequests.getLastActionID()),[]);}},markThreadSeen:function(ja,ka){var la={};la[ja]=null;ea(this,la,ka);}});q(w,k);function x(ja,ka){ja._unseenResources.setResource(t,ka);ja._unseenResources.setResource(u,Object.keys(ka));}function y(ja,ka){var la=ja._unseenResources.executeOrEnqueue(t,ka),ma=ja._unseenResources.getUnavailableResources(la);if(ma.length)ja._serverRequests.fetchUnseenThreadIDs();}function z(ja){return ja._unseenResources.getResource(t);}function aa(ja){var ka=ja._unseenResources.getResource(u);if(ka){return ka.length;}else return ja._initialUnseenCount;}function ba(ja,ka){var la=ia(ka);if(ka.unseen_thread_ids){ka.unseen_thread_ids.forEach(function(wa){if(wa.folder!=m.INBOX)return;var xa=ga(ja,wa.thread_ids),ya=ja._lastSeenTimestamp;if(la&&la.seen_timestamp)ya=la.seen_timestamp;ca(ja,ya,xa);if(la&&la.unseen_count>s)ja._maxCount=true;});}else if(la&&la.seen_timestamp){ja._lastSeenTimestamp=la.seen_timestamp;if(la.unseen_count>s){ja._maxCount=true;x(ja,{});}else{ja._initialUnseenCount=la.unseen_count;if(ja._initialUnseenCount===0)x(ja,{});}}else{if(ja._maxCount)return;var ma=ka.actions;if(!ma||!(ma.length))return;var na={},oa={};for(var pa=0;pa<ma.length;pa++){var qa=ma[pa];if(qa.is_forward)continue;var ra=qa.action_type,sa=qa.action_id,ta=qa.thread_id?qa.thread_id:qa.server_thread_id,ua=qa.folder===undefined||qa.folder==m.INBOX;if(!ua)continue;if(ra==j.USER_GENERATED_MESSAGE||ra==j.LOG_MESSAGE){var va=g.isGreaterThan(sa,na[ta]);if(qa.is_unread&&(!na[ta]||va))na[ta]=sa;}else if(ra==j.CHANGE_READ_STATUS&&qa.mark_as_read)oa[ta]=sa;}da(ja,na);ea(ja,oa);}}function ca(ja,ka,la){var ma=z(ja);if(ma===undefined||ka>ja._lastSeenTimestamp||ja._maxCount){ja._lastSeenTimestamp=ka;la=la||[];if(la.length<=s)ja._maxCount=false;var na={},oa=z(ja)||{};for(var pa in oa)if(oa[pa]!==true){var qa=oa[pa];if(fa(ja,qa))na[pa]=qa;}var ra=q(r(la,true),na);x(ja,ra);ja._threadInformer.updatedUnseenState();}}function da(ja,ka){if(ja._maxCount)return;var la={},ma=false;for(var na in ka){var oa=ka[na];if(fa(ja,oa)){la[na]=oa;ma=true;}}if(!ma)return;y(ja,function(pa){for(var qa in la){var ra=la[qa];if(!pa[qa]&&fa(ja,ra))pa[qa]=la[qa];}x(ja,pa);ja._threadInformer.updatedUnseenState();});}function ea(ja,ka,la){var ma=false;for(var na in ka){ma=true;break;}if(ma)y(ja,function(oa){var pa=false;for(var qa in ka){var ra=ka[qa],sa=g.isGreaterThan(ra,oa[qa]);if(oa[qa]&&(!ra||sa)){delete oa[qa];pa=true;}}if(pa){x(ja,oa);ja._threadInformer.updatedUnseenState();if(la&&aa(ja)===0)ja._serverRequests.markSeen();}});}function fa(ja,ka){var la=g.convertActionIDToTimestamp(ka);return la>ja._lastSeenTimestamp;}function ga(ja,ka){return ka.map(ja._serverRequests.convertThreadIDIfAvailable.bind(ja._serverRequests));}function ha(ja,ka){var la=z(ja);if(!la)return;for(var ma in ka){var na=ka[ma];if(la[ma]){la[na]=la[ma];delete la[ma];}}x(ja,la);}function ia(ja){var ka=(ja.message_counts||[]);for(var la=0;la<ka.length;la++)if(ka[la].folder==m.INBOX)return ka[la];return null;}o.registerCallback('mercury-unseen-state',function(){var ja={};ja.unseen={};ja.unseen_max_count={};ja.unseen_time={};var ka=w._getInstances();for(var la in ka){ja.unseen[la]=q({},z(ka[la]));ja.unseen_max_count[la]=ka[la]._maxCount;ja.unseen_time[la]=ka[la]._lastSeenTimestamp;}return ja;});e.exports=w;});
__d("PagedQueryCache",["AsyncRequest","GraphQLParser","PagedQueryCacheCore","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('GraphQLParser'),i=b('PagedQueryCacheCore'),j=b('copyProperties');function k(o,p,q,r,s,t){var u=h.parseQuery(o),v=p.findFieldByPath(u),w={};for(var x=0;x<v.calls.length;x++){var y=v.calls[x];w[y.name]=y.args[0].callValue;}j(w,s);new g('/ajax/graphql/query/').setData({queryName:r,params:w}).setHandler(function(z){var aa=z.getPayload();t({requested_indices:q,query_results:JSON.parse(aa.output),query_metadata:{query_string:aa.query},query_params:w});}).setAllowCrossPageTransition(true).send();}for(var l in i)if(i.hasOwnProperty(l))n[l]=i[l];var m=i===null?null:i.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=i;function n(o,p,q){"use strict";i.call(this,k,o,p,q);}e.exports=n;});
__d("PhotoCentralUpdates",["Arbiter","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('copyProperties'),i={handleUpdate:function(j,k){var l=h({payloadsource:j},k);g.inform('update-photos',l);}};e.exports=i;});
__d("PhotoStore",["Arbiter","PagedQuery","PagedQueryCache","PhotoCentralUpdates","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('PagedQuery'),i=b('PagedQueryCache'),j=b('PhotoCentralUpdates'),k=b('copyProperties'),l={actions:{UPDATE:'update'},_photoCache:{},_postCreateCallbacks:{},getPhotoCache:function(m){if(!this._photoCache[m])throw new Error('Photo cache requested for unknown set ID');return this._photoCache[m];},hasBeenCreated:function(m){return !!this._photoCache[m];},clearSetCache:function(m){delete this._photoCache[m];delete this._postCreateCallbacks[m];},getByIndex:function(m,n,o){return this.getPhotoCache(m).getItemAtIndex(n,o);},getByIndexImmediate:function(m,n){if(this._photoCache[m])return this._photoCache[m].getItemAtIndexImmediate(n);return undefined;},getIndexForID:function(m,n){if(this._photoCache[m])return this._photoCache[m].getIndexForID(n);return undefined;},getCursorByIndexImmediate:function(m,n){var o=this.getByIndexImmediate(m,n);if(o)return this._photoCache[m].getCursorForID(o.id);return undefined;},getAvailableRange:function(m,n){return this.getPhotoCache(m).getAvailableRange();},hasLooped:function(m){return this.getPhotoCache(m).hasLooped();},fetchForward:function(m,n,o,p){return this.getPhotoCache(m).getItemsAfterCursor(n,o,p);},fetchBackward:function(m,n,o,p){return this.getPhotoCache(m).getItemsBeforeCursor(n,o,p);},executePostCreate:function(m,n){if(this._photoCache[m]){n&&n();}else this._postCreateCallbacks[m]=n;},runPostCreateCallback:function(m){var n=this._postCreateCallbacks[m];if(n){n();delete this._postCreateCallbacks[m];}},setPreFetchCallback:function(m,n){this.getPhotoCache(m).setPreFetchCallback(n);},_updateData:function(m){var n=m.query_results,o=m.query_metadata,p=o.set_id;if(!this._photoCache[p]){var q=h.constructFromPath(o.query_string,o.query_path);this._photoCache[p]=new i(q,n,k({enableLooping:true},o.config));this._photoCache[p].setPayloadCallback(function(r){r.query_metadata.set_id=p;j.handleUpdate(0,r);});this.runPostCreateCallback(p);}else if(m.query_metadata.action==l.actions.UPDATE){this._photoCache[p].updateData(m);}else this._photoCache[p].addData(m);}};g.subscribe('update-photos',function(event,m){l._updateData(m);});e.exports=l;});
__d("PhotoUtils",["Event","URI"],function(a,b,c,d,e,f){var g=b('Event'),h=b('URI'),i={getImagesFromData:function(j){var k=[];for(var l in j)if(l.indexOf('image')===0)k.push(j[l]);return k;},getFBIDFromData:function(j){return j&&j.id;},getOriginalImageFromData:function(j){return j.original||j.download_image;},getDownloadURLFromData:function(j){var k=this.getOriginalImageFromData(j);if(!k)return null;var l=new h(k.uri);l.addQueryData({dl:1});return l;},getPermalinkFromData:function(j){return j.permalink;},canViewerMakeCoverPhoto:function(j){return !!j.can_viewer_make_cover_photo;},getCoverPhotoURLFromData:function(j){return new h('/profile.php').addQueryData({preview_cover:i.getFBIDFromData(j)});},preload:function(j,k,l){var m=j.getDimensions();for(var n=0;n<k.length;++n){var o=m.getBestFitImageFromPhoto(k[n],m.getMaxStageDimensions()),p=new Image();l&&g.listen(p,'load',l.curry(k[n]));j.getLogger().log(o.uri);p.src=o.uri;}}};e.exports=i;});
__d("PhotoViewerDimensions",["Event","PhotoUtils","Vector","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('PhotoUtils'),i=b('Vector'),j=b('copyProperties');function k(l){"use strict";var m=['verticalPadding','horizontalPadding','normalResDim'];for(var n in l)if(m.indexOf(n)<0)throw new Error("Unsupported extraData value '"+n+"' should not be used");if(l){this._verticalPadding=l.verticalPadding;this._horizontalPadding=l.horizontalPadding;this._normalResDim=l.normalResDim;}this._listener=g.listen(window,'resize',this._resetMaxStageDimensions.bind(this));}k.prototype.destroy=function(){"use strict";this._listener.remove();};k.prototype.shouldUseHiRes=function(l){"use strict";if(!l.hasHiResDimensions())return false;var m=this.getStageDimensions(l.getHiResDimensions()),n=this.getImageDimensionsForStage(l.getHiResDimensions(),m);return (n.x>this._normalResDim.x||n.y>this._normalResDim.y);};k.prototype.getStageDimensions=function(l){"use strict";var m=this.getMaxStageDimensions(),n=new i(Math.min(l.x,m.x),Math.min(l.y,m.y)),o=n.x/n.y,p=l.x/l.y;if(o<p){n.y=Math.round(n.x/p);}else n.x=Math.round(n.y*p);return n;};k.prototype.getImageDimensionsForStage=function(l,m){"use strict";var n=l.x,o=l.y,p=m.x,q=m.y;if(n>=p||o>=q){var r=n/o,s=p/q;if(s<r){n=p;o=Math.round(p/r);}else if(s>r){n=Math.round(q*r);o=q;}else{n=p;o=q;}}return new i(n,o);};k.prototype.getMaxStageDimensions=function(){"use strict";if(!this._maxStageDimensions)this._maxStageDimensions=new i(i.getViewportDimensions().x-this._horizontalPadding,i.getViewportDimensions().y-this._verticalPadding);return this._maxStageDimensions;};k.prototype._resetMaxStageDimensions=function(){"use strict";this._maxStageDimensions=null;};k.prototype.getDimensionsFromImage=function(l){"use strict";return this.shouldUseHiRes(l)?l.getHiResDimensions():l.getNormalDimensions();};k.prototype.getMaxDimensionsFromImage=function(l){"use strict";return l.hasHiResDimensions()?l.getHiResDimensions():l.getNormalDimensions();};k.prototype.getSrcFromImage=function(l){"use strict";return this.shouldUseHiRes(l)?l.getHiResSrc():l.getNormalSrc();};k.prototype.getBestFitImageFromPhoto=function(l,m){"use strict";var n=null,o=h.getImagesFromData(l);o=o.sort(function(q,r){return r.width-q.width;});for(var p=0;p<o.length;p++)if(!n||o[p].width>=m.x||o[p].height>=m.y)n=o[p];return n;};k.prototype.getOriginalDimensionsFromPhoto=function(l){"use strict";var m=h.getOriginalImageFromData(l);return new i(m.width,m.height);};k.prototype.getBestFitDimensionsFromPhoto=function(l,m){"use strict";var n=this.getBestFitImageFromPhoto(l,m);return new i(n.width,n.height);};j(k.prototype,{_verticalPadding:40,_horizontalPadding:60,_normalResDim:{x:960,y:960}});e.exports=k;});
__d("SpotlightViewer",["React","ReactLayeredComponentMixin","Spotlight.react","cx"],function(a,b,c,d,e,f){var g=b('React'),h=b('ReactLayeredComponentMixin'),i=b('Spotlight.react'),j=b('cx'),k=g.createClass({displayName:'SpotlightViewer',mixins:[h],renderLayers:function(){return {photoLayer:i({shown:this.props.open,onHide:this.props.onHide},g.DOM.div({className:"_n3"},this.props.children))};},render:function(){return (g.DOM.div(null));}});e.exports=k;});
__d("PhotoViewState",["ArbiterMixin","PhotoStore","PhotoUtils","SpotlightViewerLoggingEvents","copyProperties","mixin"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('PhotoStore'),i=b('PhotoUtils'),j=b('SpotlightViewerLoggingEvents'),k=b('copyProperties'),l=b('mixin'),m=l(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r,s,t,u){"use strict";this._viewer=q;this._setID=r;this._updateCallback=t;this._position=s||0;this._preloaded={};this._reverse=u;}p.prototype.destroy=function(){"use strict";};p.prototype._fetchCallback=function(q){"use strict";if(!this._viewer.isOpen())return;this._preload(q);this._log(j.DATA_FETCH_COMPLETE);};p.prototype._preload=function(q){"use strict";i.preload(this._viewer,q,function(r){this._preloaded[i.getFBIDFromData(r)]=true;}.bind(this));};p.prototype._preloadPhotosInRange=function(q,r){"use strict";var s=[];for(var t=q;t<=r;++t){var u=h.getByIndexImmediate(this._setID,t);if(u&&!this._isPreloaded(u))s.push(u);}this._preload(s);};p.prototype._isPreloaded=function(q){"use strict";return this._preloaded[i.getFBIDFromData(q)];};p.prototype.getPosition=function(){"use strict";return this._position;};p.prototype.isValidMovement=function(q){"use strict";if(!h.hasBeenCreated(this._setID))return false;if(h.hasLooped(this._setID))return true;var r=this._position+q,s=h.getAvailableRange(this._setID),t=s.offset+s.length-1;return r>=s.offset-1&&r<=t+1;};p.prototype.getRelativeMovement=function(q){"use strict";return h.getIndexForID(this._setID,q)-this._position;};p.prototype.moveCursor=function(q){"use strict";if(!this.isValidMovement(q))return false;this._position+=q;return true;};p.prototype._page=function(q){"use strict";if(!this.moveCursor(q))return;this._log(j.PAGE_BEGIN);var r=h.getByIndexImmediate(this._setID,this._position);if(!r){this.inform('photo_fetch');this._log(j.PHOTO_FETCH);}else if(!this._isPreloaded(r))this._preload([r]);h.getByIndex(this._setID,this._position,this._updateCallback);this._loadMoreIfNecessary(q>0,p.BUFFER_SIZE);this._log(j.PAGE_COMPLETE);};p.prototype.loadMoreForwardIfNecessary=function(q){"use strict";var r=h.getAvailableRange(this._setID),s=r.offset+r.length-1,t=this._position+q;if(t>s&&!h.hasLooped(this._setID)){var u=h.getCursorByIndexImmediate(this._setID,s);h.fetchForward(this._setID,u,q,this._fetchCallback.bind(this));}else this._preloadPhotosInRange(this._position+1,t);};p.prototype.loadMoreBackwardIfNecessary=function(q){"use strict";var r=h.getAvailableRange(this._setID),s=this._position-q;if(s<r.offset&&!h.hasLooped(this._setID)){var t=h.getCursorByIndexImmediate(this._setID,r.offset);h.fetchBackward(this._setID,t,q,this._fetchCallback.bind(this));}else this._preloadPhotosInRange(s,this._position-1);};p.prototype._loadMoreIfNecessary=function(q,r){"use strict";if(q){this.loadMoreForwardIfNecessary(r);}else this.loadMoreBackwardIfNecessary(r);};p.prototype.displayFirst=function(){"use strict";if(!this._viewer.isOpen())return;h.setPreFetchCallback(this._setID,function(){this._log(j.DATA_FETCH_BEGIN);}.bind(this));var q=function(r){if(!this._isPreloaded(r))this._preload([r]);this._updateCallback(r);}.bind(this);h.getByIndex(this._setID,this._position,q);if(this._reverse){this.loadMoreBackwardIfNecessary(p.BUFFER_SIZE);}else this.loadMoreForwardIfNecessary(p.BUFFER_SIZE);};p.prototype.backward=function(){"use strict";this._page(this._reverse?1:-1);};p.prototype.forward=function(){"use strict";this._page(this._reverse?-1:1);};p.prototype._log=function(q){"use strict";this._viewer.log(q);};k(p,{BUFFER_SIZE:4});e.exports=p;});
__d("SpotlightViewerCoreMixin",["PhotoLogger","PhotoStore","PhotoUtils","PhotoViewState","SpotlightViewerImage","SpotlightViewerLoggingEvents"],function(a,b,c,d,e,f){var g=b('PhotoLogger'),h=b('PhotoStore'),i=b('PhotoUtils'),j=b('PhotoViewState'),k=b('SpotlightViewerImage'),l=b('SpotlightViewerLoggingEvents'),m={_displayFirstPhoto:function(){h.executePostCreate(this.props.setid,this.viewState.displayFirst.bind(this.viewState));},_getInitialPosition:function(){var n;if(!this.props.clearcache)n=h.getIndexForID(this.props.setid,this.props.photoid);if(n===undefined){h.clearSetCache(this.props.setid);n=0;}return n;},componentWillMount:function(){this._logger=new g(this.getViewerID());this.log(l.OPEN_BEGIN);var n=this._getInitialPosition();this.viewState=new j(this,this.props.setid,n,this._updatePhoto,this.props.reverse);this.behaviors&&this.enableBehaviors(this.behaviors);this.inform('open');this._displayFirstPhoto();},componentDidMount:function(){this._enableSubscriptions&&this._enableSubscriptions();this.log(l.OPEN_COMPLETE);},isOpen:function(){return this.state.open;},close:function(){if(!this.isOpen())return;this.log(l.CLOSE_BEGIN);this.setState({open:false},function(){this.inform('close');this.log(l.CLOSE_COMPLETE);}.bind(this));},componentWillUnmount:function(){this.viewState.destroy();delete this.viewState;this._resizer.destroy();delete this._resizer;this._dimensions.destroy();delete this._dimensions;this._subscriptions.release();this.destroyBehaviors();},getDimensions:function(){return this._dimensions;},_onClickViewport:function(n){n?this.viewState.forward():this.viewState.backward();},_getMedia:function(n,o){return (k({ref:"image",src:n.uri,dimensions:o.imageDimensions}));},_getCurrentFBID:function(){return i.getFBIDFromData(this.state.photoData);},_updatePhoto:function(n){this.log(l.PHOTO_CHANGE_BEGIN);var o=function(){this.inform('photo_change',n);this.log(l.PHOTO_CHANGE_COMPLETE);}.bind(this);if(i.getFBIDFromData(n)==this._getCurrentFBID()){this.setState({photoData:n},o);}else this.setState({updatingPhoto:true,photoData:n},this.setState.bind(this,{updatingPhoto:false},o));},getLogger:function(){return this._logger;},log:function(n){this._logger&&this._logger.logEvent(n);}};e.exports=m;});
__d("SpotlightViewerPagers",["LeftRight.react","Link.react","React","cx"],function(a,b,c,d,e,f){var g=b('LeftRight.react'),h=b('Link.react'),i=b('React'),j=b('cx'),k=i.createClass({displayName:'SpotlightViewerPagers',render:function(){return (g(null,h({className:"_4-oa _4-ob _50-m"}),h({className:"_4-oa _4-oc _50-m"})));}});e.exports=k;});
__d("SpotlightViewerPageWithKeys",["KeyEventController","SubscriptionsHandler"],function(a,b,c,d,e,f){var g=b('KeyEventController'),h=b('SubscriptionsHandler');function i(j){"use strict";this.$SpotlightViewerPageWithKeys0=j;}i.prototype.enable=function(){"use strict";this.$SpotlightViewerPageWithKeys1=new h();this.$SpotlightViewerPageWithKeys1.addSubscriptions(g.registerKey('LEFT',function(){this.$SpotlightViewerPageWithKeys0.viewState.backward();return false;}.bind(this)),g.registerKey('RIGHT',function(){this.$SpotlightViewerPageWithKeys0.viewState.forward();return false;}.bind(this)));};i.prototype.disable=function(){"use strict";this.$SpotlightViewerPageWithKeys1.release();delete this.$SpotlightViewerPageWithKeys1;};e.exports=i;});
__d("SpotlightViewerStageResizer",["Event","SubscriptionsHandler","UserAgent","Vector","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('SubscriptionsHandler'),i=b('UserAgent'),j=b('Vector'),k=b('copyProperties');function l(){"use strict";this._init();}l.prototype._init=function(){"use strict";this._subscriptionsHandler=new h();this._subscriptionsHandler.addSubscriptions(g.listen(window,'resize',this._resetStageDimensions.bind(this)));this._resetStageDimensions();};l.prototype.destroy=function(){"use strict";this._subscriptionsHandler.release();};l.prototype._resetStageDimensions=function(){"use strict";this._currentStageDimensions=new j(this._minWidth,this._minHeight);};l.prototype.getImageAndStageDimensions=function(m,n){"use strict";var o=m.getBestFitDimensionsFromPhoto(n,m.getMaxStageDimensions()),p=m.getStageDimensions(o);if(!this._currentStageDimensions)this._resetStageDimensions();this._currentStageDimensions=new j(Math.max(p.x,this._minWidth,this._currentStageDimensions.x),Math.max(p.y,this._minHeight,this._currentStageDimensions.y));var q=m.getImageDimensionsForStage(o,this._currentStageDimensions),r=this._currentStageDimensions.y-q.y;if(r>0&&r<this._padding)this._currentStageDimensions.y=q.y;var s=this._currentStageDimensions.x-q.x;if(s>0&&s<this._padding)this._currentStageDimensions.x-=s;if(i.ie()<8)q.x-=1;return {stageDimensions:this._currentStageDimensions,imageDimensions:q};};l.prototype.getCurrentStageDimensions=function(){"use strict";return this._currentStageDimensions;};k(l.prototype,{_padding:40,_minHeight:520,_minWidth:520,_subscriptions:null,_currentStageDimensions:null});e.exports=l;});
__d("SpotlightViewerThumbnailMixin",["PhotoStore","Vector"],function(a,b,c,d,e,f){var g=b('PhotoStore'),h=b('Vector'),i={_getInitialPhotoData:function(){var j=g.getIndexForID(this.props.setid,this.props.photoid),k=g.getByIndexImmediate(this.props.setid,j);return k?k:this._getThumbnailPhotoData();},_getThumbnailPhotoData:function(){if(!this.props.dimensions||!this.props.thumbsrc)return null;var j={id:this.props.photoid};for(var k=0;k<this.props.dimensions.length;++k){var l=h.deserialize(this.props.dimensions[k]);j['image'+k]={width:l.x,height:l.y,uri:this.props.thumbsrc};}return j;}};e.exports=i;});
__d("SpotlightViewerUnmountOnClose",[],function(a,b,c,d,e,f){function g(h){"use strict";this.$SpotlightViewerUnmountOnClose0=h;}g.prototype.enable=function(){"use strict";this.$SpotlightViewerUnmountOnClose1=this.$SpotlightViewerUnmountOnClose0.subscribeOnce('close',this.$SpotlightViewerUnmountOnClose0.unmountComponent.bind(this.$SpotlightViewerUnmountOnClose0));};g.prototype.disable=function(){"use strict";this.$SpotlightViewerUnmountOnClose1&&this.$SpotlightViewerUnmountOnClose1.unsubscribe();delete this.$SpotlightViewerUnmountOnClose1;};e.exports=g;});
__d("SpotlightViewport",["Locale","Parent","React","Vector","cx","joinClasses"],function(a,b,c,d,e,f){var g=b('Locale'),h=b('Parent'),i=b('React'),j=b('Vector'),k=b('cx'),l=b('joinClasses'),m=i.createClass({displayName:'SpotlightViewport',PAGE_TO_PREV_PERCENTAGE:.2,sections:{NONE:null,FORWARD:1,BACKWARD:2},getInitialState:function(){return {currentActiveSection:this.sections.NONE,active:true};},_onMouseMove:function(event){var n=j.getEventPosition(event.nativeEvent),o=j.getElementPosition(this.getDOMNode()),p,q=n.x-o.x,r=q/this.props.stageDimensions.x;if(g.isRTL()){p=r>(1-this.PAGE_TO_PREV_PERCENTAGE);}else p=r<this.PAGE_TO_PREV_PERCENTAGE;if(p){this.setState({currentActiveSection:this.sections.BACKWARD});}else this.setState({currentActiveSection:this.sections.FORWARD});},_onClick:function(event){var n=this.state.currentActiveSection==this.sections.FORWARD,o=event.nativeEvent.target;if(!h.byClass(o,"_51an"))this.props.onClick&&this.props.onClick(n);},_onMouseEnter:function(){this.setState({active:true});},_onMouseLeave:function(){this.setState({active:false});},render:function(){var n=(("_4-of")+(!this.state.active&&!this.props.active?' '+"_50-l":'')+(this.state.currentActiveSection===this.sections.BACKWARD?' '+"_516a":'')+(this.state.currentActiveSection===this.sections.FORWARD?' '+"_516b":'')+(this.props.showLoadingIndicator?' '+"_51jp":''));if(this.props.className)n=l(n,this.props.className);return (i.DOM.div({className:n,style:{width:this.props.stageDimensions&&this.props.stageDimensions.x,height:this.props.stageDimensions&&this.props.stageDimensions.y},onClick:this._onClick,onMouseMove:this._onMouseMove,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},this.props.children,i.DOM.div({className:"_4-og"},i.DOM.span({className:"_4-oh"}),this.props.media,i.DOM.div({className:"_4-oi"}))));}});e.exports=m;});
__d("SpotlightMessagesViewer",["ArbiterMixin","BehaviorsMixin","Event","PhotoViewerDimensions","React","SpotlightViewer","SpotlightViewerCoreMixin","SpotlightViewerPagers","SpotlightViewerPageWithKeys","SpotlightViewerStageResizer","SpotlightViewerThumbnailMixin","SpotlightViewerUnmountOnClose","SpotlightViewport","SubscriptionsHandler"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('BehaviorsMixin'),i=b('Event'),j=b('PhotoViewerDimensions'),k=b('React'),l=b('SpotlightViewer'),m=b('SpotlightViewerCoreMixin'),n=b('SpotlightViewerPagers'),o=b('SpotlightViewerPageWithKeys'),p=b('SpotlightViewerStageResizer'),q=b('SpotlightViewerThumbnailMixin'),r=b('SpotlightViewerUnmountOnClose'),s=b('SpotlightViewport'),t=b('SubscriptionsHandler'),u=k.createClass({displayName:'SpotlightMessagesViewer',mixins:[g,h,m,q],behaviors:[o,r],getViewerID:function(){return this.props.setid;},getInitialState:function(){this._dimensions=new j();this._subscriptions=new t();this._resizer=new p(this._dimensions);return {photoData:this._getInitialPhotoData(),open:true,maxStageDimensions:this._dimensions.getMaxStageDimensions(),updatingPhoto:false};},_enableSubscriptions:function(){this._subscriptions.addSubscriptions(i.listen(window,'resize',this._onResize));this.props.useloadingindicator&&this._subscriptions.addSubscriptions(this.viewState.subscribe('photo_fetch',this.setState.bind(this,{photoData:null},null)));},_onResize:function(){this.setState({maxStageDimensions:this._dimensions.getMaxStageDimensions()});},render:function(){var v,w,x,y=null;if(this.state.photoData){v=this._resizer.getImageAndStageDimensions(this._dimensions,this.state.photoData);w=this._dimensions.getBestFitImageFromPhoto(this.state.photoData,this.state.maxStageDimensions);x=v.stageDimensions;y=!this.state.updatingPhoto?this._getMedia(w,v):null;}else x=this._resizer.getCurrentStageDimensions();var z=this.props.useloadingindicator&&!this.state.photoData;return (l({open:this.state.open,onHide:this.close},s({onClick:this._onClickViewport,stageDimensions:x,media:y,showLoadingIndicator:z},this.props.disablepaging?null:n(null))));}});e.exports=u;});
__d("MessagesViewer",["AsyncRequest","DOM","PhotoStore","React","SpotlightMessagesViewer","ge"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('DOM'),i=b('PhotoStore'),j=b('React'),k=b('SpotlightMessagesViewer'),l=b('ge'),m={setID:'messages',bootstrap:function(n,o,p,q,r){var s=k({open:true,setid:m.setID,photoid:n,thumbsrc:p,dimensions:[o],disablepaging:q,reverse:r});m.render(s);},bootstrapWithElem:function(n){m.bootstrapWithConfig(n,{fbid:n.getAttribute('data-fbid'),dimensions:n.getAttribute('data-dimensions'),src:n.getAttribute('href'),endpoint:n.getAttribute('data-endpoint'),disablePaging:n.getAttribute('data-disablepaging'),reverse:false});},bootstrapWithConfig:function(n,o){m.bootstrap(o.fbid,o.dimensions,o.src,o.disablePaging,o.reverse);if(!i.hasBeenCreated(m.setID))new g(o.endpoint).setRelativeTo(n).send();},render:function(n){var o=l('messages_viewer');if(!o){o=h.create('div',{id:'messages_viewer'});document.body.appendChild(o);}j.renderComponent(n,o);n.subscribeOnce('close',function(){h.empty(o);});}};e.exports=m;});
__d("MercuryAttachmentRenderer",["MercuryAttachmentTemplates","MercuryAttachmentAudioClip.react","CSS","MercuryConstants","DOM","Event","JSXDOM","MercuryAttachment","MercuryAttachmentType","MercuryConfig","MercuryMessages","MercuryParticipants","MessagesViewer","PhotosMultiUploadInput","ProgressBar","React","Sticker.react","Style","URI","UserAgent","cx","tx"],function(a,b,c,d,e,f){"use strict";var g=b('MercuryAttachmentTemplates'),h=b('MercuryAttachmentAudioClip.react'),i=b('CSS'),j=b('MercuryConstants'),k=b('DOM'),l=b('Event'),m=b('JSXDOM'),n=b('MercuryAttachment'),o=b('MercuryAttachmentType'),p=b('MercuryConfig'),q=b('MercuryMessages').get(),r=b('MercuryParticipants'),s=b('MessagesViewer'),t=b('PhotosMultiUploadInput'),u=b('ProgressBar'),v=b('React'),w=b('Sticker.react'),x=b('Style'),y=b('URI'),z=b('UserAgent'),aa=b('cx'),ba=b('tx'),ca=z.ie()<=8;function da(ga,ha){var ia=g[ha].build().setNodeContent('filename',ga.name),ja=ia.getNode('link');ja.setAttribute('href',ga.url);ga.rel&&ja.setAttribute('rel',ga.rel);i.addClass(ia.getRoot(),n.getAttachIconClass(ga.icon_type));return ia;}function ea(ga,ha){var ia=g[ha].build().setNodeContent('filename',ga.name);i.addClass(ia.getRoot(),n.getAttachIconClass(ga.icon_type));return ia;}var fa={renderAttachment:function(ga,ha,ia,ja,ka){var la=100,ma=ga?160:400,na=null,oa=null,pa=j.MercurySupportedShareType;if(this.isErrorAttachment(ha))na=fa.renderError(ha);if(this.isShareAttachment(ha)&&ha.share_xhp)if(ha.share_data_type===pa.FB_BROWSE_QUERY||!ga)oa=fa.renderShareXHP(ha,ia.id);if(this.isStickerAttachment(ha))oa=fa.renderSticker(ha,ia,ga);if(!oa&&this.isShareAttachment(ha)){var qa=ha.share_data_type;switch(qa){case pa.FB_PHOTO:oa=fa.renderPreview(ha,ia,ja,ka);break;case pa.FB_VIDEO:oa=fa.renderVideoThumb(ha);break;case pa.FB_MUSIC_ALBUM:case pa.FB_SONG:case pa.FB_PLAYLIST:case pa.FB_MUSICIAN:case pa.FB_RADIO_STATION:oa=fa.renderMusic(ha);break;case pa.EXTERNAL:case pa.FB_TEMPLATE:case pa.FB_COUPON:case pa.FB_SOCIAL_REPORT_PHOTO:oa=fa.renderExternalLink(ha);break;case pa.FB_SOCIAL_RESOLUTION:oa=fa.renderSocialResolution(ha);break;default:if(ha.name)oa=fa.renderShareLink(ha,ia&&ia.id,ga);break;}}if(!oa&&ha.preview_loading)oa=fa.renderPreview(null);if(!oa&&ha.preview_url)oa=fa.renderPreview(ha,ia,ja,ka);if(!oa&&this.isFileAttachment(ha))if(ha.metadata&&ha.metadata.type==j.MercuryAttachmentAudioClip){oa=k.create('div');var ra=fa.renderAudioClip(ha,ia.message_id,la,ma);v.renderComponent(ra,oa);}else oa=ga?fa.renderFileLink(ha):fa.renderExtendedFileLink(ha);return {error:na,content:oa,bubblePreferred:this.isBubblePreferred(ha)};},isBubblePreferred:function(ga){return !this.isStickerAttachment(ga);},renderError:function(ga){var ha=g[':fb:mercury:attachment:error'].build();k.appendContent(ha.getNode('error'),ga.error_msg);return ha.getRoot();},renderSocialResolution:function(ga){var ha=g[':fb:mercury:attachment:social-resolution'].build();ha.setNodeContent('post',ga.share_xhp);return ha.getRoot();},renderExternalLink:function(ga){var ha=g[':fb:mercury:attachment:external-link'].build().setNodeContent('name',ga.name);ga.base_url&&ha.setNodeContent('shortLink',ga.base_url);var ia=ha.getNode('preview'),ja=ha.getNode('image-link');ja.setAttribute('href',ga.url);ga.rel&&ja.setAttribute('rel',ga.rel);if(ga.preview_url){var ka=ha.getNode('preview-image');ka.setAttribute('src',ga.preview_url);i.addClass(ia,ga.preview_class);i.show(ka);}else{i.addClass(ha.getRoot(),'noMedia');i.hide(ia);}ha.getNode('name').setAttribute('href',ga.url);d(['LinkshimHandler'],function(la){la.setUpLinkshimHandling(ha.getNode('name'));la.setUpLinkshimHandling(ha.getNode('image-link'));});if(ga.rel)ha.getNode('name').setAttribute('rel',ga.rel);return ha.getRoot();},renderFileLink:function(ga){var ha=null;if(ga.url===''){ha=':fb:mercury:attachment:file-name';return ea(ga,ha).getRoot();}else{ha=':fb:mercury:attachment:file-link';return da(ga,ha).getRoot();}},renderAudioClip:function(ga,ha,ia,ja){var ka=ga.metadata.duration/1000,la=200;if(ia&&ja)if(ka<5){la=ia;}else la=(1-Math.pow(10,(ka-5)/-30))*(ja-ia)+ia;return h({src:ga.url,duration:ga.metadata.duration/1000,showHelp:false,width:la});},renderExtendedFileLink:function(ga){var ha=null;if(ga.url===''){ha=':fb:mercury:attachment:file-name';return ea(ga,ha).getRoot();}var ha=':fb:mercury:attachment:extended-file-link',ia=da(ga,ha);if(ga.open_url){var ja=ia.getNode('openLinkContainer');i.show(ja);var ka=ia.getNode('openFile');ka.setAttribute('href',ga.open_url);}var la=ia.getNode('downloadFile');la.setAttribute('href',ga.url);ga.rel&&la.setAttribute('rel',ga.rel);return ia.getRoot();},renderMusic:function(ga){var ha=g[':fb:mercury:attachment:music'].build().setNodeContent('filename',ga.name),ia=ha.getNode('link');ia.setAttribute('href',ga.url);ia.setAttribute('target','_blank');ga.rel&&ia.setAttribute('rel',ga.rel);var ja=ha.getNode('image-link');ja.setAttribute('href',ga.url);ga.rel&&ja.setAttribute('rel',ga.rel);var ka=ha.getNode('preview-image');ka.setAttribute('src',ga.preview_url);i.show(ka);i.addClass(ha.getNode('icon_link'),'MercuryMusicIcon');return ha.getRoot();},resizeContain:function(ga,ha){var ia=ga.width/ga.height,ja=ha.width/ha.height;if(ja<ia){return {width:Math.min(ga.height*ja,ha.width),height:Math.min(ga.height,ha.height)};}else return {width:Math.min(ga.width,ha.width),height:Math.min(ga.width/ja,ha.height)};},renderPreview:function(ga,ha,ia,ja){var ka=g[':fb:mercury:attachment:preview'].build(),la=ka.getNode('image-link');if(ga){if(ga.url){var ma=new y(ga.url).getQueryData().uri;if(ma&&ga.rel==='async'){la.setAttribute('href',ma);la.setAttribute('ajaxify',ga.url);}else la.setAttribute('href',ga.url);}ga.rel&&la.setAttribute('rel',ga.rel);var na;if(ga.preview_uploading){var oa=ka.getNode('progress-bar'),pa=new u(oa),qa=ka.getNode('progress-bar-container');ga.on_progress(function(event,ua){if(ua.upload_id==ga.upload_id){i.show(qa);t.updateProgressBar(pa,ua.event);}});i.addClass(la,"_57jm");if(ia>=176){na='/images/photos/dots_large.png';}else if(ia>=86){na='/images/photos/dots_medium.png';}else na='/images/photos/dots_small.png';x.set(la,'width',ia+'px');x.set(la,'max-width',ia+'px');if(ga.preview_width&&ga.preview_height)x.set(la,'padding-bottom',((ga.preview_height/ga.preview_width)*100)+'%');}else if(ga.metadata&&ga.metadata.fbid){na=y('/ajax/mercury/attachments/photo.php').addQueryData({fbid:ga.metadata.fbid,request_user_id:ga.metadata.pageid,mode:ja,width:ia,height:ia}).toString();if(p.MessagesViewerReactGK){var ra=la.getAttribute('ajaxify');la.removeAttribute('ajaxify');la.removeAttribute('rel');l.listen(la,'click',function(event){s.bootstrapWithConfig(la,{src:na,endpoint:ra,fbid:ga.metadata.fbid,dimensions:ga.metadata.dimensions,disablePaging:ha.attachments.length==1,reverse:p.MessagesViewerViewAllInThreadGK});event.prevent();});}}else na=y(ga.preview_url).addQueryData({mode:ja,width:ia,height:ia}).toString();var sa=ka.getNode('preview-image');if(na){if(ja==='contain'&&ga.preview_width&&ga.preview_height){var ta=fa.resizeContain({width:ia,height:ia},{width:ga.preview_width,height:ga.preview_height});sa.setAttribute('width',ta.width);sa.setAttribute('height',ta.height);}if(ga.preview_uploading||(ja==='cover'&&!ca)){i.addClass(la,"_55pj");x.set(la,'backgroundImage','url('+na+')');}else{sa.onload=function(){sa.removeAttribute('width');sa.removeAttribute('height');};sa.setAttribute('src',na);}}if(ha)this.renderReportRespondLink(ka.getRoot(),ga,ha.message_id);}else i.addClass(la,"_ksa");return ka.getRoot();},renderShareLink:function(ga,ha,ia){var ja=g[':fb:mercury:attachment:share-link'].build().setNodeContent('name',ga.name),ka=ja.getNode('link');ka.setAttribute('href',ga.url);ga.rel&&ka.setAttribute('rel',ga.rel);return ja.getRoot();},renderVideoThumb:function(ga){var ha=g[':fb:mercury:attachment:video-thumb'].build(),ia=ha.getNode('thumb');ia.setAttribute('href',ga.url);ia.setAttribute('rel',ga.rel);var ja=k.find(ha.getRoot(),'img');ja.src=ga.preview_url;return ha.getRoot();},renderShareXHP:function(ga,ha){var ia=k.create('div');if(ga){k.appendContent(ia,ga.share_xhp);this.renderReportRespondLink(ia,ga,ha);}return ia;},renderSticker:function(ga,ha,ia){var ja=ia?'chatScrolled/':'messengerScrolled/';ja+=ha.thread_id;var ka=k.create('div'),la=w({animationTrigger:'click',className:'mvs',frameCount:ga.metadata.frameCount||1,frameRate:ga.metadata.frameRate||83,framesPerCol:ga.metadata.framesPerCol||1,framesPerRow:ga.metadata.framesPerRow||1,sourceHeight:ga.metadata.height,sourceURI:ga.url,sourceWidth:ga.metadata.width,spriteURI:ga.metadata.spriteURI,subscribedThreadID:ja});v.renderComponent(la,ka);return ka;},renderReportRespondLink:function(ga,ha,ia){if(!ha.is_social_report_attachment)return null;switch(ha.share_data_type){case j.MercurySupportedShareType.FB_PHOTO:break;case j.MercurySupportedShareType.FB_SOCIAL_REPORT_PHOTO:return null;default:return null;}var ja=null;if(ia)ja=q.getMessagesFromIDs([ia])[0];if(!ja)return null;if(ja.author===r.user)return null;var ka=null;r.get(ja.author,function(la){ka=k.create('a',{rel:'dialog-post',className:"_z6l",id:'respond-link',ajaxify:y('/ajax/report/social_resolution/post/').setQueryData({attachment_fbid:ha.attach_id,post_fbid:ha.shared_object_id,sender_id:r.getUserID(la.id)}).toString()});k.setContent(ka,ba._("Respond to {name}'s request",{name:la.name}));k.appendContent(ga,ka);});},renderPhotoAttachments:function(ga,ha,ia,ja){var ka=ga.length;if(!ka)return null;var la=m.div({className:"_55pk"}),ma=(m.div({className:"_55pl"},la));if(ka===1){var na=fa.renderPreview(ga[0],ha,ia,'contain');k.appendContent(la,na);return ma;}var oa=(ka==2||ka==4)?2:3,pa=(ia-(oa-1)*ja)/oa,qa=Math.ceil(ka/oa),ra=qa*pa+(qa-1)*ja,sa=(m.div({className:"_55pm",style:'padding-bottom: '+(ra/ia*100)+'%;'}));k.appendContent(la,sa);for(var ta=0;ta<ka;++ta){var ua=fa.renderPreview(ga[ta],ha,pa,'cover'),va=ta%oa,wa=Math.floor(ta/oa);i.addClass(ua,"_55pn");x.apply(ua,{width:(pa/ia*100)+'%',left:((va*(pa+ja))/ia*100)+'%',top:((wa*(pa+ja))/ra*100)+'%'});k.appendContent(sa,ua);}return ma;},isPhotoAttachment:function(ga){return ga.attach_type==o.PHOTO||(ga.attach_type==o.FILE&&ga.preview_url);},isShareAttachment:function(ga){return ga.attach_type==o.SHARE;},isFileAttachment:function(ga){return ga.attach_type==o.FILE;},isErrorAttachment:function(ga){return ga.attach_type==o.ERROR;},isStickerAttachment:function(ga){return ga.attach_type==o.STICKER;},booleanLexicographicComparator:function(ga){return function(ha,ia){for(var ja=0;ja<ga.length;++ja){var ka=ga[ja](ha),la=ga[ja](ia);if(ka&&!la){return -1;}else if(!ka&&la)return 1;}return 0;};}};e.exports=fa;});
__d("DOMHyperlink",["Env","JSXDOM","TransformTextToDOMMixin","UntrustedLink","URI","URLScraper","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('Env'),h=b('JSXDOM'),i=b('TransformTextToDOMMixin'),j=b('UntrustedLink'),k=b('URI'),l=b('URLScraper'),m=b('copyProperties'),n=b('cx'),o={MAX_ITEMS:40,match:function(p,q){var r=l.match(p);if(!r)return false;var s=p.indexOf(r),t=s+r.length;return {startIndex:s,endIndex:t,element:this._element(r,q)};},_element:function(p,q){var r=p,s=r.replace(/"/g,'%22');if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(p)))s='http://'+s;if(!k.isValidURI(s))return r;var t=h.a({className:"_553k",href:s,target:"_blank",rel:"nofollow"},r);if(q&&!k(s).isFacebookURI())t.onmousedown=function(u){j.bootstrap(this,g.lhsh,u);};return t;}};e.exports=m(o,i);});
__d("MercuryMessageRenderer",["MercuryAttachmentRenderer","CSS","DOM","DOMEmoji","DOMEmote","DOMHyperlink","DOMQuery","FBIDEmote","JSXDOM","MercuryLogMessageType","MercuryParticipants","Tooltip","cx","transformTextToDOM","tx"],function(a,b,c,d,e,f){var g=b('MercuryAttachmentRenderer'),h=b('CSS'),i=b('DOM'),j=b('DOMEmoji'),k=b('DOMEmote'),l=b('DOMHyperlink'),m=b('DOMQuery'),n=b('FBIDEmote'),o=b('JSXDOM'),p=b('MercuryLogMessageType'),q=b('MercuryParticipants'),r=b('Tooltip'),s=b('cx'),t=b('transformTextToDOM'),u=b('tx'),v={renderTooltipFlyout:function(oa,pa){pa.forEach(function(qa){var ra=i.create('div');i.setContent(ra,qa.name);i.appendContent(oa,ra);});},renderLogMessage:function(oa,pa,qa,ra){y(oa,ra);z(pa,ra);aa(qa,ra);},formatMessageBody:function(oa,pa,qa){var ra=(oa||'').replace(/\s+$/,'');if(!pa)return x(ra,false,qa);var sa=Object.keys(pa).map(function(va){return window.parseInt(va);}).sort(function(va,wa){return va-wa;}),ta=[],ua=0;sa.forEach(function(va){var wa=ra.slice(ua,va);if(wa)ta.push(x(wa,false,qa));ua=va+pa[va].length;var xa=ra.slice(va,ua);if(xa)ta.push(x(xa,true,qa));});if(ua<ra.length)ta.push(x(ra.slice(ua),false,qa));return ta.length===0?null:ta.length===1?ta[0]:i.create('span',{},ta);}};function w(oa,pa){var qa=oa.replace(/\r\n?/g,'\n').split(/\n{2,}/);return qa.filter(function(ra){return ra.length;}).map(function(ra){return o.p(null,pa(ra));});}function x(oa,pa,qa){if(oa.length===0&&!pa)return null;var ra=function(sa){return t(sa,[l.params(true),j,n,k]);};return (o.span({className:pa?'highlight':null},qa?w(oa,ra):ra(oa)));}function y(oa,pa){var qa='',ra;switch(pa.log_message_type){case p.JOINABLE_CREATED:case p.JOINABLE_JOINED:case p.SUBSCRIBE:qa='mercurySubscribeIcon';break;case p.UNSUBSCRIBE:qa='mercuryUnsubscribeIcon';break;case p.THREAD_NAME:qa='mercuryThreadNameIcon';break;case p.THREAD_IMAGE:qa='mercuryThreadImageIcon';break;case p.VIDEO_CALL:ra=pa.log_message_data.answered;if(ra||na(pa)){qa='mercuryVideoCallIcon';}else qa='mercuryMissedVideoCallIcon';break;case p.PHONE_CALL:ra=pa.log_message_data.answered;if(ra){qa='mercuryPhoneCallIcon';}else qa='mercuryMissedPhoneCallIcon';break;case p.SERVER_ERROR:qa='mercuryErrorIcon';break;}h.addClass(oa,qa);}function z(oa,pa){switch(pa.log_message_type){case p.JOINABLE_CREATED:fa(oa,pa);break;case p.JOINABLE_JOINED:ga(oa,pa);break;case p.SUBSCRIBE:ka(oa,pa);break;case p.UNSUBSCRIBE:la(oa,pa);break;case p.VIDEO_CALL:if(na(pa)){ba(oa,pa);}else da(oa,pa);break;case p.PHONE_CALL:ca(oa,pa);break;case p.THREAD_NAME:ea(oa,pa);break;case p.THREAD_IMAGE:ha(oa,pa);break;case p.SERVER_ERROR:ma(oa,pa);break;}}function aa(oa,pa){var qa=pa.log_message_type;if(qa==p.THREAD_IMAGE){var ra=pa.log_message_data.image;if(ra){var sa=g.renderPreview(ra.preview_url?ra:null);i.setContent(oa,sa);h.addClass(sa,"_z6a");h.show(oa);}}}var ba=function(oa,pa){q.get(pa.author,function(qa){var ra=i.create('span',{className:"_511e"},qa.short_name),sa;switch(pa.log_message_data.event_name){case 'installing':sa=i.tx._("{firstname} is setting up video calling...",{firstname:ra});break;case 'installed':sa=i.tx._("{firstname} finished setting up video calling.",{firstname:ra});break;case 'install_canceled':sa=i.tx._("You canceled the video calling installation. ",{firstname:ra});break;}if(sa)i.setContent(oa,sa);});},ca=function(oa,pa){var qa=pa.log_message_data.caller,ra=pa.log_message_data.callee,sa=[qa,ra];q.getMulti(sa,function(ta){if(qa==q.user){var ua=i.create('span',{className:"_511e"},ta[ra].short_name),va;if(pa.log_message_data.answered){va=i.tx._("You called {firstname}.",{firstname:ua});}else va=i.tx._("{firstname} missed a call from you. ",{firstname:ua});}else{var wa=i.create('span',{className:"_511e"},ta[qa].short_name);if(pa.log_message_data.answered){va=i.tx._("{firstname} called you.",{firstname:wa});}else va=i.tx._("You missed a call from {firstname}. ",{firstname:wa});}i.setContent(oa,va);});},da=function(oa,pa){var qa=pa.log_message_data.caller,ra=pa.log_message_data.callee,sa=[qa,ra];q.getMulti(sa,function(ta){if(qa==q.user){var ua=i.create('span',{className:"_511e"},ta[ra].short_name),va;if(pa.log_message_data.answered){va=i.tx._("You called {firstname}.",{firstname:ua});}else va=i.tx._("{firstname} missed a call from you. ",{firstname:ua});}else{var wa=i.create('span',{className:"_511e"},ta[qa].short_name);if(pa.log_message_data.answered){va=i.tx._("{firstname} called you.",{firstname:wa});}else va=i.tx._("You missed a call from {firstname}. ",{firstname:wa});}i.setContent(oa,va);});},ea=function(oa,pa){var qa=pa.log_message_data.name,ra=i.create('b',{},qa);if(pa.author==q.user){if(qa){i.setContent(oa,i.tx._("You named the conversation: {name}.",{name:ra}));}else i.setContent(oa,i.tx._("You removed the conversation name."));}else q.get(pa.author,function(sa){var ta,ua=ia(sa);if(qa){ta=i.tx._("{actor} named the conversation: {name}.",{actor:ua,name:ra});}else ta=i.tx._("{actor} removed the conversation name.",{actor:ua});i.setContent(oa,ta);});},fa=function(oa,pa){if(pa.author==q.user){i.setContent(oa,i.tx._("Other people can join this chat from News Feed and add their friends."));}else q.get(pa.author,function(qa){var ra=ia(qa);i.setContent(oa,i.tx._("{actor} shared this chat to News Feed. Other people can join and add their friends.",{actor:ra}));});},ga=function(oa,pa){var qa=pa.log_message_data.joined_participant;if(qa==q.user){i.setContent(oa,i.tx._("You joined the chat. Other people can join from News Feed and add their friends."));}else q.get(qa,function(ra){var sa=ia(ra);i.setContent(oa,i.tx._("{actor} joined the chat.",{actor:sa}));});},ha=function(oa,pa){if(pa.author==q.user){if(pa.log_message_data.image){i.setContent(oa,i.tx._("You changed the conversation picture."));}else i.setContent(oa,i.tx._("You removed the conversation picture."));}else q.get(pa.author,function(qa){var ra=ia(qa),sa;if(pa.log_message_data.image){sa=i.tx._("{actor} changed the conversation picture.",{actor:ra});}else sa=i.tx._("{actor} removed the conversation picture.",{actor:ra});i.setContent(oa,sa);});},ia=function(oa){if(oa.href)return i.create('a',{href:oa.href,className:"_511e"},oa.name);return oa.name;},ja=function(oa){var pa=oa.indexOf(q.user);if(pa>0)return oa.splice(pa,1).concat(oa);return oa;},ka=function(oa,pa){var qa=ja(pa.log_message_data.added_participants),ra=null,sa;if(qa.length==1){ra=[pa.author,qa[0]];q.getMulti(ra,function(ta){if(pa.author==q.user){sa=i.tx._("You added {subscriber1}.",{subscriber1:ia(ta[qa[0]])});}else if(qa[0]==q.user){sa=i.tx._("{actor} added you.",{actor:ia(ta[pa.author])});}else sa=i.tx._("{actor} added {subscriber1}.",{actor:ia(ta[pa.author]),subscriber1:ia(ta[qa[0]])});i.setContent(oa,sa);});}else if(qa.length==2){ra=[pa.author].concat(qa);q.getMulti(ra,function(ta){if(pa.author==q.user){sa=i.tx._("You added {subscriber1} and {subscriber2}.",{subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]])});}else if(qa[0]==q.user){sa=i.tx._("{actor} added you and {subscriber2}.",{actor:ia(ta[pa.author]),subscriber2:ia(ta[qa[1]])});}else sa=i.tx._("{actor} added {subscriber1} and {subscriber2}.",{actor:ia(ta[pa.author]),subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]])});i.setContent(oa,sa);});}else if(qa.length==3){ra=[pa.author].concat(qa);q.getMulti(ra,function(ta){if(pa.author==q.user){sa=i.tx._("You added {subscriber1}, {subscriber2} and {subscriber3}.",{subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]]),subscriber3:ia(ta[qa[2]])});}else if(qa[0]==q.user){sa=i.tx._("{actor} added you, {subscriber2} and {subscriber3}.",{actor:ia(ta[pa.author]),subscriber2:ia(ta[qa[1]]),subscriber3:ia(ta[qa[2]])});}else sa=i.tx._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",{actor:ia(ta[pa.author]),subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]]),subscriber3:ia(ta[qa[2]])});i.setContent(oa,sa);});}else{ra=[pa.author].concat(qa);q.getMulti(ra,function(ta){var ua=i.tx._("{num} more",{num:qa.length-2}),va=i.create('span',{className:'more'},ua),wa=i.create('div');v.renderTooltipFlyout(wa,qa.slice(2).map(function(ya){return ta[ya];}));if(pa.author==q.user){sa=i.tx._("You added {subscriber1}, {subscriber2} and {more_people}.",{subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]]),more_people:va});}else if(qa[0]==q.user){sa=i.tx._("{actor} added you, {subscriber2} and {more_people}.",{actor:ia(ta[pa.author]),subscriber2:ia(ta[qa[1]]),more_people:va});}else sa=i.tx._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",{actor:ia(ta[pa.author]),subscriber1:ia(ta[qa[0]]),subscriber2:ia(ta[qa[1]]),more_people:va});i.setContent(oa,sa);var xa=m.find(oa,'span.more');r.set(xa,wa,'above','center');});}},la=function(oa,pa){q.get(pa.author,function(qa){var ra;if(pa.author==q.user){ra=i.tx._("You left the conversation.");}else ra=i.tx._("{actor} left the conversation.",{actor:ia(qa)});i.setContent(oa,ra);});},ma=function(oa,pa){var qa="We were unable to fetch previous messages in this conversation.";i.setContent(oa,qa);},na=function(oa){return oa.log_message_data.event_name==='installing'||oa.log_message_data.event_name==='install_canceled';};e.exports=v;});
__d("MercurySeenByAll",["CSS","DataStore","DOM","MercuryParticipants","MercuryDelayedRoger","MercuryThreads"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('MercuryParticipants'),k=b('MercuryDelayedRoger'),l=b('MercuryThreads').get(),m={},n={updateOnSeenChange:function(p,q){m[p.tagName]=true;h.set(p,'thread-id',q.thread_id);g.addClass(p,'seenByListener');o(p,q);}};function o(p,q){var r=q.participants.filter(function(t){return t!==j.user;}),s=q.participants.length>0&&q.participants[0]===j.user;g.conditionClass(p,'repliedLast',s);g.conditionClass(p,'seenByAll',s&&k.getSeenBy(q.thread_id).length===r.length);}k.subscribe('state-changed',function(p,q){for(var r in m){var s=i.scry(document.body,r+'.seenByListener');for(var t=0;t<s.length;t++){var u=s[t],v=h.get(u,'thread-id');if(q[v])l.getThreadMeta(v,function(w){o(u,w);});}}});e.exports=n;});
__d("StickerConstants",[],function(a,b,c,d,e,f){var g={LIKE_STICKER_ID:227878347358915};e.exports=g;});
__d("MercuryThreadMetadataRenderer",["CSS","DOM","Emoji","EmoticonsList","HTML","JSLogger","MercuryAttachment","MercuryAttachmentType","MercuryMessageSourceTags","MercurySingletonMixin","MercuryThreadMetadataRawRenderer","MercuryParticipants","MercuryParticipantsConstants","Pixelz.react","React","MercurySeenByAll","MercuryServerRequests","SplitImage.react","StickerConstants","Style","MercuryThreadlistIconTemplates","MercuryThreads","Tooltip","URI","arrayContains","createArrayFrom","copyProperties","cx","emojiAndEmote","fbt","formatDate","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Emoji'),j=b('EmoticonsList'),k=b('HTML'),l=b('JSLogger'),m=b('MercuryAttachment'),n=b('MercuryAttachmentType'),o=b('MercuryMessageSourceTags'),p=b('MercurySingletonMixin'),q=b('MercuryThreadMetadataRawRenderer'),r=b('MercuryParticipants'),s=b('MercuryParticipantsConstants'),t=b('Pixelz.react'),u=b('React'),v=b('MercurySeenByAll'),w=b('MercuryServerRequests'),x=b('SplitImage.react'),y=b('StickerConstants'),z=b('Style'),aa=b('MercuryThreadlistIconTemplates'),ba=b('MercuryThreads'),ca=b('Tooltip'),da=b('URI'),ea=b('arrayContains'),fa=b('createArrayFrom'),ga=b('copyProperties'),ha=b('cx'),ia=b('emojiAndEmote'),ja=b('fbt'),ka=b('formatDate'),la=b('tx'),ma=l.create('wm_timestamp');function na(ta){this._fbid=ta;this._serverRequests=w.getForFBID(ta);this._threads=ba.getForFBID(ta);}ga(na,p);ga(na.prototype,{renderTimestamp:function(ta,ua,va,wa){if(wa){if(!ua){ma.warn('no_title');ua=(new Date(wa)).toLocaleDateString();}ta.setAttribute('title',ua);ta.setAttribute('data-utime',wa/1000);if(!va){ma.warn('no_display');va=ka(new Date(wa),'g:ia');}h.setContent(ta,va);g.show(ta);}},renderMessageSourceTags:function(ta,ua,va,wa){var xa='',ya='',za='';if(ea(va,o.MESSENGER)){xa="Sent from Messenger";ya=new da('/mobile/messenger');za="_9g";}else if(ea(va,o.MOBILE)){xa="Sent from Mobile";ya=new da('/mobile/');za="_9j";}else if(ea(va,o.CHAT)){xa="Sent from chat";za="_9h";}else if(ea(va,o.EMAIL)){if(wa){xa=la._("Sent from {email}",{email:wa});}else xa="Sent from email";za="_9i";}if(za){ca.set(ta,xa);g.addClass(ua,za);if(ya){ta.setAttribute('href',ya);}else ta.removeAttribute('href');}else g.hide(ta);},renderMessageLocation:function(ta,ua,va){var wa=da('/ajax/messaging/hovercard/map.php').setQueryData(va);ta.setAttribute('data-hovercard',wa);g.removeClass(ta,"_b9");g.show(ua);},renderSpoofWarning:function(ta,ua,va){if(ua){g.addClass(ta,"_sa");ca.set(ta,la._("Unable to confirm {name_or_email} as the sender.",{name_or_email:va.name}));}},renderChatSpoofWarning:function(ta,ua,va){if(ua)h.appendContent(ta,la._("Unable to confirm {name_or_email} as the sender.",{name_or_email:va.name}));},renderCoreThreadlist:function(ta,ua,va,wa,xa){wa=wa||{};this.renderThreadImage(ta,ua.getNode('image'));var ya=ua.getNode('accessibleName'),za=[ua.getNode('name')];if(ya)za.push(ya);sa(this,ta,za,wa);if(ta.folder&&xa)ra(ua.getNode('folderBadge'),ta.folder);var ab=ua.getNode('timestamp');this.renderTimestamp(ab,ta.timestamp_absolute,ta.timestamp_relative,ta.timestamp);this.renderSnippet(ta,ua.getNode('snippet'));pa(ua,ta);va(ua,ta);},renderAndSeparatedParticipantList:function(ta,ua,va){va=va||{};va.last_separator_uses_and=true;this._threads.getThreadMeta(ta,function(wa){sa(this,wa,ua,va);}.bind(this));},renderSnippet:function(ta,ua){var va=false,wa=h.create('span');g.addClass(wa,'MercuryRepliedIndicator');h.appendContent(ua,wa);v.updateOnSeenChange(wa,ta);var xa=ta.snippet;if(xa){if(ta.snippet_has_attachment)h.appendContent(ua,h.create('span',{className:'MercuryAttachmentIndicator'}));if(ta.is_forwarded_snippet)h.appendContent(ua,h.create('strong',{className:"_55q_"},"Forwarded Message:"));if(xa.substr(0,4)=='?OTR'){xa="[encrypted message]";}else xa=xa.replace(/\r\n|[\r\n]/g," ");xa=k(i.htmlEmojiAndEmote(xa));}else{if(ta.is_forwarded_snippet)h.appendContent(ua,h.create('strong',{className:"_55q_"},"Forwarded Message"));if(ta.snippet_has_attachment&&ta.snippet_attachments&&ta.snippet_attachments.length){va=true;xa=h.create('span');qa(this,ta,xa);}}var ya=ta.participants.length;if(ta.is_subscribed)ya--;if(!va&&ta.snippet_sender&&r.getIDForUser(this._fbid)!=ta.snippet_sender&&ya>1){r.get(ta.snippet_sender,function(za){if(za.short_name){h.appendContent(ua,la._("{name}: {conversation_snippet}",{name:za.short_name,conversation_snippet:xa}));}else h.appendContent(ua,xa);});}else h.appendContent(ua,xa);},getTitanURL:function(ta,ua,va){if(ta.substr(0,ta.indexOf(':'))=='user'){q.getUserCanonicalTitanURL(ta,ua,va);}else this._serverRequests.getServerThreadID(ta,function(wa){q.getTitanURLWithServerID(wa,ua,va);});},renderTitanLink:function(ta,ua,va,wa){if(ta.substr(0,ta.indexOf(':'))=='user'){q.renderUserCanonicalTitanLink(ta,ua,va,wa);}else this._serverRequests.getServerThreadID(ta,function(xa){q.renderTitanLinkWithServerID(xa,ua,va,wa);});},renderThreadImage:function(ta,ua){if(ta.image_src){var va=t({height:s.BIG_IMAGE_SIZE,resizeMode:'cover',src:ta.image_src,width:s.BIG_IMAGE_SIZE});u.renderComponent(va,ua);return;}var wa=r.getIDForUser(this._fbid),xa=[],ya=ta.participants.filter(function(za){return za!=wa;});if(!ya.length){xa=[wa];}else if(ya.length==1){xa=[ya[0]];}else xa=ya.slice(0,3);this.renderParticipantImages(xa,ua);},renderParticipantImages:function(ta,ua){r.getOrderedBigImageMulti(ta,function(va){var wa=x({srcs:va,border:true,size:s.BIG_IMAGE_SIZE});u.renderComponent(wa,ua);});},renderParticipantList:function(ta,ua,va,wa){return q.renderRawParticipantList(this._serverRequests.getServerThreadIDNow(ta),ua,va,wa);},renderThreadNameAndParticipantList:function(ta,ua,va,wa){var xa=q.renderRawParticipantList(this._serverRequests.getServerThreadIDNow(ta),ua,va,wa),ya=this._threads.getThreadMetaNow(ta);if(!ya.name)return xa;return la._("{conversation_name} [with {participant_list}]",{conversation_name:ya.name,participant_list:xa});},renderParticipantCount:function(ta,ua){return q.renderRawParticipantCount(this._serverRequests.getServerThreadIDNow(ta),ua);}});function oa(ta){if(!ta.snippet_attachments)return [];return ta.snippet_attachments.filter(function(ua){return ua.attach_type===n.PHOTO;});}function pa(ta,ua){var va=oa(ua);if(va.length===0)return;var wa=va[0].thumbnail_url;if(!wa)return;var xa=(va.length==1)?'snippet-thumbnail-single':'snippet-thumbnail-multiple',ya=ta.getNode(xa);if(!ya)return;var za=h.find(ya,'i');z.set(za,'background-image','url('+wa+')');g.show(ya);}function qa(ta,ua,va){var wa=ua.snippet_sender&&r.getIDForUser(ta._fbid)==ua.snippet_sender,xa=function(db){if(!ua.snippet_sender||wa){db(null);return;}r.get(ua.snippet_sender,function(eb){db(eb.short_name);});},ya=oa(ua),za=ya.length==ua.snippet_attachments.length,ab=ua.snippet_attachments.length===1&&ua.snippet_attachments[0].metadata&&ua.snippet_attachments[0].metadata.type=='fb_voice_message',bb=ua.snippet_attachments.length===1&&ua.snippet_attachments[0].attach_type===n.STICKER,cb=ua.snippet_attachments.length===1&&ua.snippet_attachments[0].attach_type===n.SHARE;xa(function(db){var eb=null;if(za){var fb=aa[':fb:mercury:attachment-icon-text'].build().getRoot();if(ya.length===1){eb=wa?"You sent a photo.":la._("{name} sent a photo.",{name:db});}else eb=wa?la._("You sent {num_photos} photos.",{num_photos:ya.length}):la._("{name} sent {num_photos} photos.",{name:db,num_photos:ya.length});g.addClass(fb,m.getAttachIconClass(ya[0].icon_type));h.appendContent(fb,eb);h.appendContent(va,fb);}else if(ab){var gb=aa[':fb:mercury:attachment-icon-text'].build().getRoot();eb=wa?"You sent a voice message.":la._("{name} sent a voice message.",{name:db});g.addClass(gb,m.getAttachIconClass(ua.snippet_attachments[0].icon_type));h.appendContent(gb,eb);h.appendContent(va,gb);}else if(bb){if(ua.snippet_attachments[0].metadata.stickerID==y.LIKE_STICKER_ID){eb=ia(j.symbols.like);}else eb=wa?"You sent a sticker.":la._("{name} sent a sticker.",{name:db});h.appendContent(va,eb);}else if(cb){var hb=aa[':fb:mercury:attachment-icon-text'].build().getRoot();if(wa){eb="You shared a link.";}else eb=ja._("{sender name} shared a link.",[ja.param("sender name",db)]);g.addClass(hb,m.getAttachIconClass(ua.snippet_attachments[0].icon_type));h.appendContent(hb,eb);h.appendContent(va,hb);}else ua.snippet_attachments.filter(function(ib){return ib.attach_type==n.FILE||ib.attach_type==n.PHOTO;}).forEach(function(ib){var jb=aa[':fb:mercury:attachment-icon-text'].build().getRoot();h.appendContent(jb,ib.name);g.addClass(jb,m.getAttachIconClass(ib.icon_type));h.appendContent(va,jb);});});}function ra(ta,ua){fa(ta).forEach(function(va){h.setContent(va,ua);});}function sa(ta,ua,va,wa){va=fa(va);if(ua.name){var xa=q.renderRawTitleWithUnreadCount(ua.name,wa.show_unread_count?ua.unread_count:0);va.forEach(function(za){h.setContent(za,xa);});wa.callback&&wa.callback(xa);return;}var ya=ua.participants;if(ua.participants.length>1)ya=ua.participants.filter(function(za){return za!=r.getIDForUser(ta._fbid);});r.getMulti(ya,function(za){q.renderParticipantListWithNoThreadName(ta._serverRequests.getServerThreadIDNow(ua.thread_id),ua,ya,za,va,wa);});}e.exports=na;});
__d("MercurySheetPolicy",[],function(a,b,c,d,e,f){var g={canReplaceOpenSheet:function(h,i){if(h.getType()==i.getType())return false;if(h.isPermanent()&&!i.isPermanent())return false;return true;}};e.exports=g;});
__d("MercurySheetView",["Animation","ArbiterMixin","MercurySheetPolicy","CSS","DOM","Style","MercurySheetTemplates","Vector","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('ArbiterMixin'),i=b('MercurySheetPolicy'),j=b('CSS'),k=b('DOM'),l=b('Style'),m=b('MercurySheetTemplates'),n=b('Vector'),o=b('copyProperties'),p=b('cx'),q=5000,r=function(s,t,u){this._threadID=s;this._rootElement=t;this._tabMainElement=u;this._openSheet=null;};o(r.prototype,h,{destroy:function(){k.empty(this._rootElement);},_openCommon:function(s,t){if(this._openSheet&&!i.canReplaceOpenSheet(this._openSheet,s)){if(s.couldNotReplace)s.couldNotReplace();return;}this.clear(function(){this._openSheet=s;var u=m[':fb:mercury:tab-sheet:loading'].build().getRoot();k.setContent(this._rootElement,u);j.show(u);j.show(this._rootElement);s.render();if(t){j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var v=n.getElementDimensions(this._rootElement).y;l.set(this._rootElement,'bottom',v+'px');this.resize();this._animation=new g(this._rootElement).to('bottom',0).duration(150).ease(g.ease.both).ondone(function(){j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this.resize();}.bind(this)).go();}else this.resize();if(!s.isPermanent()){var w=q;if(s.getCloseTimeout)w=s.getCloseTimeout();var x=this.getAutoCloseCallback(s);this._sheetCloseHandler=this.close.bind(this,s,x).defer(w,false);if(s.timeoutCanBeReset)s.setResetTimeoutCallback(this.resetTimeout.bind(this));}}.bind(this));},getAutoCloseCallback:function(s){if(!s.autoCloseCallback)return null;return s.autoCloseCallback.bind(s);},resetTimeout:function(s,t){clearTimeout(this._sheetCloseHandler);var u=this.getAutoCloseCallback(s);this._sheetCloseHandler=this.close.bind(this,s,u).defer(t,false);},set:function(s){return this._openCommon(s,false);},open:function(s){return this._openCommon(s,true);},close:function(s,t){if(this._openSheet!=s)return;if(!this._openSheet){t&&t();return;}if(this._animation)this._animation.stop();if(this._sheetCloseHandler){clearTimeout(this._sheetCloseHandler);this._sheetCloseHandler=null;}j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var u=n.getElementDimensions(this._rootElement).y;this.resize();this._animation=new g(this._rootElement).to('bottom',u+'px').duration(100).ease(g.ease.begin).ondone(function(){k.empty(this._rootElement);j.hide(this._rootElement);j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this._openSheet=null;this.resize();t&&t();}.bind(this)).go();},clear:function(s){this.close(this._openSheet,s);},resize:function(){this.inform('resize');}});e.exports=r;});
__d("MercuryTypeahead",["Event","ArbiterMixin","DOM","DOMDimensions","Input","Keys","MercuryTypeaheadTemplates","Tokenizer","Typeahead","TypeaheadCore","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ArbiterMixin'),i=b('DOM'),j=b('DOMDimensions'),k=b('Input'),l=b('Keys'),m=b('MercuryTypeaheadTemplates'),n=b('Tokenizer'),o=b('Typeahead'),p=b('TypeaheadCore'),q=b('copyProperties'),r=b('cx'),s=function(t,u){this._domElement=null;this._typeahead=null;this._tokenizer=null;this._placeholder='';this._exclusions=[];this._viewNodeOrID=null;this._viewOptions={renderer:'compact',autoSelect:true};this._tokenizerBehaviors=[];this._heightPrev=null;this._dataSource=t;this._view=u;};q(s.prototype,h);q(s.prototype,{setPlaceholder:function(t){this._placeholder=t;return this;},setExcludedParticipantsFromThreadMeta:function(t){if(!t)return;if(!t.former_participants){this.setExcludedParticipants(t.participants);return;}var u=t.former_participants.filter(function(v){return v.is_friend===false;}).map(function(v){return v.id;});this.setExcludedParticipants(u.concat(t.participants));},setExcludedParticipants:function(t){this._exclusions=[];t.forEach(function(u){var v=u.indexOf(':');if(u.substr(0,v)=='fbid')this._exclusions.push(u.substr(v+1));}.bind(this));return this;},setViewNodeID:function(t){this._viewNodeOrID=t;},setViewNode:function(t){this._viewNodeOrID=t;},setFullWidthView:function(t){var u=i.create('div',{className:"_4ck uiTypeaheadView"});i.setContent(t,u);this.setViewNode(u);},setViewOption:function(t,u){this._viewOptions[t]=u;},addTokenizerBehavior:function(t){this._tokenizerBehaviors.push(t);},build:function(t){if(this._domElement)return;var u=m[':fb:mercury:tokenizer'].build(),v=m[':fb:mercury:typeahead'].build();this._domElement=u.getRoot();i.appendContent(this._domElement,v.getRoot());var w=v.getNode('textfield');k.setPlaceholder(w,this._placeholder);w.setAttribute('data-placeholder',this._placeholder);this._input=w;var x={node_id:this._viewNodeOrID,ctor:this._view,options:this._viewOptions},y={ctor:p,options:{setValueOnSelect:true}};this._typeahead=new o(this._dataSource,x,y,v.getRoot());this._typeahead.init();var z={inline:true,behaviors:this._tokenizerBehaviors};this._tokenizer=new n(this._domElement,this._typeahead);this._tokenizer.init(u.getNode('tokenarea'),'participants',[],z);this._tokenizer.subscribe(['addToken','removeToken','removeAllTokens'],this._tokensChanged.bind(this));this._tokenizer.subscribe('resize',function(){this.inform('resize');}.bind(this));g.listen(w,'focus',function(){this._resetDataSource();this._typeahead.init();}.bind(this));g.listen(this._domElement,'click',this.focus.bind(this));g.listen(w,'keydown',this.keydown.bind(this));this._heightPrev=j.getElementDimensions(this._domElement).height;},getElement:function(){return this._domElement;},getSelectedParticipantIDs:function(){var t=[];if(this._tokenizer)(this._tokenizer.getTokenValues()||[]).forEach(function(u){t.push('fbid:'+u);});return t;},getTokens:function(){var t=[];if(this._tokenizer)t=this._tokenizer.getTokens();return t;},getTokenizer:function(){return this._tokenizer;},keydown:function(event){if(this._tokenizer.inline&&event.keyCode==l.ESC){if(k.isEmpty(this._input)){var t=this._tokenizer.getLastToken();if(t&&t.isRemovable())this._tokenizer.removeToken(t);}else this._typeahead.getCore().reset();return false;}if(k.isEmpty(this._input)&&this._tokenizer.inline&&event.keyCode===l.RETURN)return this.inform('tokens-return');},reset:function(){this._tokenizer&&this._tokenizer.removeAllTokens();this._typeahead&&this._typeahead.getCore().reset();},focus:function(){this._tokenizer&&this._tokenizer.focusInput();},getTypeahead:function(){return this._typeahead;},_resetDataSource:function(){this._dataSource.setExclusions(this._exclusions);},_tokensChanged:function(){this.inform('tokens-changed');}});e.exports=s;});
__d("MercuryPresence",["Arbiter","Bootloader","AvailableListConstants","DOM","CSS","fbt"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('AvailableListConstants'),j=b('DOM'),k=b('CSS'),l=b('fbt'),m={},n={},o={updateOnPresenceChanges:function(u,v){n[v.tagName]=true;m[u]=true;k.addClass(v,'presenceListener_'+u);var w=p(u);q(v,w.classes);r(v,w.label);}};function p(u){var v=t(u),w={presenceActive:false,presenceMobile:false},x=null;switch(v){case i.ACTIVE:w.presenceActive=true;x="Active";break;case i.MOBILE:w.presenceMobile=true;x="Mobile";break;default:break;}return {classes:w,label:x};}function q(u,v){for(var w in v)k.conditionClass(u,w,v[w]);}function r(u,v){if(u&&v){var w=j.create('span',{className:'accessible_elem'},v);j.setContent(u,w);}}function s(){for(var u in m){var v=p(u);for(var w in n){var x=j.scry(document,w+'.presenceListener_'+u);for(var y=0;y<x.length;y++){q(x[y],v.classes);r(x[y],v.label);}}}}var t=function(u){return i.OFFLINE;};h.loadModules(['AvailableList'],function(u){t=u.get;s();});g.subscribe(i.ON_AVAILABILITY_CHANGED,s);e.exports=o;});
__d("VaultBoxURI",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={PHOTOS_SYNCED:'photos_synced',isVaultBoxURI:function(i){var j=new RegExp("\/"+h.PHOTOS_SYNCED+"\/?$");return i.getPath().match(j)&&i.getQueryData().hasOwnProperty('view_image');},isVaultArchiveURI:function(i){var j=new RegExp("\/"+h.PHOTOS_SYNCED+"\/?$");return i.getPath().match(j);},getSyncedTabURI:function(){return new g('/me/'+h.PHOTOS_SYNCED).getQualifiedURI();}};e.exports=h;});