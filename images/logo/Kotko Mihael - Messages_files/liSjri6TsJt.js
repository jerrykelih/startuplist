/*1363355030,173217599*/

if (self.CavalryLogger) { CavalryLogger.start_js(["4qmsI"]); }

__d("DataCollector",["PerformanceStats","copyProperties","Env","ErrorUtils","JSLogger","URI","UserActionHistory","ModuleDependencies"],function(a,b,c,d,e,f){var g=b('PerformanceStats'),h=b('copyProperties'),i=b('Env'),j=b('ErrorUtils'),k=b('JSLogger'),l=b('URI'),m=b('UserActionHistory'),n=b('ModuleDependencies'),o={};h(o,{_metadata:{},_logs:{},addMetadata:function(p){h(o._metadata,p);},addLog:function(p,q){o._logs[p]=q;},getMetadata:function(){return o._metadata;},_collectData:function(){return {logs:o._collectLogs(),metadata:o._collectMetadata()};},_collectMetadata:function(){o.addMetadata({URI:l.getRequestURI().toString(),UserAgent:navigator.userAgent,ScriptPaths:o.getPageHistory()});return o._metadata;},_collectLogs:function(){o.addLog('cavalryid',o.getCavalryID());o.addLog('pageletperformance',g.getPageletStats());var p={};if(k.getDumpJSON){p=k.getDumpJSON();}else if(k.getEntries)p={log:k.getEntries(),now:Date.now(),env_start:i.start};var q={Env:JSON.stringify(i),ClickHistory:m.getHistory(),errors:j.history,ScriptPaths:o.getPageHistory(),ModuleDependencies:n.getNotLoadedModules()};h(p,q);o.addLog('jslogger',p);return o._logs;},getPageHistory:function(){return [a._script_path];},getCavalryID:function(){if(a.CavalryLogger){var p=a.CavalryLogger.getInstance();if(p)return p.lid;}return null;},reset:function(){o._logs={};o._metadata={};}});e.exports=o;});